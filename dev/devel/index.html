<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>For Developers · GTPSA.jl</title><meta name="title" content="For Developers · GTPSA.jl"/><meta property="og:title" content="For Developers · GTPSA.jl"/><meta property="twitter:title" content="For Developers · GTPSA.jl"/><meta name="description" content="Documentation for GTPSA.jl."/><meta property="og:description" content="Documentation for GTPSA.jl."/><meta property="twitter:description" content="Documentation for GTPSA.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GTPSA.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quickstart/">Quickstart Guide</a></li><li><a class="tocitem" href="../advanced/">Advanced Usage</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../man/a_toc/">Table of Contents</a></li><li><a class="tocitem" href="../man/b_descriptor/"><code>Descriptor</code></a></li><li><a class="tocitem" href="../man/c_tps/"><code>TPS</code></a></li><li><a class="tocitem" href="../man/d_varsparams/"><code>@vars</code>, <code>@params</code></a></li><li><a class="tocitem" href="../man/e_monoindex/">Monomial Indexing</a></li><li><a class="tocitem" href="../man/f_mono/"><code>mono</code>/<code>complexmono</code></a></li><li><a class="tocitem" href="../man/g_gjh/"><code>gradient</code>, <code>jacobian</code>, <code>hessian</code></a></li><li><a class="tocitem" href="../man/h_slice/">Slicing and <code>par</code></a></li><li><a class="tocitem" href="../man/i_methods/"><code>TPS</code>-Specific Functions</a></li><li><a class="tocitem" href="../man/j_fastgtpsa/"><code>@FastGTPSA</code>/<code>@FastGTPSA!</code> Macros</a></li><li><a class="tocitem" href="../man/k_io/">I/O</a></li><li><a class="tocitem" href="../man/l_global/">Global Variables</a></li><li><a class="tocitem" href="../man/m_all/">All Overloaded Functions</a></li></ul></li><li class="is-active"><a class="tocitem" href>For Developers</a><ul class="internal"><li><a class="tocitem" href="#Descriptor"><span>Descriptor</span></a></li><li><a class="tocitem" href="#TPS"><span>TPS</span></a></li><li><a class="tocitem" href="#TempTPS"><span>TempTPS</span></a></li><li><a class="tocitem" href="#Library-Structure"><span>Library Structure</span></a></li><li><a class="tocitem" href="#Fast-GTPSA-Macros"><span>Fast GTPSA Macros</span></a></li><li><a class="tocitem" href="#Calling-the-C-library-with-pointers-and-pointer-to-pointers"><span>Calling the C-library with pointers and pointer-to-pointers</span></a></li><li><a class="tocitem" href="#Low-Level"><span>Low-Level</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>For Developers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>For Developers</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bmad-sim/GTPSA.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bmad-sim/GTPSA.jl/blob/main/docs/src/devel.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="For-Developers"><a class="docs-heading-anchor" href="#For-Developers">For Developers</a><a id="For-Developers-1"></a><a class="docs-heading-anchor-permalink" href="#For-Developers" title="Permalink"></a></h1><p>Developers may fork <a href="https://github.com/bmad-sim/GTPSA.jl">the GTPSA.jl repo</a> and then <code>dev</code> their forked repo in the REPL. For example, if my Github username is <code>githubuser</code>, then after forking GTPSA.jl I would run in the REPL:</p><pre><code class="language-julia hljs">import Pkg
Pkg.develop(url=&quot;https://github.com/githubuser/GTPSA.jl&quot;)</code></pre><p>The package consists of two layers: a low-level layer written in Julia that is 1-to-1 with the GTPSA C code, and a high-level, user-friendly layer that cleans up the notation for manipulating TPSs, manages temporaries generated during evaluation, and properly manages the memory in C when variables go out of scope in Julia. The low-level functions are listed at the bottom of this page.</p><p>When it comes to managing memory in C via Julia, there are certain intricacies that have to be considered. First, let&#39;s consider the <code>Descriptor</code>, which is the simplest: </p><h2 id="Descriptor"><a class="docs-heading-anchor" href="#Descriptor">Descriptor</a><a id="Descriptor-1"></a><a class="docs-heading-anchor-permalink" href="#Descriptor" title="Permalink"></a></h2><p>The <code>Descriptor</code> stores all information about the GTPSA, including the indexing table for indexing specific monomials. This is a static object, only created once for a GTPSA, which all <code>TPS</code>s refer to. In C, these structs must exist for the entirety of the program execution. In Julia, because they must not be destroyed when out-of-scope, we wrap these objects in <strong>immutable</strong> structs. In a single program, up to 250 <code>Descriptor</code>s can exist simultanouesly, and they can be manually optionally destroyed using <code>GTPSA.mad_desc_del!</code>. At program termination all <code>Descriptor</code>s are destroyed. Given the significantly large number allowed, as well as the danger of still-existing <code>TPS</code> and <code>Descriptor</code> structs after destruction, no front-facing interface to the user is given for destroying existing <code>Descriptor</code>s.</p><p>The <code>Descriptor</code> struct simply wraps a C-pointer to a low-level struct called <code>Desc</code>: this struct is 1-to-1 equivalent to the C struct <code>desc</code> in GTPSA. See the documentation for <a href="#GTPSA.Desc"><code>GTPSA.Desc</code></a> below. By having this struct in Julia, we can <code>unsafe_load</code> the struct and get values in the <code>desc</code>. For example, to access the first <code>TPS{Float64}</code> in the buffer of temporaries in the <code>Descriptor</code>, we can do</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using GTPSA</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; import GTPSA: Desc</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; d = Descriptor(5,8)</code><code class="nohighlight hljs ansi" style="display:block;">Descriptor(NV=5, MO=8)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; desc = unsafe_load(d.desc) # To access the low-level C struct</code><code class="nohighlight hljs ansi" style="display:block;">GTPSA.Desc(2, 5, 5, 0, 0x08, 0x00, 0xff, Ptr{UInt8} @0x000000000e2e44b8, 0, 4, 0x00000507, 0x00000000, 0x00000000, Ptr{Int32} @0x000000000eb8f3e8, Ptr{UInt8} @0x000000000f23f908, Ptr{UInt8} @0x000000000ec5b7d8, Ptr{UInt8} @0x000000000ee39c68, Ptr{Ptr{UInt8}} @0x000000000f717698, Ptr{Ptr{UInt8}} @0x000000000efc04a8, Ptr{Ptr{UInt8}} @0x000000000e9f6dd8, Ptr{Int32} @0x000000000eb9f978, Ptr{Int32} @0x000000000f2a5f18, Ptr{Int32} @0x000000000f601498, Ptr{Int32} @0x000000000ef25bd8, Ptr{Ptr{Int32}} @0x000000000f25b158, Ptr{Ptr{Ptr{Int32}}} @0x000000000f23ad78, 0x0000000000022195, 0.0, 0.0, 0.0, Ptr{Ptr{Nothing}} @0x000000000f66d628, Ptr{Ptr{Nothing}} @0x000000000f795e18, Ptr{Int32} @0x000000000e7b1138, Ptr{Int32} @0x000000000e2b7bc8)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; t_jl = unsafe_load(Base.unsafe_convert(Ptr{Ptr{TPS{Float64}}}, desc.t), 1) # 1 in Julia = 0 in C</code><code class="nohighlight hljs ansi" style="display:block;">Ptr{TPS64} @0x000000000f62e138</code></pre><p>In Julia, if we were to then <code>unsafe_load(t_jl)</code>, there would in fact be allocations, as its internally creating a copy of the <code>TPS{Float64}</code> in Julia. This is not well documented in the documentation of <code>unsafe_load</code> (see the discussion <a href="https://discourse.julialang.org/t/c-struct-garbage-collection-not-run-frequently-enough/116919/27?u=mattsignorelli">here</a>).</p><h2 id="TPS"><a class="docs-heading-anchor" href="#TPS">TPS</a><a id="TPS-1"></a><a class="docs-heading-anchor-permalink" href="#TPS" title="Permalink"></a></h2><p>The <code>TPS{Float64}</code> struct in Julia corresponds exactly to the C struct <code>tpsa</code> and <code>TPS{ComplexF64}</code> struct in Julia corresponds exactly to <code>ctpsa</code> in C. To understand fully the <code>TPS</code> struct, some history is needed:</p><p>In early development versions of <code>GTPSA.jl</code>, the <code>TPS</code> struct was very similar to the <code>Descriptor</code> struct: it used to just wrap a C <code>Ptr</code> to a low-level struct, and instead be <code>mutable</code> so out-of-scope <code>TPS</code>s and temporaries are cleaned up. This at the time seemed like the simplest solution, since in Julia there is no way to tag C pointers for Julia garbage collection. This created some problems though: firstly, there is one indirection because Julia would tag that particular mutable wrapper struct for GC, but then the member <code>Ptr</code> of that struct pointed to a different place in memory that had to be cleaned up. Secondly, when calling GTPSA C functions that want a <code>Vector</code> of <code>TPS</code> (e.g. <code>Ptr</code> to <code>TPS</code>), you would need to do a <code>map(t-&gt;t.tpsa, x)</code> where <code>x</code> is a <code>Vector{TPS64}</code> and <code>tpsa</code> is the field member of the wrapper TPS struct. Thirdly, and perhaps most significantly, Julia is not aware of how much memory the C is using. Therefore, it will not call the garbage collector very often, even if actually &gt;100GB of memory is being used. Sometimes the OS will just kill the Julia process.</p><p>In order to get around these problems, we must allocate the entire mutable <code>TPS</code> struct in Julia instead of in the C code (e.g. using <code>GTPSA.mad_tpsa_newd</code>). We then can use <code>pointer_from_objref</code> in Julia to get a pointer to that mutable, Julia-owned struct to pass to the C functions. </p><p>Sounds simple enough, right? If only! In the GTPSA C code, the <code>coef</code> member array is something called a <a href="https://en.wikipedia.org/wiki/Flexible_array_member">flexible array member</a>. This is great in C, because instead of the struct storing a pointer to an array (which would cause an indirection every time the <code>coef</code> array is accessed in a <code>TPS</code>), it actually stores the array right there in the struct, with variable size. This gives some performance gains. In Julia, there is no such analog. For those who know about <code>StaticArrays.jl</code>, you might think an <code>SVector</code> could work, but surprise, it doesn&#39;t because you cannot mutate the fields of an <code>SVector</code> and neither can the C code.</p><p>So the only solution it seems is to change the actual C struct in <code>mad_tpsa_impl.h</code> and <code>mad_ctpsa_impl.h</code> to use regular arrays for <code>coef</code> instead of flexible array members, and indeed this is what is done for <code>GTPSA.jl</code>. There is a tiny speed reduction due to the indirection of accessing <code>coef</code>, however the benefits of Julia&#39;s garbage collector knowing how much memory it&#39;s using, and keeping memory usage sane, is worth the very tiny cost.</p><p>On the Julia side, it turns out you cannot just use a regular <code>Vector</code> for the <code>coef</code> array in the <code>TPS</code> struct, because Julia&#39;s <code>Vector</code> structs are quite complex and play a lot of tricks. You might actually be able to use an <code>MVector</code> from <code>StaticArrays</code>, however using this struct might make <code>GTPSA.jl</code> significantly more complex because the size of the array has to be known at compile-time or else you suffer the drastic performance reductions caused by type-instabilities. The complexity of using this could be checked at some point in the future.</p><p>The decided solution was to, in the Julia, <code>@ccall jl_malloc</code> for the <code>coef</code> array, and in the finalizer for the mutable <code>TPS</code> struct call <code>@ccall jl_free</code> for the <code>coef</code> array. This gives us C-style arrays that Julia&#39;s garbage collector knows about, and so will make sure to keep the memory usage sane.</p><p>When <code>@ccall</code> is used, the arguments are <code>Base.unsafe_convert</code>ed to the corresponding specified argument types. Therefore, for <code>TPS</code> all we had to do then was define</p><pre><code class="language-julia hljs">Base.unsafe_convert(::Type{Ptr{TPS{T}}}, t::TPS{T}) where {T} = Base.unsafe_convert(Ptr{TPS{T}},pointer_from_objref(t))</code></pre><p>and now we can pass our <code>TPS</code> structs to C using <code>@ccall</code>.</p><h2 id="TempTPS"><a class="docs-heading-anchor" href="#TempTPS">TempTPS</a><a id="TempTPS-1"></a><a class="docs-heading-anchor-permalink" href="#TempTPS" title="Permalink"></a></h2><p>Because <code>unsafe_load</code> of a <code>Ptr{&lt;:TPS}</code> creates a copy and allocates, we cannot treat the constant buffer of pre-allocated temporaries in the <code>Descriptor</code> as bona-fide <code>TPS</code>s. Note that the memory addresses of the temporaries in the buffer are constant and do not need to be cleaned up; they are <strong>immutable!</strong>. The temporaries, which we give the type <code>GTPSA.TempTPS</code>, do not have any of the problems of just wrapping a pointer as do the <code>TPS</code>s, and so that&#39;s what they are. Also in Julia, in order to access the fields of a <code>TempTPS</code> (e.g. <code>mo</code>) via <code>unsafe_load</code> without allocating, we need an immutable struct having the same structure as <code>TPS</code>. This is the purpose of <code>GTPSA.LowTempTPS</code>. We need to use the <code>mo</code> field for <code>@FastGTPSA</code> to finally allocate the result <code>TPS</code> with the <code>mo</code> of the result <code>TempTPS</code>.</p><p>As with <code>TPS</code>, we also had to define <code>Base.unsafe_convert</code> for <code>TempTPS</code> so we can <code>@ccall</code>. In this case, the <code>unsafe_convert</code> returns the member <code>Ptr</code> of the <code>TempTPS</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.TempTPS" href="#GTPSA.TempTPS"><code>GTPSA.TempTPS</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct TempTPS{T&lt;:Union{Float64,ComplexF64},D}</code></pre><p>This is for internal use only. <code>TempTPS</code> is a temporary <code>TPS</code>, which has  been pre-allocated in a buffer for each thread in the <code>Descriptor</code> C struct.  When using the <code>@FastGTPSA</code> macro, all temporaries generated will be used  from this buffer. &quot;Constructors&quot; of this type simply take a temporary from  that particular thread&#39;s buffer in a stack-like manner and &quot;Destructors&quot;  (which must be manually called because this is immutable) release it from  the stack.</p><p><strong>Fields</strong></p><ul><li><code>t::Ptr{TPS{T,D}}</code> – Pointer to the <code>TPS</code> in the buffer in the <code>Descriptor</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/fastgtpsa/temptps.jl#L1-L14">source</a></section></article><h2 id="Library-Structure"><a class="docs-heading-anchor" href="#Library-Structure">Library Structure</a><a id="Library-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Library-Structure" title="Permalink"></a></h2><p>All operators have an in-place, mutating version specified with a bang (!). These are the lowest-level pure Julia code, following the convention that the first argument is the one to contain the result. In the GTPSA C library, the last argument contains the result, so this is accounted for in the file <code>inplace_operators.jl</code>. All in-place functions can receive either a regular <code>TPS</code> , which the user will be using, as well as a <code>GTPSA.TempTPS</code>, which the user should not concern themselves with. The constants <code>RealTPS</code> and <code>ComplexTPS</code> are defined respectively in <code>low_level/rtpsa.jl</code> and <code>low_level/ctpsa.jl</code> to simplify the notation. These are just:</p><pre><code class="language-julia hljs"># Internal constants to aid multiple dispatch including temporaries 
const RealTPS = Union{TempTPS{Float64}, TPS{Float64}}
const ComplexTPS = Union{TempTPS{ComplexF64}, TPS{ComplexF64}}</code></pre><p>All this does is enforce correct types for the in-place functions, while keeping the notation/code simple. </p><p>The in-place, mutating functions, defined in <code>inplace_operators.jl</code> <strong>must all use the <code>RealTPS</code> and <code>ComplexTPS</code> &quot;types&quot;</strong>. Then, the higher level out-of-place functions for both <code>TPS</code> and <code>TempTPS</code>, which do different things with the result, will use these in-place functions.</p><p>The out-of-place functions for <code>TPS</code> are defined in <code>operators.jl</code>, and the out-of-place functions for <code>TempTPS</code> are defined in <code>fastgtpsa/operators.jl</code>.</p><h2 id="Fast-GTPSA-Macros"><a class="docs-heading-anchor" href="#Fast-GTPSA-Macros">Fast GTPSA Macros</a><a id="Fast-GTPSA-Macros-1"></a><a class="docs-heading-anchor-permalink" href="#Fast-GTPSA-Macros" title="Permalink"></a></h2><p>The <code>@FastGTPSA</code>/<code>@FastGTPSA!</code> macros work by changes all arithmetic operators in different Julia arithmetic operators with the same operator precedence and unary operator capabilities. These special operators then dispatch on functions that use the temporaries when a <code>TPS</code> or <code>TempTPS</code> is passed, else default to their original operators, thereby making it completely transparent to non-TPS types. Both <code>+</code> and <code>-</code> must work as unary operators, and there is a very short list of allowed ones shown <a href="https://github.com/JuliaLang/julia/blob/master/src/julia-parser.scm#L99">here</a>. The other arithmetic operators were chosen somewhat randomly from the top of the same file, next to <code>prec-plus</code>, <code>prec-times</code>, and <code>prec-power</code> which defines the operator precedences. By taking this approach, we relieve ourselves of having to rewrite PEMDAS and instead let the Julia do it for us.</p><p>All arithmetic operators are changed to <code>GTPSA.:&lt;special symbols&gt;</code>, e.g. <code>+</code> → <code>GTPSA.:±</code>. All non-arithmetic operators that are supported by GTPSA are then changed to <code>GTPSA.__t_&lt;operator&gt;</code>, e.g. <code>sin</code> → <code>GTPSA.__t_sin</code>, where the prefix <code>__t_</code> is also chosen somewhat arbitrarily. These operators are all defined in <code>fastgtpsa/operators.jl</code>, and when they encounter a TPS type, they use the temporaries, and when other number types are detected, they fallback to the regular, non-<code>__t_</code> operator. This approach works extraordinarily well, and introduces no problems externally because none of these functions/symbols are exported.</p><h2 id="Calling-the-C-library-with-pointers-and-pointer-to-pointers"><a class="docs-heading-anchor" href="#Calling-the-C-library-with-pointers-and-pointer-to-pointers">Calling the C-library with pointers and pointer-to-pointers</a><a id="Calling-the-C-library-with-pointers-and-pointer-to-pointers-1"></a><a class="docs-heading-anchor-permalink" href="#Calling-the-C-library-with-pointers-and-pointer-to-pointers" title="Permalink"></a></h2><p>All of the GTPSA map functions require a vector of <code>TPS</code> as input, in C <code>**tpsa</code>. In Julia, this works automatically for <code>AbstractArray{&lt;:Union{TPS64,ComplexTPS64}}</code> by specifying the C argument type in the C call as <code>::Ptr{TPS64}</code> or <code>::Ptr{ComplexTPS64}</code>.  However, this can be misleading to those C inputs which require <code>*tpsa</code>, e.g. also <code>::Ptr{TPS64}</code>. For consistency in the low level library interface, all <em>pointers</em> are specified as <code>::Ref{TPS64}</code> and <code>::Ref{ComplexTPS64}</code>, and <em>pointers-to-pointers</em> are specified as <code>Ptr</code>s. For single <code>TPS</code>s, the <code>cconvert</code> to <code>Ref</code> in the <code>ccall</code> is handled automatically.</p><p>However, in some cases, one might have only a single <code>TPS64</code> and would like the call the corresponding map functions without having to allocate an array. After some experimenting, I&#39;ve found the following overrides to gives zero allocations:</p><pre><code class="language-julia hljs">Base.unsafe_convert(::Type{Ptr{TPS{T}}}, r::Base.RefValue{Ptr{Nothing}}) where {T} = Base.unsafe_convert(Ptr{TPS{T}}, Base.unsafe_convert(Ptr{Cvoid}, r))
Base.cconvert(::Type{Ptr{TPS{T}}}, t::TPS{T}) where {T} = Ref(pointer_from_objref(t))</code></pre><p>NOTE: We need to have a <code>GC.@preserve</code> before the cconvert to keep <code>t</code> valid! As such, you will see in all map functions a call to <code>GC.@preserve</code>. </p><p>This override is only necessary for the mutable <code>TPS</code>. The other array inputs of <code>isbits</code> types are ok and basically have the above defined for them. See <a href="https://github.com/JuliaLang/julia/issues/56873#event-15727452235">this discussion for more details</a>.</p><h2 id="Low-Level"><a class="docs-heading-anchor" href="#Low-Level">Low-Level</a><a id="Low-Level-1"></a><a class="docs-heading-anchor-permalink" href="#Low-Level" title="Permalink"></a></h2><p>Below is documentation for every single 1-to-1 C function in the GTPSA library. If there is any function missing, please submit an issue to <code>GTPSA.jl</code>.</p><h3 id="Monomial"><a class="docs-heading-anchor" href="#Monomial">Monomial</a><a id="Monomial-1"></a><a class="docs-heading-anchor-permalink" href="#Monomial" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_add!" href="#GTPSA.mad_mono_add!"><code>GTPSA.mad_mono_add!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_add!(n::Cint, a, b, r)</code></pre><p>Sets monomial <code>r = a + b</code>.</p><p><strong>Input</strong></p><ul><li><code>n</code> – Length of monomials</li><li><code>a</code> – Source monomial <code>a</code></li><li><code>b</code> – Source monomial <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination monomial, <code>r = a + b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L339-L351">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_cat!" href="#GTPSA.mad_mono_cat!"><code>GTPSA.mad_mono_cat!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_cat!(n::Cint, a, m::Cint, b, r)</code></pre><p>Sets monomial <code>r</code> equal to the concatenation of the monomials <code>a</code> and <code>b</code></p><p><strong>Input</strong></p><ul><li><code>n</code> – Length of monomonial <code>a</code></li><li><code>a</code> – Source monomial <code>a</code></li><li><code>m</code> – Length of monomial <code>b</code></li><li><code>b</code> – Source monomial <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination monomial of concatenation of <code>a</code> and <code>b</code> (length <code>n+m</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L381-L394">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_cmp" href="#GTPSA.mad_mono_cmp"><code>GTPSA.mad_mono_cmp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_cmp(n::Cint, a, b)::Cint</code></pre><p>Compares monomial <code>a</code> to monomial <code>b</code>, and returns the first difference in the lowest order variables.</p><p><strong>Input</strong></p><ul><li><code>n</code>   – Length of monomials</li><li><code>a</code>   – Monomial <code>a</code></li><li><code>b</code>   – Monomial <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – First <code>a[i]-b[i] != 0</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L296-L308">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_copy!" href="#GTPSA.mad_mono_copy!"><code>GTPSA.mad_mono_copy!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_copy!(n::Cint, a, r)</code></pre><p>Copies monomial <code>a</code> to monomial <code>r</code>.  </p><p><strong>Input</strong></p><ul><li><code>n</code> – Length of monomials</li><li><code>a</code> – Source monomial</li><li><code>r</code> – Destination monomial</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L58-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_eq" href="#GTPSA.mad_mono_eq"><code>GTPSA.mad_mono_eq</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_eq(n::Cint, a, b)::Bool</code></pre><p>Checks if the monomial <code>a</code> is equal to the monomial <code>b</code>.</p><p><strong>Input</strong></p><ul><li><code>n</code>   – Length of monomials</li><li><code>a</code>   – Monomial <code>a</code></li><li><code>b</code>   – Monomial <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – True if the monomials are equal, false if otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L188-L200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_eqn" href="#GTPSA.mad_mono_eqn"><code>GTPSA.mad_mono_eqn</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_eqn(n::Cint, a, b::Cuchar)::Bool</code></pre><p>???</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L176-L180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_fill!" href="#GTPSA.mad_mono_fill!"><code>GTPSA.mad_mono_fill!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_fill!(n::Cint, a, v::Cuchar)</code></pre><p>Fills the monomial <code>a</code> with the value <code>v</code>.</p><p><strong>Input</strong></p><ul><li><code>n</code> – Monomial length</li><li><code>a</code> – Monomial</li><li><code>v</code> – Value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L42-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_le" href="#GTPSA.mad_mono_le"><code>GTPSA.mad_mono_le</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_le(n::Cint, a, b)::Bool</code></pre><p>Checks if monomial <code>a</code> is less than or equal to monomial <code>b</code>.</p><p><strong>Input</strong></p><ul><li><code>n</code>   – Length of monomials</li><li><code>a</code>   – Monomial <code>a</code></li><li><code>b</code>   – Monomial <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – True if <code>a &lt;= mono_b</code>, false otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L230-L242">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_lt" href="#GTPSA.mad_mono_lt"><code>GTPSA.mad_mono_lt</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_lt(n::Cint, a, b)::Bool</code></pre><p>Checks if monomial <code>a</code> is less than monomial <code>b</code>.</p><p><strong>Input</strong></p><ul><li><code>n</code>  – Length of monomials</li><li><code>a</code>  – Monomial <code>a</code></li><li><code>b</code>  – Monomial <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – True if <code>a &lt; b</code>, false otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L209-L221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_max" href="#GTPSA.mad_mono_max"><code>GTPSA.mad_mono_max</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_max(n::Cint, a)::Cuchar</code></pre><p>Returns the maximum order of the monomial.</p><p><strong>Input</strong></p><ul><li><code>n</code>  – Length of monomial</li><li><code>a</code>  – Monomial</li></ul><p><strong>Output</strong></p><ul><li><code>mo</code> – Maximum order of monomial <code>a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L94-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_min" href="#GTPSA.mad_mono_min"><code>GTPSA.mad_mono_min</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_min(n::Cint, a)::Cuchar</code></pre><p>Returns the minimum order of the monomial.</p><p><strong>Input</strong></p><ul><li><code>n</code>  – Length of monomial</li><li><code>a</code>  – Monomial</li></ul><p><strong>Output</strong></p><ul><li><code>mo</code> – Mininum order of monomial <code>a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L75-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_ord" href="#GTPSA.mad_mono_ord"><code>GTPSA.mad_mono_ord</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_ord(n::Cint, a)::Cint</code></pre><p>Returns the sum of the orders of the monomial <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>n</code> – Monomial length</li><li><code>a</code> – Monomial</li></ul><p><strong>Output</strong></p><ul><li><code>s</code> – Sum of orders of monomial</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L113-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_ordp" href="#GTPSA.mad_mono_ordp"><code>GTPSA.mad_mono_ordp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_ordp(n::Cint, a, stp::Cint)::Cdouble</code></pre><p>Returns the product of each <code>stp</code>-th order in monomial <code>a</code>. For example, <code>stp = 2</code> collects every order in the monomial with a step of 2 between each. As <code>a</code> is a pointer, the product can be started at any  element in the monomial.</p><p><strong>Input</strong></p><ul><li><code>n</code>   – Monomial length</li><li><code>a</code>   – Monomial as byte array</li><li><code>stp</code> – Step over which orders to include in the product</li></ul><p><strong>Output</strong></p><ul><li><code>p</code>   – Product of orders of monomial separated by <code>stp</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L132-L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_ordpf" href="#GTPSA.mad_mono_ordpf"><code>GTPSA.mad_mono_ordpf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_ordpf(n::Cint, a, stp::Cint)::Cdouble</code></pre><p>Returns the product of factorials each <code>stp</code>-th order in monomial a. For example, <code>stp = 2</code> collects  every order in the monomial with a step of 2 between each. As <code>a</code> is a pointer, the product can be started  at any element in the monomial.</p><p><strong>Input</strong></p><ul><li><code>n</code>   – Monomial length</li><li><code>a</code>   – Monomial as byte array</li><li><code>stp</code> – Step over which orders to include in the product of factorials</li></ul><p><strong>Output</strong></p><ul><li><code>p</code>   – Product of factorials of orders of monomial separated by <code>stp</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L154-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_print" href="#GTPSA.mad_mono_print"><code>GTPSA.mad_mono_print</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_print(n::Cint, a, sep_::Cstring, fp_::Ptr{Cvoid})</code></pre><p>Prints the monomial to <code>stdout</code>.</p><p><strong>Input</strong></p><ul><li><code>n</code>  – Length of monomial</li><li><code>a</code>  – Source monomial to print to <code>stdout</code></li><li><code>sep_</code> – Separator string</li><li><code>fp_</code> – C <code>FILE</code> pointer, if null will print to <code>stdout</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L421-L431">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_prt!" href="#GTPSA.mad_mono_prt!"><code>GTPSA.mad_mono_prt!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_prt(n::Cint, a, s::Ptr{Cuchar})::Cstring</code></pre><p>Writes the monomial defined by the byte array <code>a</code> (with orders stored as hexadecimal) into  a null terminated string <code>s</code>.</p><p><strong>Input</strong></p><ul><li><code>n</code> – Monomial and string length</li><li><code>a</code> – Monomial as byte array</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Monomial as string</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L22-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_rcmp" href="#GTPSA.mad_mono_rcmp"><code>GTPSA.mad_mono_rcmp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_rcmp(n::Cint, a, b)::Cint</code></pre><p>Compares monomial <code>a</code> to monomial <code>b</code> starting from the right (when the monomials are ordered by variable,  which is almost never the case) and returns the first difference in the lowest order variables. </p><p><strong>Input</strong></p><ul><li><code>n</code>   – Length of monomials</li><li><code>a</code>   – Monomial <code>a</code></li><li><code>b</code>   – Monomial <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – First <code>a[i]-b[i] != 0</code> where <code>i</code> starts from the end.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L317-L330">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_rev!" href="#GTPSA.mad_mono_rev!"><code>GTPSA.mad_mono_rev!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_rev!(n::Cint, a, r)</code></pre><p>Sets destination monomial <code>r</code> equal to the reverse of source monomial <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>n</code> – Lengths of monomials</li><li><code>a</code> – Source monomial <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination monomial of reverse monomial <code>a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L402-L413">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_str!" href="#GTPSA.mad_mono_str!"><code>GTPSA.mad_mono_str!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_str!(n::Cint, a, s::Cstring)::Cint</code></pre><p>Writes the monomial defined in the string <code>s</code>, which stores the orders in a human-readable format  (e.g. 10 is 10, not 0xa), into the byte array <code>a</code> with the orders specified in hexadecimal.</p><p><strong>Input</strong></p><ul><li><code>n</code> – Monomial and string length</li><li><code>s</code> – Monomial as string &quot;[0-9]*&quot;</li></ul><p><strong>Output</strong></p><ul><li><code>a</code> – Monomial as a byte array converted from the input string</li><li><code>i</code> – Adjusted size <code>n</code> of byte array if &#39; &#39; found</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_mono_sub!" href="#GTPSA.mad_mono_sub!"><code>GTPSA.mad_mono_sub!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_mono_sub!(n::Cint, a, b, r)</code></pre><p>Sets monomial <code>r = a - b</code>.</p><p><strong>Input</strong></p><ul><li><code>n</code> – Length of monomials</li><li><code>a</code> – Source monomial <code>a</code></li><li><code>b</code> – Source monomial <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination monomial, <code>r = a - b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/mono.jl#L360-L372">source</a></section></article><h3 id="Desc"><a class="docs-heading-anchor" href="#Desc">Desc</a><a id="Desc-1"></a><a class="docs-heading-anchor-permalink" href="#Desc" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.Desc" href="#GTPSA.Desc"><code>GTPSA.Desc</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">`Desc`</code></pre><p>This is a 1-to-1 struct for the C definition <code>desc</code> (descriptor) in GTPSA. Descriptors include all  information about the TPSA, including the number of variables/parameters and their orders, lookup tables for  the monomials, monomial indexing function, and pre-allocated permanent temporaries for fast evaluation.</p><p><strong>Fields</strong></p><ul><li><p><code>id::Cint</code>                   – Index in list of registered descriptors</p></li><li><p><code>nn::Cint</code>                   – Number of variables + number of parameters, <code>nn = nv+np &lt;= 100000</code></p></li><li><p><code>nv::Cint</code>                   – Number of variables</p></li><li><p><code>np::Cint</code>                   – Number of parameters</p></li><li><p><code>mo::Cuchar</code>                 – Max order of both variables AND parameters</p></li><li><p><code>po::Cuchar</code>                 – Max order of parameters</p></li><li><p><code>sh::Cuchar</code>                 – shared with id or -1</p></li><li><p><code>no::Ptr{Cuchar}</code>            – Array of orders of each variable (first <code>nv</code> entries) and parameters (last <code>np</code> entries), length <code>nn</code>. Note: In C this is <code>const</code></p></li><li><p><code>uno::Cint</code>                  – User provided array of orders of each variable/parameter (with <code>mad_desc_newvpo</code>)</p></li><li><p><code>nth::Cint</code>                  – Max number of threads or 1</p></li><li><p><code>nc::Cuint</code>                  – Number of coefficients (max length of TPSA)</p></li><li><p><code>pmul::Cuint</code>                – Threshold for parallel mult (0 = disable)</p></li><li><p><code>pcomp::Cuint</code>               – Threshold for parallel compose (0 = disable)</p></li><li><p><code>shared::Ptr{Cint}</code>          – counter of shared desc (all tables below except prms)</p></li><li><p><code>monos::Ptr{Cuchar}</code>         – &#39;Matrix&#39; storing the monomials (sorted by variable)</p></li><li><p><code>ords::Ptr{Cuchar}</code>          – Order of each monomial of <code>To</code></p></li><li><p><code>prms::Ptr{Cuchar}</code>          – Order of parameters in each monomial of <code>To</code> (zero = no parameters)</p></li><li><p><code>To::Ptr{Ptr{Cuchar}}</code>       – Table by orders - pointers to monomials, sorted by order</p></li><li><p><code>Tv::Ptr{Ptr{Cuchar}}</code>       – Table by vars - pointers to monomials, sorted by variable</p></li><li><p><code>ocs::Ptr{Ptr{Cuchar}}</code>      – <code>ocs[t,i]</code> -&gt; <code>o</code> in mul, compute <code>o</code> on thread <code>t 3 &lt;= o &lt;= mo</code> aterminated with 0</p></li><li><p><code>ord2idx::Ptr{Cint}</code>         – Order to polynomial start index in <code>To</code> (i.e. in TPSA <code>coef</code>)</p></li><li><p><code>tv2to::Ptr{Cint}</code>           – Lookup <code>tv</code>-&gt;<code>to</code></p></li><li><p><code>to2tv::Ptr{Cint}</code>           – Lookup <code>to</code>-&gt;<code>tv</code></p></li><li><p><code>H::Ptr{Cint}</code>               – Indexing matrix in <code>Tv</code></p></li><li><p><code>L::Ptr{Ptr{Cint}}</code>          – Multiplication indexes <code>L[oa,ob]</code>-&gt;<code>L_ord</code> <code>L_ord[ia,ib]</code>-&gt;<code>ic</code></p></li><li><p><code>L_idx::Ptr{Ptr{Ptr{Cint}}}</code> – <code>L_idx[oa,ob]</code>-&gt;<code>[start] [split] [end]</code> idxs in <code>L</code></p></li><li><p><code>size::Culonglong</code>           – Bytes used by <code>desc</code>. <code>Unsigned Long Int</code>: In 32 bit system is <code>Int32</code> but 64 bit is <code>Int64</code>. Using <code>Culonglong</code> assuming 64 bit</p></li><li><p><code>dst_n::Cdouble</code>             – density count</p></li><li><p><code>dst_mu::Cdouble</code>            – density mean</p></li><li><p><code>dst_var::Cdouble</code>           – density variance</p></li><li><p><code>t::Ptr{Ptr{Cvoid}}</code>         – Temporary array contains 8 pointers to <code>TPS{Float64}</code>s already initialized</p></li><li><p><code>ct::Ptr{Ptr{Cvoid}}</code>        – Temporary array contains 8 pointers to <code>TPS{ComplexF64}</code>s already initialized</p></li><li><p><code>ti::Ptr{Cint}</code>              – idx of tmp used by each thread (length = # threads)</p></li><li><p><code>cti::Ptr{Cint}</code>             – idx of tmp used by each thread (length = # threads)                                                                                              </p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L1-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_del!" href="#GTPSA.mad_desc_del!"><code>GTPSA.mad_desc_del!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_del!(d_::Ptr{Desc})</code></pre><p>Calls the destructor for the passed descriptor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L157-L162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_getnv!" href="#GTPSA.mad_desc_getnv!"><code>GTPSA.mad_desc_getnv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_getnv!(d::Ptr{Desc}, mo_::Ref{Cuchar}, np_::Ref{Cint}, po_::Ref{Cuchar}::Cint</code></pre><p>Returns the number of variables in the descriptor, and sets the passed <code>mo_</code>, <code>np_</code>, and <code>po_</code> to the maximum  order, number of parameters, and parameter order respectively.</p><p><strong>Input</strong></p><ul><li><code>d</code> – Descriptor</li></ul><p><strong>Output</strong></p><ul><li><code>mo_</code> – (Optional) Maximum order of the descriptor</li><li><code>np_</code> – (Optional) Number of parameters of the descriptor</li><li><code>po_</code> – (Optional) Parameter order of the descriptor</li><li><code>ret</code> – Number of variables in TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L168-L182">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_idxm" href="#GTPSA.mad_desc_idxm"><code>GTPSA.mad_desc_idxm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_idxm(d::Ptr{Desc}, n::Cint, m)::Cint</code></pre><p>Returns the index of the monomial as byte array <code>m</code> in the descriptor, or -1 if the monomial is invalid.</p><p><strong>Input</strong></p><ul><li><code>d</code> – Descriptor</li><li><code>n</code>    – Monomial length</li><li><code>m</code>    – Monomial as byte array</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>  – Monomial index or -1 if invalid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L307-L319">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_idxs" href="#GTPSA.mad_desc_idxs"><code>GTPSA.mad_desc_idxs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_idxs(d::Ptr{Desc}, n::Cint, s::Cstring)::Cint</code></pre><p>Returns the index of the monomial as string <code>s</code> in the descriptor, or -1 if the monomial is invalid.</p><p><strong>Input</strong></p><ul><li><code>d</code>   – Descriptor</li><li><code>n</code>   – String length or 0 if unknown</li><li><code>s</code>   – Monomial as string &quot;[0-9]*&quot;</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Monomial index or -1 if invalid monomial</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L288-L300">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_idxsm" href="#GTPSA.mad_desc_idxsm"><code>GTPSA.mad_desc_idxsm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_idxsm(d::Ptr{Desc}, n::Cint, m)::Cint</code></pre><p>Returns the index of the monomial as sparse monomial <code>m</code>, indexed as <code>[(i,o)]</code>, in the descriptor, or -1 if the monomial is invalid.</p><p><strong>Input</strong></p><ul><li><code>d</code>   – Descriptor</li><li><code>n</code>   – Monomial length</li><li><code>m</code>   – Sparse monomial <code>[(idx,ord)]</code></li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Monomial index or -1 if invalid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L327-L339">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_info" href="#GTPSA.mad_desc_info"><code>GTPSA.mad_desc_info</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_info(d::Ptr{Desc}, fp::Ptr{Cvoid})</code></pre><p>For debugging.</p><p><strong>Input</strong></p><ul><li><code>d</code>  – Descriptor to debug</li><li><code>fp</code> – File to write to. If null, will write to <code>stdout</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L411-L419">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_isvalidm" href="#GTPSA.mad_desc_isvalidm"><code>GTPSA.mad_desc_isvalidm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_isvalidm(d::Ptr{Desc}, n::Cint, m)::Bool</code></pre><p>Checks if monomial as byte array <code>m</code> is valid given maximum order of descriptor.</p><p><strong>Input</strong></p><ul><li><code>d</code>  – Descriptor</li><li><code>n</code>  – Length of monomial</li><li><code>m</code>  – Monomial as byte array</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – True if valid, false if invalid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L247-L259">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_isvalids" href="#GTPSA.mad_desc_isvalids"><code>GTPSA.mad_desc_isvalids</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_isvalids(d::Ptr{Desc}, n::Cint, s::Cstring)::Bool</code></pre><p>Checks if monomial as string <code>s</code> is valid given maximum order of descriptor.</p><p><strong>Input</strong></p><ul><li><code>d</code>  – Descriptor</li><li><code>n</code>  – Monomial string length</li><li><code>s</code>  – Monomial as string &quot;[0-9]*&quot;</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – True if valid, false if invalid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L228-L240">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_isvalidsm" href="#GTPSA.mad_desc_isvalidsm"><code>GTPSA.mad_desc_isvalidsm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_isvalidsm(d::Ptr{Desc}, n::Cint, m)::Bool</code></pre><p>Checks the monomial as sparse monomial <code>m</code> (monomial stored as sequence of integers with each pair  <code>[(i,o)]</code> such that <code>i</code> = index, <code>o</code> = order) is valid given the maximum order of the descriptor.</p><p><strong>Input</strong></p><ul><li><code>d</code>   – Descriptor</li><li><code>n</code>   – Length of monomial</li><li><code>m</code>   – Sparse monomial <code>[(idx, ord)]</code></li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – True if valid, false if invalid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L267-L280">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_maxlen" href="#GTPSA.mad_desc_maxlen"><code>GTPSA.mad_desc_maxlen</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_maxlen(d::Ptr{Desc}, mo::Cuchar)::Cint</code></pre><p>Gets the maximum length of the TPSA given an order. </p><p><strong>Input</strong></p><ul><li><code>d</code>   – Descriptor</li><li><code>mo</code>  – Order (<code>ordlen(maxord) == maxlen</code>)</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – monomials in <code>0..order</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L210-L221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_maxord" href="#GTPSA.mad_desc_maxord"><code>GTPSA.mad_desc_maxord</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_maxord(d::Ptr{Desc}, nn::Cint, no_)::Cuchar</code></pre><p>Sets the order of the variables and parameters of the TPSA to those specified in <code>no_</code> and  returns the maximum order of the TPSA.</p><p><strong>Input</strong></p><ul><li><code>d</code>   – Descriptor</li><li><code>nn</code>  – Number of variables + number of parameters, <code>no_[1..nn]</code></li><li><code>no_</code> – (Optional) Orders of parameters to be filled if provided</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>  – Maximum order of TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L189-L202">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_mono!" href="#GTPSA.mad_desc_mono!"><code>GTPSA.mad_desc_mono!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_mono!(d::Ptr{Desc}, i::Cint, n::Cint, m_, p_)::Cuchar</code></pre><p>Returns the order of the monomial at index <code>i</code>, and if <code>n</code> and <code>m_</code> are provided, then will also fill <code>m_</code>  with the monomial at this index. Also will optionally return the order of the parameters in the monomial  if <code>p_</code> is provided</p><p><strong>Input</strong></p><ul><li><code>d</code>   – Descriptor</li><li><code>i</code>   – Slot index (must be valid)</li><li><code>n</code>   – Monomial length (must be provided if <code>m_</code> is to be filled)</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Monomial order at slot index</li><li><code>m_</code>  – (Optional) Monomial to fill if provided</li><li><code>p_</code>  – (Optional) Order of parameters in monomial if provided</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L387-L403">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_newv" href="#GTPSA.mad_desc_newv"><code>GTPSA.mad_desc_newv</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_newv(nv::Cint, mo::Cuchar)::Ptr{Desc}</code></pre><p>Creates a TPSA descriptor with the specified number of variables and maximum order.  The number of parameters is set to 0.</p><p><strong>Input</strong></p><ul><li><code>nv</code>  – Number of variables in the TPSA</li><li><code>mo</code>  – Maximum order of TPSA, <code>mo = max(1, mo)</code></li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Descriptor with the specified number of variables and maximum order</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L93-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_newvp" href="#GTPSA.mad_desc_newvp"><code>GTPSA.mad_desc_newvp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_newvp(nv::Cint, mo::Cuchar, np_::Cint, po_::Cuchar)::Ptr{Desc}</code></pre><p>Creates a TPSA descriptor with the specifed number of variables, maximum order, number of  parameters, and parameter order.</p><p><strong>Input</strong></p><ul><li><code>nv</code>  – Number of variables</li><li><code>mo</code>  – Maximum order of TPSA INCLUDING PARAMETERS, <code>mo = max(1, mo)</code></li><li><code>np_</code> – (Optional) Number of parameters, default is 0</li><li><code>po_</code> – (Optional) Order of parameters, <code>po = max(1, po_)</code></li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Descriptor with the specified <code>nv</code>, <code>mo</code>, <code>np</code>, and <code>po</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L112-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_newvpo" href="#GTPSA.mad_desc_newvpo"><code>GTPSA.mad_desc_newvpo</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_newvpo(nv::Cint, mo::Cuchar, np_::Cint, po_::Cuchar, no_)::Ptr{Desc}</code></pre><p>Creates a TPSA descriptor with the specifed number of variables, maximum order for both variables and parameters, number of parameters,  parameter order, and individual variable/parameter orders specified in <code>no</code>. The first <code>nv</code> entries in <code>no</code>  correspond to the variables&#39; orders and the next <code>np</code> entries correspond the parameters&#39; orders.</p><p><strong>Input</strong></p><ul><li><code>nv</code>   – Number of variables</li><li><code>mo</code>   – Maximum order of TPSA (<code>mo = max(mo , no[0 :nn-1])</code>, <code>nn = nv+np</code>)</li><li><code>np_</code>  – (Optional) Number of parameters, default is 0</li><li><code>po_</code>  – (Optional) Order of parameters (<code>po = max(po_, no[nv:nn-1])</code>, <code>po &lt;= mo</code>)</li><li><code>no_</code>  – (Optional) Array of orders of variables and parameters</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Descriptor with the specified <code>nv</code>, <code>mo</code>, <code>np</code>, <code>po</code>, <code>no</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L133-L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_nxtbyord" href="#GTPSA.mad_desc_nxtbyord"><code>GTPSA.mad_desc_nxtbyord</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_nxtbyord(d::Ptr{Desc}, n::Cint, m)::Cint</code></pre><p>Returns the next monomial after monomial <code>m</code> in the TPSA when sorted by order.</p><p><strong>Input</strong></p><ul><li><code>d</code>   – Descriptor</li><li><code>n</code>   – Monomial length</li><li><code>m</code>   – Monomial as byte array</li></ul><p><strong>Output</strong></p><ul><li><code>idx</code> – Monomial index or -1 if no valid next monomial</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L367-L379">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_nxtbyvar" href="#GTPSA.mad_desc_nxtbyvar"><code>GTPSA.mad_desc_nxtbyvar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_nxtbyvar(d::Ptr{Desc}, n::Cint, m)::Cint</code></pre><p>Returns the next monomial after monomial <code>m</code> in the TPSA when sorted by variable.</p><p><strong>Input</strong></p><ul><li><code>d</code>   – Descriptor</li><li><code>n</code>   – Monomial length</li><li><code>m</code>   – Monomial as byte array</li></ul><p><strong>Output</strong></p><ul><li><code>idx</code> – Monomial index or -1 if no valid next monomial</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L347-L359">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_desc_paropsth!" href="#GTPSA.mad_desc_paropsth!"><code>GTPSA.mad_desc_paropsth!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_desc_paropsth!(d::Ptr{Desc}, mult_, comp_)</code></pre><p>Sets the parallelised operations thresholds for multiplication (<code>mult_</code>) and/or composition (<code>comp_</code>). Will return in <code>mult_</code> and/or <code>comp_</code> the previous threshold.</p><p><strong>Input</strong></p><ul><li><code>mult_</code> – (Optional) <code>Ptr{Cint}</code> to new multiplication OMP parallelization threshold</li><li><code>comp_</code> – (Optional) <code>Ptr{Cint}</code> to new composition OMP parallelization threshold</li></ul><p><strong>Output</strong></p><ul><li><code>mult_</code> – (Optional) old multiplication parallelization threshold</li><li><code>comp_</code> – (Optional) old composition parallelization threshold</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/desc.jl#L425-L438">source</a></section></article><h3 id="TPS{Float64}"><a class="docs-heading-anchor" href="#TPS{Float64}">TPS{Float64}</a><a id="TPS{Float64}-1"></a><a class="docs-heading-anchor-permalink" href="#TPS{Float64}" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_abs!" href="#GTPSA.mad_tpsa_abs!"><code>GTPSA.mad_tpsa_abs!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_abs!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the absolute value of TPSA <code>a</code>. Specifically, the  result contains a TPSA with the <code>abs</code> of all coefficients.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = |a|</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L927-L938">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_acc!" href="#GTPSA.mad_tpsa_acc!"><code>GTPSA.mad_tpsa_acc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_acc!(a::RealTPS, v::Cdouble, c::RealTPS)</code></pre><p>Adds <code>a*v</code> to TPSA <code>c</code>. Aliasing OK.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>v</code> – Scalar with double precision</li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c += v*a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1426-L1437">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_acos!" href="#GTPSA.mad_tpsa_acos!"><code>GTPSA.mad_tpsa_acos!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_acos!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>acos</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = acos(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1203-L1213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_acosh!" href="#GTPSA.mad_tpsa_acosh!"><code>GTPSA.mad_tpsa_acosh!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_acosh!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>acosh</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA `c = acosh(a)&#39;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1282-L1292">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_acot!" href="#GTPSA.mad_tpsa_acot!"><code>GTPSA.mad_tpsa_acot!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_acot!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>acot</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = acot(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1235-L1245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_acoth!" href="#GTPSA.mad_tpsa_acoth!"><code>GTPSA.mad_tpsa_acoth!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_acoth!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the acoth of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA `c = acoth(a)&#39;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1314-L1324">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_add!" href="#GTPSA.mad_tpsa_add!"><code>GTPSA.mad_tpsa_add!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_add!(a::RealTPS, b::RealTPS, c::RealTPS)</code></pre><p>Sets the destination TPSA <code>c = a + b</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>b</code> – Source TPSA <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = a + b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L791-L802">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_asin!" href="#GTPSA.mad_tpsa_asin!"><code>GTPSA.mad_tpsa_asin!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_asin!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>asin</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = asin(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1187-L1197">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_asinc!" href="#GTPSA.mad_tpsa_asinc!"><code>GTPSA.mad_tpsa_asinc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_asinc!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>asinc(a) = asin(a)/a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = asinc(a) = asin(a)/a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1250-L1260">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_asinh!" href="#GTPSA.mad_tpsa_asinh!"><code>GTPSA.mad_tpsa_asinh!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_asinh!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>asinh</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA `c = asinh(a)&#39;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1266-L1276">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_asinhc!" href="#GTPSA.mad_tpsa_asinhc!"><code>GTPSA.mad_tpsa_asinhc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_asinhc!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>asinhc</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA `c = asinhc(a)&#39;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1330-L1340">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_atan!" href="#GTPSA.mad_tpsa_atan!"><code>GTPSA.mad_tpsa_atan!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_atan!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>atan</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = atan(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1219-L1229">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_atan2!" href="#GTPSA.mad_tpsa_atan2!"><code>GTPSA.mad_tpsa_atan2!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_atan2!(y::RealTPS, x::RealTPS, r::RealTPS)</code></pre><p>Sets TPSA <code>r</code> to <code>atan2(y,x)</code></p><p><strong>Input</strong></p><ul><li><code>y</code> – Source TPSA <code>y</code></li><li><code>x</code> – Source TPSA <code>x</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA r = atan2(y,x)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1510-L1521">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_atanh!" href="#GTPSA.mad_tpsa_atanh!"><code>GTPSA.mad_tpsa_atanh!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_atanh!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>atanh</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA `c = atanh(a)&#39;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1298-L1308">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_ax2pby2pcz2!" href="#GTPSA.mad_tpsa_ax2pby2pcz2!"><code>GTPSA.mad_tpsa_ax2pby2pcz2!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_ax2pby2pcz2!(a::Cdouble, x::RealTPS, b::Cdouble, y::RealTPS, c::Cdouble, z::RealTPS, r::RealTPS)</code></pre><p><code>r = a*x^2 + b*y^2 + c*z^2</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Scalar <code>a</code></li><li><code>x</code> – TPSA <code>x</code></li><li><code>b</code> – Scalar <code>b</code></li><li><code>y</code> – TPSA <code>y</code></li><li><code>c</code> – Scalar <code>c</code></li><li><code>z</code> – TPSA <code>z</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1770-L1785">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_axpb!" href="#GTPSA.mad_tpsa_axpb!"><code>GTPSA.mad_tpsa_axpb!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_axpb!(a::Cdouble, x::RealTPS, b::Cdouble, r::RealTPS)</code></pre><p><code>r = a*x + b</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Scalar <code>a</code></li><li><code>x</code> – TPSA <code>x</code></li><li><code>b</code> – Scalar <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1670-L1682">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_axpbypc!" href="#GTPSA.mad_tpsa_axpbypc!"><code>GTPSA.mad_tpsa_axpbypc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_axpbypc!(a::Cdouble, x::RealTPS, b::Cdouble, y::RealTPS, c::Cdouble, r::RealTPS)</code></pre><p><code>r = a*x + b*y + c</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Scalar <code>a</code></li><li><code>x</code> – TPSA <code>x</code></li><li><code>b</code> – Scalar <code>b</code></li><li><code>y</code> – TPSA <code>y</code></li><li><code>c</code> – Scalar <code>c</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1688-L1702">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_axpsqrtbpcx2!" href="#GTPSA.mad_tpsa_axpsqrtbpcx2!"><code>GTPSA.mad_tpsa_axpsqrtbpcx2!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_axpsqrtbpcx2!(x::RealTPS, a::Cdouble, b::Cdouble, c::Cdouble, r::RealTPS)</code></pre><p><code>r = a*x + sqrt(b + c*x^2)</code></p><p><strong>Input</strong></p><ul><li><code>x</code> – TPSA <code>x</code></li><li><code>a</code> – Scalar <code>a</code></li><li><code>b</code> – Scalar <code>b</code></li><li><code>c</code> – Scalar <code>c</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1791-L1804">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_axypb!" href="#GTPSA.mad_tpsa_axypb!"><code>GTPSA.mad_tpsa_axypb!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_axypb!(a::Cdouble, x::RealTPS, y::RealTPS, b::Cdouble, r::RealTPS)</code></pre><p><code>r = a*x*y + b</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Scalar <code>a</code></li><li><code>x</code> – TPSA <code>x</code></li><li><code>y</code> – TPSA <code>y</code></li><li><code>b</code> – Scalar <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1708-L1721">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_axypbvwpc!" href="#GTPSA.mad_tpsa_axypbvwpc!"><code>GTPSA.mad_tpsa_axypbvwpc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_axypbvwpc!(a::Cdouble, x::RealTPS, y::RealTPS, b::Cdouble, v::RealTPS, w::RealTPS, c::Cdouble, r::RealTPS)</code></pre><p><code>r = a*x*y + b*v*w + c</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Scalar <code>a</code></li><li><code>x</code> – TPSA <code>x</code></li><li><code>y</code> – TPSA <code>y</code></li><li><code>b</code> – Scalar <code>b</code></li><li><code>v</code> – TPSA v</li><li><code>w</code> – TPSA w</li><li><code>c</code> – Scalar <code>c</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1748-L1764">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_axypbzpc!" href="#GTPSA.mad_tpsa_axypbzpc!"><code>GTPSA.mad_tpsa_axypbzpc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_axypbzpc!(a::Cdouble, x::RealTPS, y::RealTPS, b::Cdouble, z::RealTPS, c::Cdouble, r::RealTPS)</code></pre><p><code>r = a*x*y + b*z + c</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Scalar <code>a</code></li><li><code>x</code> – TPSA <code>x</code></li><li><code>y</code> – TPSA <code>y</code></li><li><code>b</code> – Scalar <code>b</code></li><li><code>z</code> – TPSA <code>z</code></li><li><code>c</code> – Scalar <code>c</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1727-L1742">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_clear!" href="#GTPSA.mad_tpsa_clear!"><code>GTPSA.mad_tpsa_clear!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_clear!(t::RealTPS)</code></pre><p>Clears the TPSA (reset to 0)</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L360-L367">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_clrord!" href="#GTPSA.mad_tpsa_clrord!"><code>GTPSA.mad_tpsa_clrord!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_clrord!(t::RealTPS, ord::Cuchar)</code></pre><p>Clears all monomial coefficients of the TPSA at order <code>ord</code></p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>ord</code> – Order to clear monomial coefficients</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L250-L258">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_compose!" href="#GTPSA.mad_tpsa_compose!"><code>GTPSA.mad_tpsa_compose!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_compose!(na::Cint, ma, nb::Cint, mb, mc)</code></pre><p>Composes two maps.</p><p><strong>Input</strong></p><ul><li><code>na</code> – Number of TPSAs in map <code>ma</code></li><li><code>ma</code> – map <code>ma</code></li><li><code>nb</code> – Number of TPSAs in map <code>mb</code></li><li><code>mb</code> – map <code>mb</code></li></ul><p><strong>Output</strong></p><ul><li><code>mc</code> – Composition of maps <code>ma</code> and <code>mb</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2075-L2088">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_convert!" href="#GTPSA.mad_tpsa_convert!"><code>GTPSA.mad_tpsa_convert!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_convert!(t::RealTPS, r::RealTPS, n::Cint, t2r_, pb::Cint)</code></pre><p>General function to convert TPSAs to different orders and reshuffle canonical coordinates. The destination TPSA will  be of order <code>n</code>, and optionally have the variable reshuffling defined by <code>t2r_</code> and poisson bracket sign. e.g. if  <code>t2r_ = {1,2,3,4,6,5}</code> and <code>pb = -1</code>, canonical coordinates 6 and 5 are swapped and the new 5th canonical coordinate  will be negated. Useful for comparing with different differential algebra packages.</p><p><strong>Input</strong></p><ul><li><code>t</code>    – Source TPSA</li><li><code>n</code>    – Length of vector</li><li><code>t2r_</code> – (Optional) Vector of index lookup</li><li><code>pb</code>   – Poisson bracket, 0, 1:fwd, -1:bwd</li></ul><p><strong>Output</strong></p><ul><li><code>r</code>    – Destination TPSA with specified order and canonical coordinate reshuffling.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L283-L299">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_copy!" href="#GTPSA.mad_tpsa_copy!"><code>GTPSA.mad_tpsa_copy!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_copy!(t::RealTPS, r::RealTPS)</code></pre><p>Makes a copy of the TPSA <code>t</code> to <code>r</code>.</p><p><strong>Input</strong></p><ul><li><code>t</code> – Source TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L181-L191">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_cos!" href="#GTPSA.mad_tpsa_cos!"><code>GTPSA.mad_tpsa_cos!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_cos!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>cos</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = cos(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1026-L1036">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_cosh!" href="#GTPSA.mad_tpsa_cosh!"><code>GTPSA.mad_tpsa_cosh!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_cosh!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>cosh</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = cosh(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1123-L1133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_cot!" href="#GTPSA.mad_tpsa_cot!"><code>GTPSA.mad_tpsa_cot!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_cot!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>cot</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = cot(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1058-L1068">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_coth!" href="#GTPSA.mad_tpsa_coth!"><code>GTPSA.mad_tpsa_coth!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_coth!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>coth</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = coth(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1155-L1165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_cpyi!" href="#GTPSA.mad_tpsa_cpyi!"><code>GTPSA.mad_tpsa_cpyi!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_cpyi!(t::RealTPS, r::RealTPS, i::Cint)</code></pre><p>Copies the monomial coefficient at index <code>i</code> in <code>t</code> into the  same monomial coefficient in <code>r</code></p><p><strong>Input</strong></p><ul><li><code>t</code> – Source TPSA</li><li><code>r</code> – Destination TPSA </li><li><code>i</code> – Index of monomial</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L648-L658">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_cpym!" href="#GTPSA.mad_tpsa_cpym!"><code>GTPSA.mad_tpsa_cpym!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_cpym!(t::RealTPS, r::RealTPS, n::Cint, m)</code></pre><p>Copies the monomial coefficient at the monomial-as-vector-of-orders <code>m</code> in <code>t</code> into the same monomial coefficient in <code>r</code></p><p><strong>Input</strong></p><ul><li><code>t</code> – Source TPSA</li><li><code>r</code> – Destination TPSA </li><li><code>n</code> – Length of monomial <code>m</code></li><li><code>m</code> – Monomial as vector of orders</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L679-L690">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_cpys!" href="#GTPSA.mad_tpsa_cpys!"><code>GTPSA.mad_tpsa_cpys!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_cpys!(t::RealTPS, r::RealTPS, n::Cint, s::Cstring)</code></pre><p>Copies the monomial coefficient at the monomial-as-string-of-order <code>s</code> in <code>t</code> into the same monomial coefficient in <code>r</code></p><p><strong>Input</strong></p><ul><li><code>t</code> – Source TPSA</li><li><code>r</code> – Destination TPSA </li><li><code>n</code> – Length of string</li><li><code>s</code> – Monomial as string</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L663-L674">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_cpysm!" href="#GTPSA.mad_tpsa_cpysm!"><code>GTPSA.mad_tpsa_cpysm!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_cpysm!(t::RealTPS, r::RealTPS, n::Cint, m)</code></pre><p>Copies the monomial coefficient at the monomial-as-sparse-monomial <code>m</code> in <code>t</code> into the same monomial coefficient in <code>r</code></p><p><strong>Input</strong></p><ul><li><code>t</code> – Source TPSA</li><li><code>r</code> – Destination TPSA </li><li><code>n</code> – Length of monomial <code>m</code></li><li><code>m</code> – Monomial as sparse-monomial</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L696-L707">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_cutord!" href="#GTPSA.mad_tpsa_cutord!"><code>GTPSA.mad_tpsa_cutord!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_cutord!(t::RealTPS, r::RealTPS, ord::Cint)</code></pre><p>Cuts the TPSA off at the given order and above, or if <code>ord</code> is negative, will cut orders below  <code>abs(ord)</code> (e.g. if ord = -3, then orders 0-3 are cut off).</p><p><strong>Input</strong></p><ul><li><code>t</code>   – Source TPSA</li><li><code>ord</code> – Cut order: <code>0..-ord</code> or <code>ord..mo</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code>   – Destination TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L233-L245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_cycle!" href="#GTPSA.mad_tpsa_cycle!"><code>GTPSA.mad_tpsa_cycle!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_cycle!(t::RealTPS, i::Cint, n::Cint, m_, v_)::Cint</code></pre><p>Used for scanning through each nonzero monomial in the TPSA. Given a starting index (-1 if starting at 0), will  optionally fill monomial <code>m_</code> with the monomial at index <code>i</code> and the value at <code>v_</code> with the monomials coefficient, and  return the next NONZERO monomial index in the TPSA. This is useful for building an iterator through the TPSA.</p><p><strong>Input</strong></p><ul><li><code>t</code>  – TPSA to scan</li><li><code>i</code>  – Index to start from (-1 to start at 0)</li><li><code>n</code>  – Length of monomial</li><li><code>m_</code> – (Optional) Monomial to be filled if provided</li><li><code>v_</code> – (Optional) Pointer to value of coefficient</li></ul><p><strong>Output</strong></p><ul><li><code>i</code>  – Index of next nonzero monomial in the TPSA, or -1 if reached the end</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L476-L492">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_debug" href="#GTPSA.mad_tpsa_debug"><code>GTPSA.mad_tpsa_debug</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_debug(t::RealTPS, name_::Cstring, fnam_::Cstring, line_::Cint, stream_::Ptr{Cvoid})::Cint</code></pre><p>Prints TPSA with all information of data structure.</p><p><strong>Input</strong></p><ul><li><code>t</code>       – TPSA</li><li><code>name_</code>   – (Optional) Name of TPSA</li><li><code>fnam_</code>   – (Optional) File name to print to</li><li><code>line_</code>   – (Optional) Line number in file to start at</li><li><code>stream_</code> – (Optional) I/O stream to print to, default is <code>stdout</code></li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – <code>Cint</code> reflecting internal state of TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2245-L2259">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_del!" href="#GTPSA.mad_tpsa_del!"><code>GTPSA.mad_tpsa_del!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_del!(t::Ref{TPS{Float64}})</code></pre><p>Calls the destructor for the TPSA.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA to destruct</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L43-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_density" href="#GTPSA.mad_tpsa_density"><code>GTPSA.mad_tpsa_density</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_density(t::RealTPS, stat_, reset::Bool)::Cdouble</code></pre><p>Computes the ratio of <code>nz</code>/<code>nc</code> in <code>[0] U [lo,hi]</code> or <code>stat_</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2298-L2302">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_deriv!" href="#GTPSA.mad_tpsa_deriv!"><code>GTPSA.mad_tpsa_deriv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_deriv!(a::RealTPS, c::RealTPS, iv::Cint)</code></pre><p>Differentiates TPSA with respect to the variable with index <code>iv</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code>  – Source TPSA to differentiate</li><li><code>iv</code> – Index of variable to take derivative wrt to (e.g. derivative wrt <code>x</code>, <code>iv = 1</code>). </li></ul><p><strong>Output</strong></p><ul><li><code>c</code>  – Destination TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1578-L1589">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_derivm!" href="#GTPSA.mad_tpsa_derivm!"><code>GTPSA.mad_tpsa_derivm!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_derivm!(a::RealTPS, c::RealTPS, n::Cint, m)</code></pre><p>Differentiates TPSA with respect to the monomial defined by byte array <code>m</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA to differentiate</li><li><code>n</code> – Length of monomial to differentiate wrt</li><li><code>m</code> – Monomial to take derivative wrt</li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1595-L1607">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_desc" href="#GTPSA.mad_tpsa_desc"><code>GTPSA.mad_tpsa_desc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_desc(t::RealTPS)::Ptr{Desc}</code></pre><p>Gets the descriptor for the TPSA.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Descriptor for the TPS{Float64}</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L56-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_dif!" href="#GTPSA.mad_tpsa_dif!"><code>GTPSA.mad_tpsa_dif!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_dif!(a::RealTPS, b::RealTPS, c::RealTPS)</code></pre><p>For each homogeneous polynomial in TPSAs <code>a</code> and <code>b</code>, calculates either the relative error or absolute error for each order. If the maximum coefficient for a given order in <code>a</code> is &gt; 1, the relative error is computed for that order. Else, the absolute  error is computed. This is very useful for comparing maps between codes or doing unit tests. In Julia, essentially:</p><p><code>c_i = (a_i.-b_i)/maximum([abs.(a_i)...,1])</code> where <code>a_i</code> and <code>b_i</code> are vectors of the monomials for an order <code>i</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>b</code> – Source TPSA <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c</code> </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L770-L785">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_div!" href="#GTPSA.mad_tpsa_div!"><code>GTPSA.mad_tpsa_div!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_div!(a::RealTPS, b::RealTPS, c::RealTPS)</code></pre><p>Sets the destination TPSA <code>c = a / b</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>b</code> – Source TPSA <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = a / b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L842-L853">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_equ" href="#GTPSA.mad_tpsa_equ"><code>GTPSA.mad_tpsa_equ</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_equ(a::RealTPS, b::RealTPS, tol_::Cdouble)::Bool</code></pre><p>Checks if the TPSAs <code>a</code> and <code>b</code> are equal within the specified tolerance <code>tol_</code>. If <code>tol_</code> is not specified, <code>DBL_GTPSA.show_epsILON</code> is used.</p><p><strong>Input</strong></p><ul><li><code>a</code>    – TPSA <code>a</code></li><li><code>b</code>    – TPSA <code>b</code></li><li><code>tol_</code> – (Optional) Difference below which the TPSAs are considered equal</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>   - True if <code>a == b</code> within <code>tol_</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L751-L763">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_erf!" href="#GTPSA.mad_tpsa_erf!"><code>GTPSA.mad_tpsa_erf!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_erf!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>erf</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA `c = erf(a)&#39;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1346-L1356">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_erfc!" href="#GTPSA.mad_tpsa_erfc!"><code>GTPSA.mad_tpsa_erfc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_erfc!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>erfc</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA `c = erfc(a)&#39;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1362-L1372">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_eval!" href="#GTPSA.mad_tpsa_eval!"><code>GTPSA.mad_tpsa_eval!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_eval!(na::Cint, ma, nb::Cint, tb, tc)</code></pre><p>Evaluates the map at the point <code>tb</code></p><p><strong>Input</strong></p><ul><li><code>na</code> – Number of TPSAs in the map</li><li><code>ma</code> – map <code>ma</code></li><li><code>nb</code> – Length of <code>tb</code></li><li><code>tb</code> – Point at which to evaluate the map</li></ul><p><strong>Output</strong></p><ul><li><code>tc</code> – Values for each TPSA in the map evaluated at the point <code>tb</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2123-L2136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_exp!" href="#GTPSA.mad_tpsa_exp!"><code>GTPSA.mad_tpsa_exp!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_exp!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the exponential of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = exp(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L960-L970">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_exppb!" href="#GTPSA.mad_tpsa_exppb!"><code>GTPSA.mad_tpsa_exppb!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_exppb!(na::Cint, ma, mb, mc)</code></pre><p>Computes the exponential of fgrad of the vector fields <code>ma</code> and <code>mb</code>, literally <code>exppb(ma, mb) = mb + fgrad(ma, mb) + fgrad(ma, fgrad(ma, mb))/2! + ...</code></p><p><strong>Input</strong></p><ul><li><code>na</code> – Length of <code>ma</code> and <code>mb</code></li><li><code>ma</code> – Vector of TPSA <code>ma</code></li><li><code>mb</code> – Vector of TPSA <code>mb</code></li></ul><p><strong>Output</strong></p><ul><li><code>mc</code> – Destination vector of TPSA <code>mc</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1935-L1948">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_fgrad!" href="#GTPSA.mad_tpsa_fgrad!"><code>GTPSA.mad_tpsa_fgrad!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_fgrad!(na::Cint, ma, b::RealTPS, c::RealTPS)</code></pre><p>Calculates <code>dot(ma, grad(b))</code></p><p><strong>Input</strong></p><ul><li><code>na</code> – Length of <code>ma</code> consistent with number of variables in <code>b</code></li><li><code>ma</code> – Vector of TPSA</li><li><code>b</code>  – TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>c</code>  – <code>dot(ma, grad(b))</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1890-L1902">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_fld2vec!" href="#GTPSA.mad_tpsa_fld2vec!"><code>GTPSA.mad_tpsa_fld2vec!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_fld2vec!(na::Cint, ma, c::RealTPS)</code></pre><p>Assuming the variables in the TPSA are canonically-conjugate, and ordered so that the canonically- conjugate variables are consecutive (q1, p1, q2, p2, ...), calculates the Hamiltonian one obtains  from ther vector field (in the form <code>[da/dp1, -da/dq1, ...]</code>)</p><p><strong>Input</strong></p><ul><li><code>na</code>  – Number of TPSA in <code>ma</code> consistent with number of variables in <code>c</code></li><li><code>ma</code>  – Vector field </li></ul><p><strong>Output</strong></p><ul><li><code>c</code>   – Hamiltonian as a TPSA derived from the vector field <code>ma</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1868-L1881">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_geti" href="#GTPSA.mad_tpsa_geti"><code>GTPSA.mad_tpsa_geti</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_geti(t::RealTPS, i::Cint)::Cdouble</code></pre><p>Gets the coefficient of the monomial at index <code>i</code>. Generally should use <code>mad_tpsa_cycle</code> instead of this.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>i</code>   – Monomial index</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Coefficient of monomial at index <code>i</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L501-L512">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_getm" href="#GTPSA.mad_tpsa_getm"><code>GTPSA.mad_tpsa_getm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_getm(t::RealTPS, n::Cint, m)::Cdouble</code></pre><p>Gets the coefficient of the monomial <code>m</code> defined as a byte array. Generally should use <code>mad_tpsa_cycle</code> instead of this.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>n</code>   – Length of monomial</li><li><code>m</code>   – Monomial as byte array</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Coefficient of monomial <code>m</code> in TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L538-L550">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_getord!" href="#GTPSA.mad_tpsa_getord!"><code>GTPSA.mad_tpsa_getord!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_getord!(t::RealTPS, r::RealTPS, ord::Cuchar)</code></pre><p>Extract one homogeneous polynomial of the given order</p><p><strong>Input</strong></p><ul><li><code>t</code>  – Source TPSA</li><li><code>ord</code> – Order to retrieve</li></ul><p><strong>Output</strong></p><ul><li><code>r</code>   – Destination TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L216-L227">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_gets" href="#GTPSA.mad_tpsa_gets"><code>GTPSA.mad_tpsa_gets</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_gets(t::RealTPS, n::Cint, s::Cstring)::Cdouble</code></pre><p>Gets the coefficient of the monomial <code>s</code> defined as a string. Generally should use <code>mad_tpsa_cycle</code> instead of this.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>n</code>   – Length of monomial</li><li><code>s</code>   – Monomial as string</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Coefficient of monomial <code>s</code> in TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L519-L531">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_getsm" href="#GTPSA.mad_tpsa_getsm"><code>GTPSA.mad_tpsa_getsm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_getsm(t::RealTPS, n::Cint, m)::Cdouble</code></pre><p>Gets the coefficient of the monomial <code>m</code> defined as a sparse monomial. Generally should use <code>mad_tpsa_cycle</code> instead of this.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>n</code>   – Length of monomial</li><li><code>m</code>   – Monomial as sparse monomial</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Coefficient of monomial <code>m</code> in TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L558-L570">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_getv!" href="#GTPSA.mad_tpsa_getv!"><code>GTPSA.mad_tpsa_getv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_getv!(t::RealTPS, i::Cint, n::Cint, v)</code></pre><p>Vectorized getter of the coefficients for monomials with indices <code>i..i+n</code>. Useful for extracting the 1st order parts of  a TPSA to construct a matrix (<code>i = 1</code>, <code>n = nv+np = nn</code>). </p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>i</code> – Starting index of monomials to get coefficients</li><li><code>n</code> – Number of monomials to get coefficients of starting at <code>i</code></li></ul><p><strong>Output</strong></p><ul><li><code>v</code> – Array of coefficients for monomials <code>i..i+n</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L714-L728">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_hypot!" href="#GTPSA.mad_tpsa_hypot!"><code>GTPSA.mad_tpsa_hypot!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_hypot!(x::RealTPS, y::RealTPS, r::RealTPS)</code></pre><p>Sets TPSA <code>r</code> to <code>sqrt(x^2+y^2)</code>. Used to oversimplify polymorphism in code but not optimized</p><p><strong>Input</strong></p><ul><li><code>x</code> – Source TPSA <code>x</code></li><li><code>y</code> – Source TPSA <code>y</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA r = sqrt(x^2+y^2)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1526-L1537">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_hypot3!" href="#GTPSA.mad_tpsa_hypot3!"><code>GTPSA.mad_tpsa_hypot3!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_hypot3!(x::RealTPS, y::RealTPS, z::RealTPS, r::RealTPS)</code></pre><p>Sets TPSA <code>r</code> to <code>sqrt(x^2+y^2+z^2)</code>. Does NOT allow for r = x, y, z !!!</p><p><strong>Input</strong></p><ul><li><code>x</code> – Source TPSA <code>x</code></li><li><code>y</code> – Source TPSA <code>y</code></li><li><code>z</code> – Source TPSA <code>z</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r = sqrt(x^2+y^2+z^2)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1542-L1554">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_idxm" href="#GTPSA.mad_tpsa_idxm"><code>GTPSA.mad_tpsa_idxm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_idxm(t::RealTPS, n::Cint, m)::Cint</code></pre><p>Returns index of monomial in the TPSA given the monomial as a byte array</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>n</code>   – Length of monomial</li><li><code>s</code>   – Monomial as byte array</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Index of monomial in TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L435-L447">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_idxs" href="#GTPSA.mad_tpsa_idxs"><code>GTPSA.mad_tpsa_idxs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_idxs(t::RealTPS, n::Cint, s::Cstring)::Cint</code></pre><p>Returns index of monomial in the TPSA given the monomial as string. This generally should not be used, as there  are no assumptions about which monomial is attached to which index.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>n</code>   – Length of monomial</li><li><code>s</code>   – Monomial as string</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Index of monomial in TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L414-L427">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_idxsm" href="#GTPSA.mad_tpsa_idxsm"><code>GTPSA.mad_tpsa_idxsm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_idxsm(t::RealTPS, n::Cint, m)::Cint</code></pre><p>Returns index of monomial in the TPSA given the monomial as a sparse monomial. This generally should not be used, as there  are no assumptions about which monomial is attached to which index.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>n</code>   – Length of monomial</li><li><code>s</code>   – Monomial as sparse monomial</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Index of monomial in TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L455-L468">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_init!" href="#GTPSA.mad_tpsa_init!"><code>GTPSA.mad_tpsa_init!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_init(t::RealTPS, d::Ptr{Desc}, mo::Cuchar)::RealTPS</code></pre><p>Unsafe initialization of an already existing TPSA <code>t</code> with maximum order <code>mo</code> to the descriptor <code>d</code>. <code>mo</code> must be less than  the maximum order of the descriptor. <code>t</code> is modified in place and also returned.</p><p><strong>Input</strong></p><ul><li><code>t</code>  – TPSA to initialize to descriptor <code>d</code></li><li><code>d</code>  – Descriptor</li><li><code>mo</code> – Maximum order of the TPSA (must be less than maximum order of the descriptor)</li></ul><p><strong>Output</strong></p><ul><li><code>t</code>  – TPSA initialized to descriptor <code>d</code> with maximum order <code>mo</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2309-L2322">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_integ!" href="#GTPSA.mad_tpsa_integ!"><code>GTPSA.mad_tpsa_integ!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_integ!(a::RealTPS, c::RealTPS, iv::Cint)</code></pre><p>Integrates TPSA with respect to the variable with index <code>iv</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code>  – Source TPSA to integrate</li><li><code>iv</code> – Index of variable to integrate over (e.g. integrate over <code>x</code>, <code>iv = 1</code>). </li></ul><p><strong>Output</strong></p><ul><li><code>c</code>  – Destination TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1561-L1572">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_inv!" href="#GTPSA.mad_tpsa_inv!"><code>GTPSA.mad_tpsa_inv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_inv!(a::RealTPS,  v::Cdouble, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to <code>v/a</code>. </p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>v</code> – Scalar with double precision</li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = v/a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1460-L1471">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_invsqrt!" href="#GTPSA.mad_tpsa_invsqrt!"><code>GTPSA.mad_tpsa_invsqrt!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_invsqrt!(a::RealTPS, v::Cdouble, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to <code>v/sqrt(a)</code>. </p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>v</code> – Scalar with double precision</li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = v/sqrt(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1476-L1487">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_isnul" href="#GTPSA.mad_tpsa_isnul"><code>GTPSA.mad_tpsa_isnul</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_isnul(t::RealTPS)::Bool</code></pre><p>Checks if TPSA is 0 or not</p><p><strong>Input</strong></p><ul><li><code>t</code>    – TPSA to check</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>  – True or false</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L373-L383">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_isval" href="#GTPSA.mad_tpsa_isval"><code>GTPSA.mad_tpsa_isval</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_isval(t::RealTPS)::Bool</code></pre><p>Sanity check of the TPSA integrity.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA to check if valid</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>  – True if valid TPSA, false otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2265-L2275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_isvalid" href="#GTPSA.mad_tpsa_isvalid"><code>GTPSA.mad_tpsa_isvalid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_isvalid(t::RealTPS)::Bool</code></pre><p>Sanity check of the TPSA integrity.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA to check if valid</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>  – True if valid TPSA, false otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2281-L2291">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_len" href="#GTPSA.mad_tpsa_len"><code>GTPSA.mad_tpsa_len</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_len(t::RealTPS, hi_::Bool)::Cint</code></pre><p>Gets the length of the TPSA itself (e.g. the descriptor may be order 10 but TPSA may only be order 2)</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>hi_</code> – If <code>true</code>, returns the length up to the <code>hi</code> order in the TPSA, else up to <code>mo</code>. Default is false</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Length of TPS{Float64}</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L91-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_liebra!" href="#GTPSA.mad_tpsa_liebra!"><code>GTPSA.mad_tpsa_liebra!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_liebra!(na::Cint, ma, mb, mc)</code></pre><p>Computes the Lie bracket of the vector fields <code>ma</code> and <code>mb</code>, defined as  sum<em>i ma</em>i (dmb/dx<em>i) - mb</em>i (dma/dx_i).</p><p><strong>Input</strong></p><ul><li><code>na</code> – Length of <code>ma</code> and <code>mb</code></li><li><code>ma</code> – Vector of TPSA <code>ma</code></li><li><code>mb</code> – Vector of TPSA <code>mb</code></li></ul><p><strong>Output</strong></p><ul><li><code>mc</code> – Destination vector of TPSA <code>mc</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1911-L1924">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_log!" href="#GTPSA.mad_tpsa_log!"><code>GTPSA.mad_tpsa_log!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_log!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the log of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = log(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L977-L987">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_logaxpsqrtbpcx2!" href="#GTPSA.mad_tpsa_logaxpsqrtbpcx2!"><code>GTPSA.mad_tpsa_logaxpsqrtbpcx2!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_logaxpsqrtbpcx2!(x::RealTPS, a::Cdouble, b::Cdouble, c::Cdouble, r::RealTPS)</code></pre><p><code>r = log(a*x + sqrt(b + c*x^2))</code></p><p><strong>Input</strong></p><ul><li><code>x</code> – TPSA <code>x</code></li><li><code>a</code> – Scalar <code>a</code></li><li><code>b</code> – Scalar <code>b</code></li><li><code>c</code> – Scalar <code>c</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1810-L1823">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_logpb!" href="#GTPSA.mad_tpsa_logpb!"><code>GTPSA.mad_tpsa_logpb!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_logpb!(na::Cint, ma, mb, mc)</code></pre><p>Computes the log of the Poisson bracket of the vector of TPSA <code>ma</code> and <code>mb</code>; the result  is the vector field <code>F</code> used to evolve to <code>ma</code> from <code>mb</code>.</p><p><strong>Input</strong></p><ul><li><code>na</code> – Length of <code>ma</code> and <code>mb</code></li><li><code>ma</code> – Vector of TPSA <code>ma</code></li><li><code>mb</code> – Vector of TPSA <code>mb</code></li></ul><p><strong>Output</strong></p><ul><li><code>mc</code> – Destination vector of TPSA <code>mc</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1959-L1972">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_logxdy!" href="#GTPSA.mad_tpsa_logxdy!"><code>GTPSA.mad_tpsa_logxdy!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_logxdy!(x::RealTPS, y::RealTPS, r::RealTPS)</code></pre><p><code>r = log(x / y)</code></p><p><strong>Input</strong></p><ul><li><code>x</code> – TPSA <code>x</code></li><li><code>y</code> – TPSA <code>y</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1829-L1840">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_maxord!" href="#GTPSA.mad_tpsa_maxord!"><code>GTPSA.mad_tpsa_maxord!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_maxord!(t::RealTPS, n::Cint, idx_)::Cint</code></pre><p>Returns the index to the monomial with maximum abs(coefficient) in the TPSA for all orders 0 to <code>n</code>. If <code>idx_</code>  is provided, it is filled with the indices for the maximum abs(coefficient) monomial for each order up to <code>n</code>. </p><p><strong>Input</strong></p><ul><li><code>t</code>    – TPSA</li><li><code>n</code>    – Highest order to include in finding the maximum abs(coefficient) in the TPSA, length of <code>idx_</code> if provided</li></ul><p><strong>Output</strong></p><ul><li><code>idx_</code> – (Optional) If provided, is filled with indices to the monomial for each order up to <code>n</code> with maximum abs(coefficient)</li><li><code>mi</code>   – Index to the monomial in the TPSA with maximum abs(coefficient)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L263-L276">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_mconv!" href="#GTPSA.mad_tpsa_mconv!"><code>GTPSA.mad_tpsa_mconv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_mconv!(na::Cint, ma, nc::Cint, mc, n::Cint, t2r_, pb::Cint)</code></pre><p>Equivalent to <code>mad_tpsa_convert</code>, but applies the conversion to all TPSAs in the map <code>ma</code>.</p><p><strong>Input</strong></p><ul><li><code>na</code>   – Number of TPSAs in the map</li><li><code>ma</code>   – map <code>ma</code></li><li><code>nc</code>   – Number of TPSAs in the output map <code>mc</code></li><li><code>n</code>    – Length of vector (size of <code>t2r_</code>)</li><li><code>t2r_</code> – (Optional) Vector of index lookup</li><li><code>pb</code>   – Poisson bracket, 0, 1:fwd, -1:bwd</li></ul><p><strong>Output</strong></p><ul><li><code>mc</code>   – map <code>mc</code> with specified conversions </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2147-L2162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_minv!" href="#GTPSA.mad_tpsa_minv!"><code>GTPSA.mad_tpsa_minv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_minv!(na::Cint, ma, nb::Cint, mc)</code></pre><p>Inverts the map. To include the parameters in the inversion, <code>na</code> = <code>nn</code> and the output map  length only need be <code>nb</code> = <code>nv</code>.</p><p><strong>Input</strong></p><ul><li><code>na</code> – Input map length (should be <code>nn</code> to include parameters)</li><li><code>ma</code> – Map <code>ma</code></li><li><code>nb</code> – Output map length (generally = <code>nv</code>)</li></ul><p><strong>Output</strong></p><ul><li><code>mc</code> – Inversion of map <code>ma</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2027-L2040">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_mnrm" href="#GTPSA.mad_tpsa_mnrm"><code>GTPSA.mad_tpsa_mnrm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_mnrm(na::Cint, ma)::Cdouble</code></pre><p>Computes the norm of the map (sum of absolute value of coefficients of all TPSAs in the map).</p><p><strong>Input</strong></p><ul><li><code>na</code>  – Number of TPSAs in the map</li><li><code>ma</code>  – map <code>ma</code></li></ul><p><strong>Output</strong></p><ul><li><code>nrm</code> – Norm of map (sum of absolute value of coefficients of all TPSAs in the map)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2006-L2017">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_mo!" href="#GTPSA.mad_tpsa_mo!"><code>GTPSA.mad_tpsa_mo!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_mo!(t::RealTPS, mo::Cuchar)::Cuchar</code></pre><p>Sets the maximum order <code>mo</code> of the TPSA <code>t</code>, and returns the original <code>mo</code>. <code>mo</code> should be less than or equal to the allocated order <code>ao</code>.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>mo</code> – Maximum order to set the TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Original <code>mo</code> of the TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L108-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_mono!" href="#GTPSA.mad_tpsa_mono!"><code>GTPSA.mad_tpsa_mono!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_mono!(t::RealTPS, i::Cint, n::Cint, m_, p_)::Cuchar</code></pre><p>Returns the order of the monomial at index <code>i</code> in the TPSA and optionally the monomial at that index is returned in <code>m_</code>  and the order of parameters in the monomial in <code>p_</code></p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>i</code>   – Index valid in TPSA</li><li><code>n</code>   – Length of monomial</li></ul><p><strong>Output</strong></p><ul><li><code>m_</code>  – (Optional) Monomial at index <code>i</code> in TPSA</li><li><code>p_</code>  – (Optional) Order of parameters in monomial</li><li><code>ret</code> – Order of monomial in TPSA <code>a</code>t index <code>i</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L390-L405">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_mord" href="#GTPSA.mad_tpsa_mord"><code>GTPSA.mad_tpsa_mord</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_mord(na::Cint, ma, hi::Bool)::Cuchar</code></pre><p>If <code>hi</code> is false, getting the maximum <code>mo</code> among all TPSAs in <code>ma</code>.  If <code>hi</code> is <code>true</code>, gets the maximum <code>hi</code> of the map instead of <code>mo</code></p><p><strong>Input</strong></p><ul><li><code>na</code> – Length of map <code>ma</code></li><li><code>ma</code> – Map (vector of TPSAs)</li><li><code>hi</code> – If <code>true</code>, returns maximum <code>hi</code>, else returns maximum <code>mo</code> of the map</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Maximum <code>hi</code> of the map if <code>hi</code> is <code>true</code>, else returns maximum <code>mo</code> of the map</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1983-L1996">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_mul!" href="#GTPSA.mad_tpsa_mul!"><code>GTPSA.mad_tpsa_mul!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_mul!(a::RealTPS, b::RealTPS, c::RealTPS)</code></pre><p>Sets the destination TPSA <code>c = a * b</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>b</code> – Source TPSA <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = a * b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L825-L836">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_nam" href="#GTPSA.mad_tpsa_nam"><code>GTPSA.mad_tpsa_nam</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_nam(t::RealTPS, nam_)::Cstring</code></pre><p>Get the name of the TPSA, and will optionally set if <code>nam_ != null</code></p><p><strong>Input</strong></p><ul><li><code>t</code>    – TPSA</li><li><code>nam_</code> – Name to set the TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>  – Name of TPS{Float64} (null terminated in C)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L127-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_new" href="#GTPSA.mad_tpsa_new"><code>GTPSA.mad_tpsa_new</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_new(t::Ref{TPS{Float64}}, mo::Cuchar)</code></pre><p>Creates a blank TPSA with same number of variables/parameters of the inputted TPSA,  with maximum order specified by <code>mo</code>. If <code>MAD_TPSA_SAME</code> is passed for <code>mo</code>, the <code>mo</code>  currently in <code>t</code> is used for the created TPSA. Ok with <code>t=(tpsa_t*)ctpsa</code></p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>mo</code>  – Maximum order of new TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – New blank TPSA with maximum order <code>mo</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L23-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_newd" href="#GTPSA.mad_tpsa_newd"><code>GTPSA.mad_tpsa_newd</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_newd(d::Ptr{Desc}, mo::Cuchar)</code></pre><p>Creates a TPSA defined by the specified descriptor and maximum order. If <code>MAD_TPSA_DEFAULT</code>  is passed for <code>mo</code>, the <code>mo</code> defined in the descriptor is used. If <code>mo &gt; d_mo</code>, then <code>mo = d_mo</code>.</p><p><strong>Input</strong></p><ul><li><code>d</code>  – Descriptor</li><li><code>mo</code> – Maximum order</li></ul><p><strong>Output</strong></p><ul><li><code>t</code>  – New TPSA defined by the descriptor</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L4-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_nrm" href="#GTPSA.mad_tpsa_nrm"><code>GTPSA.mad_tpsa_nrm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_nrm(a::RealTPS)::Cdouble</code></pre><p>Calculates the 1-norm of TPSA <code>a</code> (sum of <code>abs</code> of all coefficients)</p><p><strong>Input</strong></p><ul><li><code>a</code>   – TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>nrm</code> – 1-Norm of TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L910-L920">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_ord" href="#GTPSA.mad_tpsa_ord"><code>GTPSA.mad_tpsa_ord</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_ord(t::RealTPS, hi_::Bool)::Cuchar</code></pre><p>Gets the TPSA maximum order, or <code>hi</code> if <code>hi_</code> is true.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>hi_</code> – Set <code>true</code> if <code>hi</code> is returned, else <code>mo</code> is returned</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Order of TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L145-L156">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_ordv" href="#GTPSA.mad_tpsa_ordv"><code>GTPSA.mad_tpsa_ordv</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_ordv(t::RealTPS, ts::RealTPS...)::Cuchar</code></pre><p>Returns maximum order of all TPSAs provided.</p><p><strong>Input</strong></p><ul><li><code>t</code>  – TPSA</li><li><code>ts</code> – Variable number of TPSAs passed as parameters</li></ul><p><strong>Output</strong></p><ul><li><code>mo</code> – Maximum order of all TPSAs provided</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L162-L173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_pminv!" href="#GTPSA.mad_tpsa_pminv!"><code>GTPSA.mad_tpsa_pminv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_pminv!(na::Cint, ma, nb::Cint, mc, select)</code></pre><p>Computes the partial inverse of the map with only the selected variables, specified by 0s or 1s in select. To include the parameters in the inversion, <code>na</code> = <code>nn</code> and the output map length only need be <code>nb</code> = <code>nv</code>.</p><p><strong>Input</strong></p><ul><li><code>na</code> – Input map length (should be <code>nn</code> to include parameters)</li><li><code>ma</code> – Map <code>ma</code></li><li><code>nb</code> – Output map length (generally = <code>nv</code>)</li><li><code>select</code> – Array of 0s or 1s defining which variables to do inverse on (atleast same size as na)&#39;</li></ul><p><strong>Output</strong></p><ul><li><code>mc</code>     – Partially inverted map using variables specified as 1 in the select array</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2050-L2064">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_poisbra!" href="#GTPSA.mad_tpsa_poisbra!"><code>GTPSA.mad_tpsa_poisbra!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_poisbra!(a::RealTPS, b::RealTPS, c::RealTPS, nv::Cint)</code></pre><p>Sets TPSA <code>c</code> to the poisson bracket of TPSAs <code>a</code> and <code>b</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code>  – Source TPSA <code>a</code></li><li><code>b</code>  – Source TPSA <code>b</code></li><li><code>nv</code> – Number of variables in the TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>c</code>  – Destination TPSA <code>c</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1614-L1626">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_pow!" href="#GTPSA.mad_tpsa_pow!"><code>GTPSA.mad_tpsa_pow!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_pow!(a::RealTPS, b::RealTPS, c::RealTPS)</code></pre><p>Sets the destination TPSA <code>c = a ^ b</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>b</code> – Source TPSA <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = a ^ b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L859-L870">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_powi!" href="#GTPSA.mad_tpsa_powi!"><code>GTPSA.mad_tpsa_powi!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_powi!(a::RealTPS, n::Cint, c::RealTPS)</code></pre><p>Sets the destination TPSA <code>c = a ^ n</code> where <code>n</code> is an integer.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>n</code> – Integer power</li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = a ^ n</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L876-L887">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_pown!" href="#GTPSA.mad_tpsa_pown!"><code>GTPSA.mad_tpsa_pown!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_pown!(a::RealTPS, v::Cdouble, c::RealTPS)</code></pre><p>Sets the destination TPSA <code>c = a ^ v</code> where <code>v</code> is of double precision.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>v</code> – &quot;double&quot; precision power</li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = a ^ v</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L893-L904">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_print" href="#GTPSA.mad_tpsa_print"><code>GTPSA.mad_tpsa_print</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_print(t::RealTPS, name_::Cstring, eps_::Cdouble, nohdr_::Cint, stream_::Ptr{Cvoid})</code></pre><p>Prints the TPSA coefficients with precision <code>eps_</code>. If <code>nohdr_</code> is not zero,  the header is not printed. </p><p><strong>Input</strong></p><ul><li><code>t</code>       – TPSA to print</li><li><code>name_</code>   – (Optional) Name of TPSA</li><li><code>eps_</code>    – (Optional) Precision to output</li><li><code>nohdr_</code>  – (Optional) If True, no header is printed</li><li><code>stream_</code> – (Optional) <code>FILE</code> pointer of output stream. Default is <code>stdout</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2173-L2185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_scan" href="#GTPSA.mad_tpsa_scan"><code>GTPSA.mad_tpsa_scan</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_scan(stream_::Ptr{Cvoid})::RealTPS</code></pre><p>Scans in a TPSA from the <code>stream_</code>.</p><p><strong>Input</strong></p><ul><li><code>stream_</code> – (Optional) I/O stream from which to read the TPSA, default is <code>stdin</code></li></ul><p><strong>Output</strong></p><ul><li><code>t</code>       – TPSA scanned from I/O <code>stream_</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2191-L2201">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_scan_coef!" href="#GTPSA.mad_tpsa_scan_coef!"><code>GTPSA.mad_tpsa_scan_coef!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_scan_coef!(t::RealTPS, stream_::Ptr{Cvoid})</code></pre><p>Read TPSA coefficients into TPSA <code>t</code>. This should be used with <code>mad_tpsa_scan_hdr</code> for external languages using  this library where the memory is managed NOT on the C side.</p><p><strong>Input</strong></p><ul><li><code>stream_</code> – (Optional) I/O stream to read TPSA from,  default is <code>stdin</code></li></ul><p><strong>Output</strong></p><ul><li><code>t</code>       – TPSA with coefficients scanned from <code>stream_</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2228-L2239">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_scan_hdr" href="#GTPSA.mad_tpsa_scan_hdr"><code>GTPSA.mad_tpsa_scan_hdr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_scan_hdr(kind_::Ref{Cint}, name_::Ptr{Cuchar}, stream_::Ptr{Cvoid})::Ptr{Desc}</code></pre><p>Read TPSA header. Returns descriptor for TPSA given the header. This is useful for external languages using  this library where the memory is managed NOT on the C side.</p><p><strong>Input</strong></p><ul><li><code>kind_</code>   – (Optional) Real or complex TPSA, or detect automatically if not provided.</li><li><code>name_</code>   – (Optional) Name of TPSA</li><li><code>stream_</code> – (Optional) I/O stream to read TPSA from,  default is <code>stdin</code></li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>     – Descriptor for the TPSA </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2208-L2221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_scl!" href="#GTPSA.mad_tpsa_scl!"><code>GTPSA.mad_tpsa_scl!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_scl!(a::RealTPS, v::Cdouble, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to <code>v*a</code>. </p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>v</code> – Scalar with double precision</li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = v*a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1443-L1454">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_sclord!" href="#GTPSA.mad_tpsa_sclord!"><code>GTPSA.mad_tpsa_sclord!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_sclord!(t::RealTPS, r::RealTPS, inv::Bool, prm::Bool)</code></pre><p>Scales all coefficients by order. If <code>inv == 0</code>, scales coefficients by order (derivation), else  scales coefficients by 1/order (integration).</p><p><strong>Input</strong></p><ul><li><code>t</code>   – Source TPSA</li><li><code>inv</code> – Put order up, divide, scale by <code>inv</code> of value of order</li><li><code>prm</code> – Parameters flag. If set to 0x0, the scaling excludes the order of the parameters in the monomials. Else, scaling is with total order of monomial</li></ul><p><strong>Output</strong></p><ul><li><code>r</code>   – Destination TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L197-L210">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_seti!" href="#GTPSA.mad_tpsa_seti!"><code>GTPSA.mad_tpsa_seti!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_seti!(t::RealTPS, i::Cint, a::Cdouble, b::Cdouble)</code></pre><p>Sets the coefficient of monomial at index <code>i</code> to <code>coef[i] = a*coef[i] + b</code>. Does not modify other values in TPSA.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>i</code> – Index of monomial</li><li><code>a</code> – Scaling of current coefficient</li><li><code>b</code> – Constant added to current coefficient</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L579-L589">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_setm!" href="#GTPSA.mad_tpsa_setm!"><code>GTPSA.mad_tpsa_setm!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_setm!(t::RealTPS, n::Cint, m, a::Cdouble, b::Cdouble)</code></pre><p>Sets the coefficient of monomial defined by byte array <code>m</code> to <code>coef = a*coef + b</code>. Does not modify other values in TPSA.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>n</code> – Length of monomial</li><li><code>m</code> – Monomial as byte array</li><li><code>a</code> – Scaling of current coefficient</li><li><code>b</code> – Constant added to current coefficient</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L612-L623">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_setprm!" href="#GTPSA.mad_tpsa_setprm!"><code>GTPSA.mad_tpsa_setprm!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_setprm!(t::RealTPS, v::Cdouble, ip::Cint)</code></pre><p>Sets the 0th and 1st order values for the specified parameter, and sets the rest of the variables/parameters to 0.  The 1st order value <code>scl_</code> of a parameter is always 1.</p><p><strong>Input</strong></p><ul><li><code>t</code>    – TPSA</li><li><code>v</code>    – 0th order value (coefficient)</li><li><code>ip</code>   – Parameter index (e.g. iv = 1 is nn-nv+1)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L321-L331">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_sets!" href="#GTPSA.mad_tpsa_sets!"><code>GTPSA.mad_tpsa_sets!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_sets!(t::RealTPS, n::Cint, s::Cstring, a::Cdouble, b::Cdouble)</code></pre><p>Sets the coefficient of monomial defined by string <code>s</code> to <code>coef = a*coef + b</code>. Does not modify other values in TPSA.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>n</code> – Length of monomial</li><li><code>s</code> – Monomial as string</li><li><code>a</code> – Scaling of current coefficient</li><li><code>b</code> – Constant added to current coefficient</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L595-L606">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_setsm!" href="#GTPSA.mad_tpsa_setsm!"><code>GTPSA.mad_tpsa_setsm!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_setsm!(t::RealTPS, n::Cint, m, a::Cdouble, b::Cdouble)</code></pre><p>Sets the coefficient of monomial defined by sparse monomial <code>m</code> to <code>coef = a*coef + b</code>. Does not modify other values in TPSA.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>n</code> – Length of monomial</li><li><code>m</code> – Monomial as sparse monomial</li><li><code>a</code> – Scaling of current coefficient</li><li><code>b</code> – Constant added to current coefficient</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L630-L641">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_setv!" href="#GTPSA.mad_tpsa_setv!"><code>GTPSA.mad_tpsa_setv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_setv!(t::RealTPS, i::Cint, n::Cint, v)</code></pre><p>Vectorized setter of the coefficients for monomials with indices <code>i..i+n</code>. Useful for putting a matrix into a map.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>i</code> – Starting index of monomials to set coefficients</li><li><code>n</code> – Number of monomials to set coefficients of starting at <code>i</code></li><li><code>v</code> – Array of coefficients for monomials <code>i..i+n</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L734-L744">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_setval!" href="#GTPSA.mad_tpsa_setval!"><code>GTPSA.mad_tpsa_setval!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_setval!(t::RealTPS, v::Cdouble)</code></pre><p>Sets the scalar part of the TPSA to <code>v</code> and all other values to 0 (sets the TPSA order to 0).</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA to set to scalar</li><li><code>v</code> – Scalar value to set TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L336-L344">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_setvar!" href="#GTPSA.mad_tpsa_setvar!"><code>GTPSA.mad_tpsa_setvar!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_setvar!(t::RealTPS, v::Cdouble, iv::Cint, scl_::Cdouble)</code></pre><p>Sets the 0th and 1st order values for the specified variable, and sets the rest of the variables/parameters to 0</p><p><strong>Input</strong></p><ul><li><code>t</code>    – TPSA</li><li><code>v</code>    – 0th order value (coefficient)</li><li><code>iv</code>   – Variable index</li><li><code>scl_</code> – 1st order variable value (typically will be 1)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L306-L316">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_sin!" href="#GTPSA.mad_tpsa_sin!"><code>GTPSA.mad_tpsa_sin!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_sin!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>sin</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = sin(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1010-L1020">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_sinc!" href="#GTPSA.mad_tpsa_sinc!"><code>GTPSA.mad_tpsa_sinc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_sinc!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>sinc</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = sinc(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1074-L1084">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_sincos!" href="#GTPSA.mad_tpsa_sincos!"><code>GTPSA.mad_tpsa_sincos!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_sincos!(a::RealTPS, s::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>s = sin(a)</code> and TPSA <code>c = cos(a)</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>s</code> – Destination TPSA <code>s = sin(a)</code></li><li><code>c</code> – Destination TPSA <code>c = cos(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L993-L1004">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_sincosh!" href="#GTPSA.mad_tpsa_sincosh!"><code>GTPSA.mad_tpsa_sincosh!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_sincosh!(a::RealTPS, s::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>s = sinh(a)</code> and TPSA <code>c = cosh(a)</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>s</code> – Destination TPSA <code>s = sinh(a)</code></li><li><code>c</code> – Destination TPSA <code>c = cosh(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1090-L1101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_sinh!" href="#GTPSA.mad_tpsa_sinh!"><code>GTPSA.mad_tpsa_sinh!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_sinh!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>sinh</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = sinh(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1107-L1117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_sinhc!" href="#GTPSA.mad_tpsa_sinhc!"><code>GTPSA.mad_tpsa_sinhc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_sinhc!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>sinhc</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = sinhc(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1171-L1181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_sqrt!" href="#GTPSA.mad_tpsa_sqrt!"><code>GTPSA.mad_tpsa_sqrt!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_sqrt!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the sqrt of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = sqrt(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L944-L954">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_sub!" href="#GTPSA.mad_tpsa_sub!"><code>GTPSA.mad_tpsa_sub!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_sub!(a::RealTPS, b::RealTPS, c::RealTPS)</code></pre><p>Sets the destination TPSA <code>c = a - b</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>b</code> – Source TPSA <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = a - b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L808-L819">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_tan!" href="#GTPSA.mad_tpsa_tan!"><code>GTPSA.mad_tpsa_tan!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_tan!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>tan</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = tan(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1042-L1052">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_tanh!" href="#GTPSA.mad_tpsa_tanh!"><code>GTPSA.mad_tpsa_tanh!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_tanh!(a::RealTPS, c::RealTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>tanh</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = tanh(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1139-L1149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_taylor!" href="#GTPSA.mad_tpsa_taylor!"><code>GTPSA.mad_tpsa_taylor!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_taylor!(a::RealTPS, n::Cint, coef, c::RealTPS)</code></pre><p>Computes the result of the Taylor series up to order <code>n-1</code> with Taylor coefficients coef for the scalar value in <code>a</code>. That is, <code>c = coef[0] + coef[1]*a_0 + coef[2]*a_0^2 + ...</code> where <code>a_0</code> is the scalar part of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code>    – TPSA <code>a</code></li><li><code>n</code>    – <code>Order-1</code> of Taylor expansion, size of <code>coef</code> array</li><li><code>coef</code> – Array of coefficients in Taylor <code>s</code></li><li><code>c</code>    – Result</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1632-L1643">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_taylor_h!" href="#GTPSA.mad_tpsa_taylor_h!"><code>GTPSA.mad_tpsa_taylor_h!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_taylor_h!(a::RealTPS, n::Cint, coef, c::RealTPS)</code></pre><p>Computes the result of the Taylor series up to order <code>n-1</code> with Taylor coefficients coef for  the scalar value in <code>a</code>. That is, <code>c = coef[0] + coef[1]*a_0 + coef[2]*a_0^2 + ...</code> where <code>a_0</code>  is the scalar part of TPSA <code>a</code>.</p><p>Same as <code>mad_tpsa_taylor</code>, but uses Horner&#39;s method (which is 50%-100% slower because mul is  always full order).</p><p><strong>Input</strong></p><ul><li><code>a</code>    – TPSA <code>a</code></li><li><code>n</code>    – <code>Order-1</code> of Taylor expansion, size of <code>coef</code> array</li><li><code>coef</code> – Array of coefficients in Taylor <code>s</code></li><li><code>c</code>    – Result</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1649-L1664">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_translate!" href="#GTPSA.mad_tpsa_translate!"><code>GTPSA.mad_tpsa_translate!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_translate!(na::Cint, ma, nb::Cint, tb, mc)</code></pre><p>Translates the expansion point of the map by the amount <code>tb</code>.</p><p><strong>Input</strong></p><ul><li><code>na</code> – Number of TPSAS in the map</li><li><code>ma</code> – map <code>ma</code></li><li><code>nb</code> – Length of <code>tb</code></li><li><code>tb</code> – Vector of amount to translate for each variable</li></ul><p><strong>Output</strong></p><ul><li><code>mc</code> – Map evaluated at the new point translated <code>tb</code> from the original evaluation point</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L2099-L2112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_uid!" href="#GTPSA.mad_tpsa_uid!"><code>GTPSA.mad_tpsa_uid!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_uid!(t::RealTPS, uid_::Cint)::Cint</code></pre><p>Sets the TPSA uid if <code>uid_ != 0</code>, and returns the current (previous if set) TPSA <code>uid</code>. </p><p><strong>Input</strong></p><ul><li><code>t</code>    – TPSA</li><li><code>uid_</code> – <code>uid</code> to set in the TPSA if <code>uid_ != 0</code></li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>  – Current (previous if set) TPSA uid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L73-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_unit!" href="#GTPSA.mad_tpsa_unit!"><code>GTPSA.mad_tpsa_unit!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_unit!(a::RealTPS, c::RealTPS)</code></pre><p>Interpreting TPSA as a vector, gets the &quot;unit vector&quot;, e.g. <code>c = a/norm(a)</code>.  May be useful for checking for convergence.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1493-L1504">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_update!" href="#GTPSA.mad_tpsa_update!"><code>GTPSA.mad_tpsa_update!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_update!(t::RealTPS)</code></pre><p>Updates the <code>lo</code> and <code>hi</code> fields of the TPSA to reflect the current state  given the lowest/highest nonzero monomial coefficients.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L349-L354">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_tpsa_vec2fld!" href="#GTPSA.mad_tpsa_vec2fld!"><code>GTPSA.mad_tpsa_vec2fld!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_tpsa_vec2fld!(na::Cint, a::RealTPS, mc)</code></pre><p>Assuming the variables in the TPSA are canonically-conjugate, and ordered so that the canonically- conjugate variables are consecutive (q1, p1, q2, p2, ...), calculates the vector field (Hamilton&#39;s  equations) from the passed Hamiltonian, defined as <code>[da/dp1, -da/dq1, ...]</code></p><p><strong>Input</strong></p><ul><li><code>na</code>  – Number of TPSA in <code>mc</code> consistent with number of variables in <code>a</code></li><li><code>a</code>   – Hamiltonian as a TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>mc</code>  – Vector field derived from <code>a</code> using Hamilton&#39;s equations </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/rtpsa.jl#L1846-L1859">source</a></section></article><h3 id="TPS{ComplexF64}"><a class="docs-heading-anchor" href="#TPS{ComplexF64}">TPS{ComplexF64}</a><a id="TPS{ComplexF64}-1"></a><a class="docs-heading-anchor-permalink" href="#TPS{ComplexF64}" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_acc!" href="#GTPSA.mad_ctpsa_acc!"><code>GTPSA.mad_ctpsa_acc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_acc!(a::ComplexTPS, v::ComplexF64, c::ComplexTPS)</code></pre><p>Adds <code>a*v</code> to TPSA <code>c</code>. Aliasing OK.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>v</code> – Scalar with double precision</li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c += v*a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1983-L1994">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_acc_r!" href="#GTPSA.mad_ctpsa_acc_r!"><code>GTPSA.mad_ctpsa_acc_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_acc_r!(a::ComplexTPS, v_re::Cdouble, v_im::Cdouble, c::ComplexTPS)</code></pre><p>Adds <code>a*v</code> to TPSA <code>c</code>. Aliasing OK. Without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>a</code>    – Source TPSA <code>a</code></li><li><code>v_re</code> – Real part of scalar with double precision</li><li><code>v_im</code> – Imaginary part of scalar with double precision</li></ul><p><strong>Output</strong></p><ul><li><code>c</code>    – Destination TPSA <code>c += v*a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2231-L2243">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_acos!" href="#GTPSA.mad_ctpsa_acos!"><code>GTPSA.mad_ctpsa_acos!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_acos!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>acos</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = acos(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1764-L1774">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_acosh!" href="#GTPSA.mad_ctpsa_acosh!"><code>GTPSA.mad_ctpsa_acosh!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_acosh!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>acosh</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = acosh(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1843-L1853">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_acot!" href="#GTPSA.mad_ctpsa_acot!"><code>GTPSA.mad_ctpsa_acot!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_acot!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>acot</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = acot(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1796-L1806">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_acoth!" href="#GTPSA.mad_ctpsa_acoth!"><code>GTPSA.mad_ctpsa_acoth!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_acoth!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>acoth</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = acoth(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1875-L1885">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_add!" href="#GTPSA.mad_ctpsa_add!"><code>GTPSA.mad_ctpsa_add!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_add!(a::ComplexTPS, b::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets the destination TPSA <code>c = a + b</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>b</code> – Source TPSA <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = a + b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1141-L1152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_addt!" href="#GTPSA.mad_ctpsa_addt!"><code>GTPSA.mad_ctpsa_addt!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_addt!(a::ComplexTPS, b::RealTPS, c::ComplexTPS)</code></pre><p>Sets the destination TPS{ComplexF64} <code>c = a + b</code> (internal real-to-complex conversion).</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPS{ComplexF64} <code>a</code></li><li><code>b</code> – Source TPS{Float64} <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPS{ComplexF64} <code>c = a + b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1339-L1350">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_asin!" href="#GTPSA.mad_ctpsa_asin!"><code>GTPSA.mad_ctpsa_asin!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_asin!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>asin</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = asin(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1748-L1758">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_asinc!" href="#GTPSA.mad_ctpsa_asinc!"><code>GTPSA.mad_ctpsa_asinc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_asinc!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>asinc(a) = asin(a)/a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = asinc(a) = asin(a)/a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1811-L1821">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_asinh!" href="#GTPSA.mad_ctpsa_asinh!"><code>GTPSA.mad_ctpsa_asinh!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_asinh!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>asinh</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = asinh(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1827-L1837">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_asinhc!" href="#GTPSA.mad_ctpsa_asinhc!"><code>GTPSA.mad_ctpsa_asinhc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_asinhc!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>asinhc</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = asinhc(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1891-L1901">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_atan!" href="#GTPSA.mad_ctpsa_atan!"><code>GTPSA.mad_ctpsa_atan!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_atan!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>atan</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = atan(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1780-L1790">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_atanh!" href="#GTPSA.mad_ctpsa_atanh!"><code>GTPSA.mad_ctpsa_atanh!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_atanh!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>atanh</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = atanh(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1859-L1869">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_ax2pby2pcz2!" href="#GTPSA.mad_ctpsa_ax2pby2pcz2!"><code>GTPSA.mad_ctpsa_ax2pby2pcz2!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_ax2pby2pcz2!(a::ComplexF64, x::ComplexTPS, b::ComplexF64, y::ComplexTPS, c::ComplexF64, z::ComplexTPS, r::ComplexTPS)</code></pre><p><code>r = a*x^2 + b*y^2 + c*z^2</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Scalar <code>a</code></li><li><code>x</code> – TPSA <code>x</code></li><li><code>b</code> – Scalar <code>b</code></li><li><code>y</code> – TPSA <code>y</code></li><li><code>c</code> – Scalar <code>c</code></li><li><code>z</code> – TPSA <code>z</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2402-L2417">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_ax2pby2pcz2_r!" href="#GTPSA.mad_ctpsa_ax2pby2pcz2_r!"><code>GTPSA.mad_ctpsa_ax2pby2pcz2_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_ax2pby2pcz2_r!(a_re::Cdouble, a_im::Cdouble, x::ComplexTPS, b_re::Cdouble, b_im::Cdouble, y::ComplexTPS, c_re::Cdouble, c_im::Cdouble, z::ComplexTPS, r::ComplexTPS)</code></pre><p><code>r = a*x^2 + b*y^2 + c*z^2</code>. Same as <code>mad_ctpsa_ax2pby2pcz2</code> without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>a_re</code> – Real part of Scalar <code>a</code></li><li><code>a_im</code> – Imag part of Scalar <code>a</code></li><li><code>x</code>    – TPSA <code>x</code></li><li><code>b_re</code> – Real part of Scalar <code>b</code></li><li><code>b_im</code> – Imag part of Scalar <code>b</code></li><li><code>y</code>    – TPSA <code>y</code></li><li><code>c_re</code> – Real part of Scalar <code>c</code></li><li><code>c_im</code> – Imag part of Scalar <code>c</code></li><li><code>z</code>    – TPSA <code>z</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2591-L2609">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_axpb!" href="#GTPSA.mad_ctpsa_axpb!"><code>GTPSA.mad_ctpsa_axpb!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_axpb!(a::ComplexF64, x::ComplexTPS, b::ComplexF64, r::ComplexTPS)</code></pre><p><code>r = a*x + b</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Scalar <code>a</code></li><li><code>x</code> – TPSA <code>x</code></li><li><code>b</code> – Scalar <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2302-L2314">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_axpb_r!" href="#GTPSA.mad_ctpsa_axpb_r!"><code>GTPSA.mad_ctpsa_axpb_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_axpb_r!(a_re::Cdouble, a_im::Cdouble, x::ComplexTPS, b_re::Cdouble, b_im::Cdouble, r::ComplexTPS)</code></pre><p><code>r = a*x + b</code>. Same as <code>mad_ctpsa_axpb</code> without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>a_re</code> – Real part of Scalar <code>a</code></li><li><code>a_im</code> – Imag part of Scalar <code>a</code></li><li><code>x</code>    – TPSA <code>x</code></li><li><code>b_re</code> – Real part of Scalar <code>b</code></li><li><code>b_im</code> – Imag part of Scalar <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2478-L2492">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_axpbypc!" href="#GTPSA.mad_ctpsa_axpbypc!"><code>GTPSA.mad_ctpsa_axpbypc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_axpbypc!(a::ComplexF64, x::ComplexTPS, b::ComplexF64, y::ComplexTPS, c::ComplexF64, r::ComplexTPS)</code></pre><p><code>r = a*x+b*y+c</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Scalar <code>a</code></li><li><code>x</code> – TPSA <code>x</code></li><li><code>b</code> – Scalar <code>b</code></li><li><code>y</code> – TPSA <code>y</code></li><li><code>c</code> – Scalar <code>c</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2320-L2334">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_axpbypc_r!" href="#GTPSA.mad_ctpsa_axpbypc_r!"><code>GTPSA.mad_ctpsa_axpbypc_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_axpbypc_r!(a_re::Cdouble, a_im::Cdouble, x::ComplexTPS, b_re::Cdouble, b_im::Cdouble, y::ComplexTPS, c_re::Cdouble, c_im::Cdouble, r::ComplexTPS)</code></pre><p><code>r = a*x + b*y + c</code>. Same as <code>mad_ctpsa_axpbypc</code> without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>a_re</code> – Real part of Scalar <code>a</code></li><li><code>a_im</code> – Imag part of Scalar <code>a</code></li><li><code>x</code>    – TPSA <code>x</code></li><li><code>b_re</code> – Real part of Scalar <code>b</code></li><li><code>b_im</code> – Imag part of Scalar <code>b</code></li><li><code>y</code>    – TPSA <code>y</code></li><li><code>c_re</code> – Real part of Scalar <code>c</code></li><li><code>c_im</code> – Imag part of Scalar <code>c</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2498-L2515">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_axpsqrtbpcx2!" href="#GTPSA.mad_ctpsa_axpsqrtbpcx2!"><code>GTPSA.mad_ctpsa_axpsqrtbpcx2!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_axpsqrtbpcx2!(x::ComplexTPS, a::ComplexF64, b::ComplexF64, c::ComplexF64, r::ComplexTPS)</code></pre><p><code>r = a*x + sqrt(b + c*x^2)</code></p><p><strong>Input</strong></p><ul><li><code>x</code> – TPSA <code>x</code></li><li><code>a</code> – Scalar <code>a</code></li><li><code>b</code> – Scalar <code>b</code></li><li><code>c</code> – Scalar <code>c</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2423-L2436">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_axpsqrtbpcx2_r!" href="#GTPSA.mad_ctpsa_axpsqrtbpcx2_r!"><code>GTPSA.mad_ctpsa_axpsqrtbpcx2_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_axpsqrtbpcx2_r!(x::ComplexTPS, a_re::Cdouble, a_im::Cdouble, b_re::Cdouble, b_im::Cdouble, c_re::Cdouble, c_im::Cdouble, r::ComplexTPS)</code></pre><p><code>r = a*x + sqrt(b + c*x^2)</code>. Same as <code>mad_ctpsa_axpsqrtbpcx2</code> without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>a_re</code> – Real part of Scalar <code>a</code></li><li><code>a_im</code> – Imag part of Scalar <code>a</code></li><li><code>b_re</code> – Real part of Scalar <code>b</code></li><li><code>b_im</code> – Imag part of Scalar <code>b</code></li><li><code>c_re</code> – Real part of Scalar <code>c</code></li><li><code>c_im</code> – Imag part of Scalar <code>c</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2615-L2630">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_axypb!" href="#GTPSA.mad_ctpsa_axypb!"><code>GTPSA.mad_ctpsa_axypb!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_axypb!(a::ComplexF64, x::ComplexTPS, y::ComplexTPS, b::ComplexF64, r::ComplexTPS)</code></pre><p><code>r = a*x*y + b</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Scalar <code>a</code></li><li><code>x</code> – TPSA <code>x</code></li><li><code>y</code> – TPSA <code>y</code></li><li><code>b</code> – Scalar <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2340-L2353">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_axypb_r!" href="#GTPSA.mad_ctpsa_axypb_r!"><code>GTPSA.mad_ctpsa_axypb_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_axypb_r!(a_re::Cdouble, a_im::Cdouble, x::ComplexTPS, y::ComplexTPS, b_re::Cdouble, b_im::Cdouble, r::ComplexTPS)</code></pre><p><code>r = a*x*y + b</code>. Same as <code>mad_ctpsa_axypb</code> without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>a_re</code> – Real part of Scalar <code>a</code></li><li><code>a_im</code> – Imag part of Scalar <code>a</code></li><li><code>x</code>    – TPSA <code>x</code></li><li><code>y</code>    – TPSA <code>y</code></li><li><code>b_re</code> – Real part of Scalar <code>b</code></li><li><code>b_im</code> – Imag part of Scalar <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2521-L2536">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_axypbvwpc!" href="#GTPSA.mad_ctpsa_axypbvwpc!"><code>GTPSA.mad_ctpsa_axypbvwpc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_axypbvwpc!(a::ComplexF64, x::ComplexTPS, y::ComplexTPS, b::ComplexF64, v::ComplexTPS, w::ComplexTPS, c::ComplexF64, r::ComplexTPS)</code></pre><p><code>r = a*x*y + b*v*w + c</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Scalar <code>a</code></li><li><code>x</code> – TPSA <code>x</code></li><li><code>y</code> – TPSA <code>y</code></li><li><code>b</code> – Scalar <code>b</code></li><li><code>v</code> – TPSA v</li><li><code>w</code> – TPSA w</li><li><code>c</code> – Scalar <code>c</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2380-L2396">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_axypbvwpc_r!" href="#GTPSA.mad_ctpsa_axypbvwpc_r!"><code>GTPSA.mad_ctpsa_axypbvwpc_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_axypbvwpc_r!(a_re::Cdouble, a_im::Cdouble, x::ComplexTPS, y::ComplexTPS, b_re::Cdouble, b_im::Cdouble, v::ComplexTPS, w::ComplexTPS, c_re::Cdouble, c_im::Cdouble, r::ComplexTPS)</code></pre><p><code>r = a*x*y + b*v*w + c</code>. Same as <code>mad_ctpsa_axypbvwpc</code> without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>a_re</code> – Real part of Scalar <code>a</code></li><li><code>a_im</code> – Imag part of Scalar <code>a</code></li><li><code>x</code>    – TPSA <code>x</code></li><li><code>y</code>    – TPSA <code>y</code></li><li><code>b_re</code> – Real part of Scalar <code>b</code></li><li><code>b_im</code> – Imag part of Scalar <code>b</code></li><li><code>v</code>    – TPSA v</li><li><code>w</code>    – TPSA w</li><li><code>c_re</code> – Real part of Scalar <code>c</code></li><li><code>c_im</code> – Imag part of Scalar <code>c</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2566-L2585">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_axypbzpc!" href="#GTPSA.mad_ctpsa_axypbzpc!"><code>GTPSA.mad_ctpsa_axypbzpc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_axypbzpc!(a::ComplexF64, x::ComplexTPS, y::ComplexTPS, b::ComplexF64, z::ComplexTPS, c::ComplexF64, r::ComplexTPS)</code></pre><p><code>r = a*x*y + b*z + c</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Scalar <code>a</code></li><li><code>x</code> – TPSA <code>x</code></li><li><code>y</code> – TPSA <code>y</code></li><li><code>b</code> – Scalar <code>b</code></li><li><code>z</code> – TPSA <code>z</code></li><li><code>c</code> – Scalar <code>c</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2359-L2374">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_axypbzpc_r!" href="#GTPSA.mad_ctpsa_axypbzpc_r!"><code>GTPSA.mad_ctpsa_axypbzpc_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_axypbzpc_r!(a_re::Cdouble, a_im::Cdouble, x::ComplexTPS, y::ComplexTPS, b_re::Cdouble, b_im::Cdouble, z::ComplexTPS, c_re::Cdouble, c_im::Cdouble, r::ComplexTPS)</code></pre><p><code>r = a*x*y + b*z + c</code>. Same as <code>mad_ctpsa_axypbzpc</code> without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>a_re</code> – Real part of Scalar <code>a</code></li><li><code>a_im</code> – Imag part of Scalar <code>a</code></li><li><code>x</code>    – TPSA <code>x</code></li><li><code>y</code>    – TPSA <code>y</code></li><li><code>b_re</code> – Real part of Scalar <code>b</code></li><li><code>b_im</code> – Imag part of Scalar <code>b</code></li><li><code>z</code>    – TPSA <code>z</code></li><li><code>c_re</code> – Real part of Scalar <code>c</code></li><li><code>c_im</code> – Imag part of Scalar <code>c</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2542-L2560">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_cabs!" href="#GTPSA.mad_ctpsa_cabs!"><code>GTPSA.mad_ctpsa_cabs!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_cabs!(t::ComplexTPS, r::RealTPS)</code></pre><p>Sets the TPS{Float64} <code>r</code> equal to the aboslute value of TPS{ComplexF64} <code>t</code>. Specifically, the  result contains a TPSA with the <code>abs</code> of all coefficients.</p><p><strong>Input</strong></p><ul><li><code>t</code> – Source TPS{ComplexF64}</li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPS{Float64} with <code>r = |t|</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L498-L510">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_carg!" href="#GTPSA.mad_ctpsa_carg!"><code>GTPSA.mad_ctpsa_carg!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_carg!(t::ComplexTPS, r::RealTPS)</code></pre><p>Sets the TPS{Float64} <code>r</code> equal to the argument (phase) of TPS{ComplexF64} <code>t</code></p><p><strong>Input</strong></p><ul><li><code>t</code> – Source TPS{ComplexF64}</li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPS{Float64} with <code>r = carg(t)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L515-L526">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_clear!" href="#GTPSA.mad_ctpsa_clear!"><code>GTPSA.mad_ctpsa_clear!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_clear!(t::ComplexTPS)</code></pre><p>Clears the TPSA (reset to 0)</p><p><strong>Input</strong></p><ul><li><code>t</code> – Complex TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L407-L414">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_clrord!" href="#GTPSA.mad_ctpsa_clrord!"><code>GTPSA.mad_ctpsa_clrord!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_clrord!(t::ComplexTPS, ord::Cuchar)</code></pre><p>Clears all monomial coefficients of the TPSA at order <code>ord</code></p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>ord</code> – Order to clear monomial coefficients</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L249-L257">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_compose!" href="#GTPSA.mad_ctpsa_compose!"><code>GTPSA.mad_ctpsa_compose!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_compose!(na::Cint, ma, nb::Cint, mb, mc)</code></pre><p>Composes two maps.</p><p><strong>Input</strong></p><ul><li><code>na</code> – Number of TPSAs in Map <code>ma</code></li><li><code>ma</code> – Map <code>ma</code></li><li><code>nb</code> – Number of TPSAs in Map <code>mb</code></li><li><code>mb</code> – Map <code>mb</code></li></ul><p><strong>Output</strong></p><ul><li><code>mc</code> – Composition of maps <code>ma</code> and <code>mb</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2885-L2898">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_conj!" href="#GTPSA.mad_ctpsa_conj!"><code>GTPSA.mad_ctpsa_conj!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_conj(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Calculates the complex conjugate of of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = conj(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1490-L1500">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_convert!" href="#GTPSA.mad_ctpsa_convert!"><code>GTPSA.mad_ctpsa_convert!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_convert!(t::ComplexTPS, r::ComplexTPS, n::Cint, t2r_, pb::Cint)</code></pre><p>General function to convert TPSAs to different orders and reshuffle canonical coordinates. The destination TPSA will  be of order <code>n</code>, and optionally have the variable reshuffling defined by <code>t2r_</code> and poisson bracket sign. e.g. if  <code>t2r_ = {1,2,3,4,6,5}</code> and <code>pb = -1</code>, canonical coordinates 6 and 5 are swapped and the new 5th canonical coordinate  will be negated. Useful for comparing with different differential algebra packages.</p><p><strong>Input</strong></p><ul><li><code>t</code>    – Source complex TPSA</li><li><code>n</code>    – Length of vector</li><li><code>t2r_</code> – (Optional) Vector of index lookup</li><li><code>pb</code>   – Poisson bracket, 0, 1:fwd, -1:bwd</li></ul><p><strong>Output</strong></p><ul><li><code>r</code>    – Destination complex TPSA with specified order and canonical coordinate reshuffling.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L282-L298">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_copy!" href="#GTPSA.mad_ctpsa_copy!"><code>GTPSA.mad_ctpsa_copy!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_copy!(t::ComplexTPS, r::ComplexTPS)</code></pre><p>Makes a copy of the complex TPSA <code>t</code> to <code>r</code>.</p><p><strong>Input</strong></p><ul><li><code>t</code> – Source complex TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination complex TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L180-L190">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_cos!" href="#GTPSA.mad_ctpsa_cos!"><code>GTPSA.mad_ctpsa_cos!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_cos!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>cos</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = cos(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1587-L1597">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_cosh!" href="#GTPSA.mad_ctpsa_cosh!"><code>GTPSA.mad_ctpsa_cosh!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_cosh!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>cosh</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = cosh(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1684-L1694">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_cot!" href="#GTPSA.mad_ctpsa_cot!"><code>GTPSA.mad_ctpsa_cot!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_cot!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>cot</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = cot(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1619-L1629">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_coth!" href="#GTPSA.mad_ctpsa_coth!"><code>GTPSA.mad_ctpsa_coth!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_coth!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>coth</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = coth(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1716-L1726">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_cplx!" href="#GTPSA.mad_ctpsa_cplx!"><code>GTPSA.mad_ctpsa_cplx!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_cplx!(re_, im_, r::ComplexTPS)</code></pre><p>Creates a TPS{ComplexF64} with real and imaginary parts from the TPS{Float64}s <code>re_</code> and <code>im_</code> respectively.</p><p><strong>Input</strong></p><ul><li><code>re_</code> – Real part of TPS{ComplexF64} to make</li><li><code>im_</code> – Imaginary part of TPS{ComplexF64} to make</li></ul><p><strong>Output</strong></p><ul><li><code>r</code>   – Destination TPS{ComplexF64} with <code>r = re_ + im*im_</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L438-L450">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_cpyi!" href="#GTPSA.mad_ctpsa_cpyi!"><code>GTPSA.mad_ctpsa_cpyi!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_cpyi!(t::ComplexTPS, r::ComplexTPS, i::Cint)</code></pre><p>Copies the monomial coefficient at index <code>i</code> in <code>t</code> into the  same monomial coefficient in <code>r</code></p><p><strong>Input</strong></p><ul><li><code>t</code> – Source TPSA</li><li><code>r</code> – Destination TPSA </li><li><code>i</code> – Index of monomial</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L816-L826">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_cpym!" href="#GTPSA.mad_ctpsa_cpym!"><code>GTPSA.mad_ctpsa_cpym!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_cpym!(t::ComplexTPS, r::ComplexTPS, n::Cint, m)</code></pre><p>Copies the monomial coefficient at the monomial-as-vector-of-orders <code>m</code> in <code>t</code> into the same monomial coefficient in <code>r</code></p><p><strong>Input</strong></p><ul><li><code>t</code> – Source TPSA</li><li><code>r</code> – Destination TPSA </li><li><code>n</code> – Length of monomial <code>m</code></li><li><code>m</code> – Monomial as vector of orders</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L847-L858">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_cpys!" href="#GTPSA.mad_ctpsa_cpys!"><code>GTPSA.mad_ctpsa_cpys!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_cpys!(t::ComplexTPS, r::ComplexTPS, n::Cint, s::Cstring)</code></pre><p>Copies the monomial coefficient at the monomial-as-string-of-order <code>s</code> in <code>t</code> into the same monomial coefficient in <code>r</code></p><p><strong>Input</strong></p><ul><li><code>t</code> – Source TPSA</li><li><code>r</code> – Destination TPSA </li><li><code>n</code> – Length of string</li><li><code>s</code> – Monomial as string</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L831-L842">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_cpysm!" href="#GTPSA.mad_ctpsa_cpysm!"><code>GTPSA.mad_ctpsa_cpysm!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_cpysm!(t::ComplexTPS, r::ComplexTPS, n::Cint, m)</code></pre><p>Copies the monomial coefficient at the monomial-as-sparse-monomial <code>m</code> in <code>t</code> into the same monomial coefficient in <code>r</code></p><p><strong>Input</strong></p><ul><li><code>t</code> – Source TPSA</li><li><code>r</code> – Destination TPSA </li><li><code>n</code> – Length of sparse monomial <code>m</code></li><li><code>m</code> – Monomial as sparse-monomial</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L864-L875">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_cutord!" href="#GTPSA.mad_ctpsa_cutord!"><code>GTPSA.mad_ctpsa_cutord!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_cutord!(t::ComplexTPS, r::ComplexTPS, ord::Cint)</code></pre><p>Cuts the TPSA off at the given order and above, or if <code>ord</code> is negative, will cut orders below  <code>abs(ord)</code> (e.g. if <code>ord</code> = -3, then orders 0-3 are cut off).</p><p><strong>Input</strong></p><ul><li><code>t</code>   – Source complex TPSA</li><li><code>ord</code> – Cut order: <code>0..-ord</code> or <code>ord..mo</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code>   – Destination complex TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L232-L244">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_cycle!" href="#GTPSA.mad_ctpsa_cycle!"><code>GTPSA.mad_ctpsa_cycle!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_cycle!(t::ComplexTPS, i::Cint, n::Cint, m_, v_)::Cint</code></pre><p>Used for scanning through each nonzero monomial in the TPSA. Given a starting index (-1 if starting at 0), will  optionally fill monomial <code>m_</code> with the monomial at index <code>i</code> and the value at <code>v_</code> with the monomials coefficient, and  return the next NONZERO monomial index in the TPSA. This is useful for building an iterator through the TPSA.</p><p><strong>Input</strong></p><ul><li><code>t</code>  – TPSA to scan</li><li><code>i</code>  – Index to start from (-1 to start at 0)</li><li><code>n</code>  – Size of monomial</li><li><code>m_</code> – (Optional) Monomial to be filled if provided</li><li><code>v_</code> – (Optional) Pointer to value of coefficient</li></ul><p><strong>Output</strong></p><ul><li><code>i</code>  – Index of next nonzero monomial in the TPSA, or -1 if reached the end</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L663-L679">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_debug" href="#GTPSA.mad_ctpsa_debug"><code>GTPSA.mad_ctpsa_debug</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_debug(t::ComplexTPS, name_::Cstring, fnam_::Cstring, line_::Cint, stream_::Ptr{Cvoid})::Cint</code></pre><p>Prints TPSA with all information of data structure.</p><p><strong>Input</strong></p><ul><li><code>t</code>       – TPSA</li><li><code>name_</code>   – (Optional) Name of TPSA</li><li><code>fnam_</code>   – (Optional) File name to print to</li><li><code>line_</code>   – (Optional) Line number in file to start at</li><li><code>stream_</code> – (Optional) I/O stream to print to, default is <code>stdout</code></li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – <code>Cint</code> reflecting internal state of TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L3055-L3069">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_del!" href="#GTPSA.mad_ctpsa_del!"><code>GTPSA.mad_ctpsa_del!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_del!(t::Ref{TPS{ComplexF64}})</code></pre><p>Calls the destructor for the complex TPSA.</p><p><strong>Input</strong></p><ul><li><code>t</code> – Complex TPSA to destruct</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L43-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_density" href="#GTPSA.mad_ctpsa_density"><code>GTPSA.mad_ctpsa_density</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_density(t::ComplexTPS, stat_, reset::Bool)::Cdouble</code></pre><p>Computes the ratio of <code>nz</code>/<code>nc</code> in <code>[0] U [lo,hi]</code> or <code>stat_</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L3108-L3112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_deriv!" href="#GTPSA.mad_ctpsa_deriv!"><code>GTPSA.mad_ctpsa_deriv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_deriv!(a::ComplexTPS, c::ComplexTPS, iv::Cint)</code></pre><p>Differentiates TPSA with respect to the variable with index <code>iv</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code>  – Source TPSA to differentiate</li><li><code>iv</code> – Index of variable to take derivative wrt to (e.g. derivative wrt <code>x</code>, <code>iv = 1</code>). </li></ul><p><strong>Output</strong></p><ul><li><code>c</code>  – Destination TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2102-L2113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_derivm!" href="#GTPSA.mad_ctpsa_derivm!"><code>GTPSA.mad_ctpsa_derivm!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_derivm!(a::ComplexTPS, c::ComplexTPS, n::Cint, m)</code></pre><p>Differentiates TPSA with respect to the monomial defined by byte array <code>m</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA to differentiate</li><li><code>n</code> – Length of monomial to differentiate wrt</li><li><code>m</code> – Monomial to take derivative wrt</li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2119-L2131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_desc" href="#GTPSA.mad_ctpsa_desc"><code>GTPSA.mad_ctpsa_desc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_desc(t::ComplexTPS)::Ptr{Desc}</code></pre><p>Gets the descriptor for the complex TPSA.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – Complex TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Descriptor for the TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L56-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_dif!" href="#GTPSA.mad_ctpsa_dif!"><code>GTPSA.mad_ctpsa_dif!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_dif!(a::ComplexTPS, b::ComplexTPS, c::ComplexTPS)</code></pre><p>For each homogeneous polynomial in TPSAs <code>a</code> and <code>b</code>, calculates either the relative error or absolute error for each order. If the maximum coefficient for a given order in <code>a</code> is &gt; 1, the relative error is computed for that order. Else, the absolute  error is computed. This is very useful for comparing maps between codes or doing unit tests. In Julia, essentially:</p><p><code>c_i = (a_i.-b_i)/maximum([abs.(a_i)...,1])</code> where <code>a_i</code> and <code>b_i</code> are vectors of the monomials for an order <code>i</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>b</code> – Source TPSA <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1120-L1135">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_dift!" href="#GTPSA.mad_ctpsa_dift!"><code>GTPSA.mad_ctpsa_dift!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_dift!(a::ComplexTPS, b::RealTPS, c::ComplexTPS)</code></pre><p>For each homogeneous polynomial in TPS{ComplexF64} <code>a</code> and TPS{Float64} <code>b</code>, calculates either the relative error or absolute error for each order. If the maximum coefficient for a given order in <code>a</code> is &gt; 1, the relative error is computed for that order. Else, the absolute  error is computed. This is very useful for comparing maps between codes or doing unit tests. In Julia, essentially:</p><p><code>c_i = (a_i.-b_i)/maximum([abs.(a_i)...,1])</code> where <code>a_i</code> and <code>b_i</code> are vectors of the monomials for an order <code>i</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPS{ComplexF64} <code>a</code></li><li><code>b</code> – Source TPS{Float64} <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPS{ComplexF64} <code>c</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1298-L1313">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_div!" href="#GTPSA.mad_ctpsa_div!"><code>GTPSA.mad_ctpsa_div!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_div!(a::ComplexTPS, b::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets the destination TPSA <code>c = a / b</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>b</code> – Source TPSA <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = a / b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1192-L1203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_divt!" href="#GTPSA.mad_ctpsa_divt!"><code>GTPSA.mad_ctpsa_divt!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_divt!(a::ComplexTPS, b::RealTPS, c::ComplexTPS)</code></pre><p>Sets the destination TPS{ComplexF64} <code>c = a / b</code> (internal real-to-complex conversion).</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPS{ComplexF64} <code>a</code></li><li><code>b</code> – Source TPS{Float64} <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPS{ComplexF64} <code>c = a / b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1407-L1418">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_equ" href="#GTPSA.mad_ctpsa_equ"><code>GTPSA.mad_ctpsa_equ</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_equ(a::ComplexTPS, b::ComplexTPS, tol_::Cdouble)::Bool</code></pre><p>Checks if the TPSAs <code>a</code> and <code>b</code> are equal within the specified tolerance <code>tol_</code>. If <code>tol_</code> is not specified, <code>DBL_GTPSA.show_epsILON</code> is used.</p><p><strong>Input</strong></p><ul><li><code>a</code>    – TPSA <code>a</code></li><li><code>b</code>    – TPSA <code>b</code></li><li><code>tol_</code> – (Optional) Difference below which the TPSAs are considered equal</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>   - True if <code>a == b</code> within <code>tol_</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1101-L1113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_equt" href="#GTPSA.mad_ctpsa_equt"><code>GTPSA.mad_ctpsa_equt</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_equt(a::ComplexTPS, b::RealTPS, tol::Cdouble)::Bool</code></pre><p>Checks if the TPS{ComplexF64} <code>a</code> is equal to the TPS{Float64} <code>b</code> within the specified tolerance <code>tol_</code>  (internal real-to-complex conversion).</p><p><strong>Input</strong></p><ul><li><code>a</code>    – TPS{ComplexF64} <code>a</code></li><li><code>b</code>    – TPS{Float64} <code>b</code></li><li><code>tol_</code> – (Optional) Difference below which the TPSAs are considered equal</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>   - True if <code>a == b</code> within <code>tol_</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1278-L1291">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_erf!" href="#GTPSA.mad_ctpsa_erf!"><code>GTPSA.mad_ctpsa_erf!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_erf!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>erf</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = erf(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1907-L1917">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_erfc!" href="#GTPSA.mad_ctpsa_erfc!"><code>GTPSA.mad_ctpsa_erfc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_erfc!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>erfc</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = erfc(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1923-L1933">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_eval!" href="#GTPSA.mad_ctpsa_eval!"><code>GTPSA.mad_ctpsa_eval!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_eval!(na::Cint, ma, nb::Cint, tb, tc)</code></pre><p>Evaluates the map at the point <code>tb</code></p><p><strong>Input</strong></p><ul><li><code>na</code> – Number of TPSAs in the map</li><li><code>ma</code> – Map <code>ma</code></li><li><code>nb</code> – Length of <code>tb</code></li><li><code>tb</code> – Point at which to evaluate the map</li></ul><p><strong>Output</strong></p><ul><li><code>tc</code> – Values for each TPSA in the map evaluated at the point <code>tb</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2933-L2946">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_exp!" href="#GTPSA.mad_ctpsa_exp!"><code>GTPSA.mad_ctpsa_exp!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_exp!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>exp</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = exp(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1521-L1531">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_exppb!" href="#GTPSA.mad_ctpsa_exppb!"><code>GTPSA.mad_ctpsa_exppb!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_exppb!(na::Cint, ma, mb, mc)</code></pre><p>Computes the exponential of fgrad of the vector fields <code>ma</code> and <code>mb</code>, literally <code>exppb(ma, mb) = mb + fgrad(ma, mb) + fgrad(ma, fgrad(ma, mb))/2! + ...</code></p><p><strong>Input</strong></p><ul><li><code>na</code> – Length of <code>ma</code> and <code>mb</code></li><li><code>ma</code> – Vector of TPSA <code>ma</code></li><li><code>mb</code> – Vector of TPSA <code>mb</code></li></ul><p><strong>Output</strong></p><ul><li><code>mc</code> – Destination vector of TPSA <code>mc</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2746-L2759">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_fgrad!" href="#GTPSA.mad_ctpsa_fgrad!"><code>GTPSA.mad_ctpsa_fgrad!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_fgrad!(na::Cint, ma, b::ComplexTPS, c::ComplexTPS)</code></pre><p>Calculates <code>dot(ma, grad(b))</code></p><p><strong>Input</strong></p><ul><li><code>na</code> – Length of <code>ma</code> consistent with number of variables in <code>b</code></li><li><code>ma</code> – Vector of TPSA</li><li><code>b</code>  – TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>c</code>  – <code>dot(ma, grad(b))</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2701-L2713">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_fld2vec!" href="#GTPSA.mad_ctpsa_fld2vec!"><code>GTPSA.mad_ctpsa_fld2vec!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_fld2vec!(na::Cint, ma, c::ComplexTPS)</code></pre><p>Assuming the variables in the TPSA are canonically-conjugate, and ordered so that the canonically- conjugate variables are consecutive (q1, p1, q2, p2, ...), calculates the Hamiltonian one obtains  from ther vector field (in the form <code>[da/dp1, -da/dq1, ...]</code>)</p><p><strong>Input</strong></p><ul><li><code>na</code>  – Number of TPSA in <code>ma</code> consistent with number of variables in <code>c</code></li><li><code>ma</code>  – Vector field </li></ul><p><strong>Output</strong></p><ul><li><code>c</code>   – Hamiltonian as a TPSA derived from the vector field <code>ma</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2679-L2692">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_geti" href="#GTPSA.mad_ctpsa_geti"><code>GTPSA.mad_ctpsa_geti</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_geti(t::ComplexTPS, i::Cint)::ComplexF64</code></pre><p>Gets the coefficient of the monomial at index <code>i</code>.  Generally should use <code>mad_tpsa_cycle</code> instead of this.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>i</code>   – Monomial index</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Coefficient of monomial at index <code>i</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L688-L699">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_geti_r!" href="#GTPSA.mad_ctpsa_geti_r!"><code>GTPSA.mad_ctpsa_geti_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_geti_r!(t::ComplexTPS, i::Cint,  r)</code></pre><p>Gets the coefficient of the monomial at index <code>i</code> in place. Generally should use <code>mad_tpsa_cycle</code> instead of this.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>i</code> – Monomial index</li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Coefficient of monomial at index <code>i</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L902-L913">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_getm" href="#GTPSA.mad_ctpsa_getm"><code>GTPSA.mad_ctpsa_getm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_getm(t::ComplexTPS, n::Cint, m)::ComplexF64</code></pre><p>Gets the coefficient of the monomial <code>m</code> defined as a byte array. Generally should use <code>mad_tpsa_cycle</code> instead of this.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>n</code>   – Length of monomial</li><li><code>m</code>   – Monomial as byte array</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Coefficient of monomial <code>m</code> in TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L725-L737">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_getm_r!" href="#GTPSA.mad_ctpsa_getm_r!"><code>GTPSA.mad_ctpsa_getm_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_getm_r!(t::ComplexTPS, n::Cint, m, r)</code></pre><p>Gets the coefficient of the monomial <code>m</code> defined as a byte array in place. Generally should use <code>mad_tpsa_cycle</code> instead of this.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>n</code> – Length of monomial</li><li><code>m</code> – Monomial as byte array</li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Coefficient of monomial <code>m</code> in TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L941-L953">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_getord!" href="#GTPSA.mad_ctpsa_getord!"><code>GTPSA.mad_ctpsa_getord!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_getord!(t::ComplexTPS, r::ComplexTPS, ord::Cuchar)</code></pre><p>Extract one homogeneous polynomial of the given order</p><p><strong>Input</strong></p><ul><li><code>t</code>  – Sourcecomplex TPSA</li><li><code>ord</code> – Order to retrieve</li></ul><p><strong>Output</strong></p><ul><li><code>r</code>   – Destination complex TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L215-L226">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_gets" href="#GTPSA.mad_ctpsa_gets"><code>GTPSA.mad_ctpsa_gets</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_gets(t::ComplexTPS, n::Cint, s::Cstring)::ComplexF64</code></pre><p>Gets the coefficient of the monomial <code>s</code> defined as a string. Generally should use <code>mad_tpsa_cycle</code> instead of this.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>n</code>   – Size of monomial</li><li><code>s</code>   – Monomial as string</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Coefficient of monomial <code>s</code> in TPSA </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L706-L718">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_gets_r!" href="#GTPSA.mad_ctpsa_gets_r!"><code>GTPSA.mad_ctpsa_gets_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_gets_r!(t::ComplexTPS, n::Cint, s::Cstring, r)</code></pre><p>Gets the coefficient of the monomial <code>s</code> defined as a string in place. Generally should use <code>mad_tpsa_cycle</code> instead of this.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>n</code> – Length of monomial</li><li><code>s</code> – Monomial as string</li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Coefficient of monomial <code>s</code> in TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L921-L933">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_getsm" href="#GTPSA.mad_ctpsa_getsm"><code>GTPSA.mad_ctpsa_getsm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_getsm(t::ComplexTPS, n::Cint, m)::ComplexF64</code></pre><p>Gets the coefficient of the monomial <code>m</code> defined as a sparse monomial. Generally should use <code>mad_tpsa_cycle</code> instead of this.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>n</code>   – Length of monomial</li><li><code>m</code>   – Monomial as sparse monomial</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Coefficient of monomial <code>m</code> in TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L745-L757">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_getsm_r!" href="#GTPSA.mad_ctpsa_getsm_r!"><code>GTPSA.mad_ctpsa_getsm_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_getsm_r!(t::ComplexTPS, n::Cint, m, r)</code></pre><p>Gets the coefficient of the monomial <code>m</code> defined as a sparse monomial in place. Generally should use <code>mad_tpsa_cycle</code> instead of this.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>n</code> – Length of monomial</li><li><code>m</code> – Monomial as sparse monomial</li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Coefficient of monomial <code>m</code> in TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L962-L974">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_getv!" href="#GTPSA.mad_ctpsa_getv!"><code>GTPSA.mad_ctpsa_getv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_getv!(t::ComplexTPS, i::Cint, n::Cint, v)</code></pre><p>Vectorized getter of the coefficients for monomials with indices <code>i..i+n</code>. Useful for extracting the 1st order parts of  a TPSA to construct a matrix (<code>i = 1</code>, <code>n = nv+np = nn</code>). </p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>i</code> – Starting index of monomials to get coefficients</li><li><code>n</code> – Number of monomials to get coefficients of starting at <code>i</code></li></ul><p><strong>Output</strong></p><ul><li><code>v</code> – Array of coefficients for monomials <code>i..i+n</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1064-L1077">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_hypot!" href="#GTPSA.mad_ctpsa_hypot!"><code>GTPSA.mad_ctpsa_hypot!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_hypot!(x::ComplexTPS, y::ComplexTPS, r::ComplexTPS)</code></pre><p>Sets TPSA <code>r</code> to <code>sqrt(real(x)^2+real(y)^2) + im*sqrt(imag(x)^2+imag(y)^2)</code></p><p><strong>Input</strong></p><ul><li><code>x</code> – Source TPSA <code>x</code></li><li><code>y</code> – Source TPSA <code>y</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>sqrt(real(x)^2+real(y)^2) + im*sqrt(imag(x)^2+imag(y)^2)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2051-L2062">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_hypot3!" href="#GTPSA.mad_ctpsa_hypot3!"><code>GTPSA.mad_ctpsa_hypot3!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_hypot3!(x::ComplexTPS, y::ComplexTPS, z::ComplexTPS, r::ComplexTPS)</code></pre><p>Sets TPSA <code>r</code> to <code>sqrt(x^2+y^2+z^2)</code>.  Does NOT allow for r = x, y, z !!!</p><p><strong>Input</strong></p><ul><li><code>x</code> – Source TPSA <code>x</code></li><li><code>y</code> – Source TPSA <code>y</code></li><li><code>z</code> – Source TPSA <code>z</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r = sqrt(x^2+y^2+z^2)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2067-L2079">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_idxm" href="#GTPSA.mad_ctpsa_idxm"><code>GTPSA.mad_ctpsa_idxm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_idxm(t::ComplexTPS, n::Cint, m)::Cint</code></pre><p>Returns index of monomial in the TPSA given the monomial as a byte array. This generally should not be used, as there  are no assumptions about which monomial is attached to which index.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>n</code>   – Length of monomial</li><li><code>s</code>   – Monomial as byte array</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Index of monomial in TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L620-L634">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_idxs" href="#GTPSA.mad_ctpsa_idxs"><code>GTPSA.mad_ctpsa_idxs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_idxs(t::ComplexTPS, n::Cint, s::Cstring)::Cint</code></pre><p>Returns index of monomial in the TPSA given the monomial as string. This generally should not be used, as there  are no assumptions about which monomial is attached to which index.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>n</code>   – Length of monomial</li><li><code>s</code>   – Monomial as string</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Index of monomial in TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L599-L612">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_idxsm" href="#GTPSA.mad_ctpsa_idxsm"><code>GTPSA.mad_ctpsa_idxsm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_idxsm(t::ComplexTPS, n::Cint, m)::Cint</code></pre><p>Returns index of monomial in the TPSA given the monomial as a sparse monomial. This generally should not be used, as there  are no assumptions about which monomial is attached to which index.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>n</code>   – Length of monomial</li><li><code>s</code>   – Monomial as sparse monomial</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Index of monomial in TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L642-L655">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_imag!" href="#GTPSA.mad_ctpsa_imag!"><code>GTPSA.mad_ctpsa_imag!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_imag!(t::ComplexTPS, r::RealTPS)</code></pre><p>Sets the TPS{Float64} <code>r</code> equal to the imaginary part of TPS{ComplexF64} <code>t</code>.</p><p><strong>Input</strong></p><ul><li><code>t</code> – Source TPS{ComplexF64}</li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPS{Float64} with <code>r = Im(t)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L483-L494">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_init!" href="#GTPSA.mad_ctpsa_init!"><code>GTPSA.mad_ctpsa_init!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_init(t::ComplexTPS, d::Ptr{Desc}, mo::Cuchar)::ComplexTPS</code></pre><p>Unsafe initialization of an already existing TPSA <code>t</code> with maximum order <code>mo</code> to the descriptor <code>d</code>. <code>mo</code> must be less than  the maximum order of the descriptor. <code>t</code> is modified in place and also returned.</p><p><strong>Input</strong></p><ul><li><code>t</code>  – TPSA to initialize to descriptor <code>d</code></li><li><code>d</code>  – Descriptor</li><li><code>mo</code> – Maximum order of the TPSA (must be less than maximum order of the descriptor)</li></ul><p><strong>Output</strong></p><ul><li><code>t</code>  – TPSA initialized to descriptor <code>d</code> with maximum order <code>mo</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L3119-L3132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_integ!" href="#GTPSA.mad_ctpsa_integ!"><code>GTPSA.mad_ctpsa_integ!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_integ!(a::ComplexTPS, c::ComplexTPS, iv::Cint)</code></pre><p>Integrates TPSA with respect to the variable with index <code>iv</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code>  – Source TPSA to integrate</li><li><code>iv</code> – Index of variable to integrate over (e.g. integrate over <code>x</code>, <code>iv = 1</code>). </li></ul><p><strong>Output</strong></p><ul><li><code>c</code>  – Destination TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2085-L2096">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_inv!" href="#GTPSA.mad_ctpsa_inv!"><code>GTPSA.mad_ctpsa_inv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_inv!(a::ComplexTPS,  v::ComplexF64, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to <code>v/a</code>. </p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>v</code> – Scalar with double precision</li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = v/a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2017-L2028">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_inv_r!" href="#GTPSA.mad_ctpsa_inv_r!"><code>GTPSA.mad_ctpsa_inv_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_inv_r!(a::ComplexTPS, v_re::Cdouble, v_im::Cdouble, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to <code>v/a</code>.  Without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>a</code>    – Source TPSA <code>a</code></li><li><code>v_re</code> – Real part of scalar with double precision</li><li><code>v_im</code> – Imaginary part of scalar with double precision</li></ul><p><strong>Output</strong></p><ul><li><code>c</code>    – Destination TPSA <code>c = v*a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2267-L2279">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_invsqrt!" href="#GTPSA.mad_ctpsa_invsqrt!"><code>GTPSA.mad_ctpsa_invsqrt!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_invsqrt!(a::ComplexTPS, v::ComplexF64, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to <code>v/sqrt(a)</code>. </p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>v</code> – Scalar with double precision</li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = v/sqrt(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2034-L2045">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_invsqrt_r!" href="#GTPSA.mad_ctpsa_invsqrt_r!"><code>GTPSA.mad_ctpsa_invsqrt_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_invsqrt_r!(a::ComplexTPS, v_re::Cdouble, v_im::Cdouble, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to <code>v/sqrt(a)</code>. Without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>a</code>    – Source TPSA <code>a</code></li><li><code>v_re</code> – Real part of scalar with double precision</li><li><code>v_im</code> – Imaginary part of scalar with double precision</li></ul><p><strong>Output</strong></p><ul><li><code>c</code>    – Destination TPSA <code>c = v*a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2284-L2296">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_isnul" href="#GTPSA.mad_ctpsa_isnul"><code>GTPSA.mad_ctpsa_isnul</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_isnul(t::ComplexTPS)::Bool</code></pre><p>Checks if TPSA is 0 or not</p><p><strong>Input</strong></p><ul><li><code>t</code>    – Complex TPSA to check</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>  – True or false</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L420-L430">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_isval" href="#GTPSA.mad_ctpsa_isval"><code>GTPSA.mad_ctpsa_isval</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_isval(t::ComplexTPS)::Bool</code></pre><p>Sanity check of the TPSA integrity.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA to check if valid</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>  – True if valid TPSA, false otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L3075-L3085">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_isvalid" href="#GTPSA.mad_ctpsa_isvalid"><code>GTPSA.mad_ctpsa_isvalid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_isvalid(t::ComplexTPS)::Bool</code></pre><p>Sanity check of the TPSA integrity.</p><p><strong>Input</strong></p><ul><li><code>t</code> – Complex TPSA to check if valid</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>  – True if valid TPSA, false otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L3091-L3101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_len" href="#GTPSA.mad_ctpsa_len"><code>GTPSA.mad_ctpsa_len</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_len(t::ComplexTPS, hi_::Bool)::Cint</code></pre><p>Gets the length of the TPSA itself (e.g. the descriptor may be order 10 but TPSA may only be order 2)</p><p><strong>Input</strong></p><ul><li><code>t</code>   – Complex TPSA</li><li><code>hi_</code> – If <code>true</code>, returns the length up to the <code>hi</code> order in the TPSA, else up to <code>mo</code>. Default is false</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Length of TPS{ComplexF64}</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L91-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_liebra!" href="#GTPSA.mad_ctpsa_liebra!"><code>GTPSA.mad_ctpsa_liebra!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_liebra!(na::Cint, ma, mb, mc)</code></pre><p>Computes the Lie bracket of the vector fields <code>ma</code> and <code>mb</code>, defined as  sum<em>i ma</em>i (dmb/dx<em>i) - mb</em>i (dma/dx_i).</p><p><strong>Input</strong></p><ul><li><code>na</code> – Length of <code>ma</code> and <code>mb</code></li><li><code>ma</code> – Vector of TPSA <code>ma</code></li><li><code>mb</code> – Vector of TPSA <code>mb</code></li></ul><p><strong>Output</strong></p><ul><li><code>mc</code> – Destination vector of TPSA <code>mc</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2722-L2735">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_log!" href="#GTPSA.mad_ctpsa_log!"><code>GTPSA.mad_ctpsa_log!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_log!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>log</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = log(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1538-L1548">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_logaxpsqrtbpcx2!" href="#GTPSA.mad_ctpsa_logaxpsqrtbpcx2!"><code>GTPSA.mad_ctpsa_logaxpsqrtbpcx2!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_logaxpsqrtbpcx2!(x::ComplexTPS, a::ComplexF64, b::ComplexF64, c::ComplexF64, r::ComplexTPS)</code></pre><p><code>r = log(a*x + sqrt(b + c*x^2))</code></p><p><strong>Input</strong></p><ul><li><code>x</code> – TPSA <code>x</code></li><li><code>a</code> – Scalar <code>a</code></li><li><code>b</code> – Scalar <code>b</code></li><li><code>c</code> – Scalar <code>c</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2442-L2455">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_logaxpsqrtbpcx2_r!" href="#GTPSA.mad_ctpsa_logaxpsqrtbpcx2_r!"><code>GTPSA.mad_ctpsa_logaxpsqrtbpcx2_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_logaxpsqrtbpcx2_r!(x::ComplexTPS, a_re::Cdouble, a_im::Cdouble, b_re::Cdouble, b_im::Cdouble, c_re::Cdouble, c_im::Cdouble, r::ComplexTPS)</code></pre><p><code>r = log(a*x + sqrt(b + c*x^2))</code>. Same as <code>mad_ctpsa_logaxpsqrtbpcx2</code> without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>a_re</code> – Real part of Scalar <code>a</code></li><li><code>a_im</code> – Imag part of Scalar <code>a</code></li><li><code>b_re</code> – Real part of Scalar <code>b</code></li><li><code>b_im</code> – Imag part of Scalar <code>b</code></li><li><code>c_re</code> – Real part of Scalar <code>c</code></li><li><code>c_im</code> – Imag part of Scalar <code>c</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2636-L2651">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_logpb!" href="#GTPSA.mad_ctpsa_logpb!"><code>GTPSA.mad_ctpsa_logpb!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_logpb!(na::Cint, ma, mb, mc)</code></pre><p>Computes the log of the Poisson bracket of the vector of TPSA <code>ma</code> and <code>mb</code>; the result  is the vector field <code>F</code> used to evolve to <code>ma</code> from <code>mb</code>.</p><p><strong>Input</strong></p><ul><li><code>na</code> – Length of <code>ma</code> and <code>mb</code></li><li><code>ma</code> – Vector of TPSA <code>ma</code></li><li><code>mb</code> – Vector of TPSA <code>mb</code></li></ul><p><strong>Output</strong></p><ul><li><code>mc</code> – Destination vector of TPSA <code>mc</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2770-L2783">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_logxdy!" href="#GTPSA.mad_ctpsa_logxdy!"><code>GTPSA.mad_ctpsa_logxdy!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_logxdy!(x::ComplexTPS, y::ComplexTPS, r::ComplexTPS)</code></pre><p><code>r = log(x / y)</code></p><p><strong>Input</strong></p><ul><li><code>x</code> – TPSA <code>x</code></li><li><code>y</code> – TPSA <code>y</code></li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPSA <code>r</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2461-L2472">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_maxord" href="#GTPSA.mad_ctpsa_maxord"><code>GTPSA.mad_ctpsa_maxord</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_maxord(t::ComplexTPS, n::Cint, idx_)::Cint</code></pre><p>Returns the index to the monomial with maximum abs(coefficient) in the TPSA for all orders 0 to <code>n</code>. If <code>idx_</code>  is provided, it is filled with the indices for the maximum abs(coefficient) monomial for each order up to <code>n</code>. </p><p><strong>Input</strong></p><ul><li><code>t</code>    – Complex TPSA</li><li><code>n</code>    – Highest order to include in finding the maximum abs(coefficient) in the TPSA, length of <code>idx_</code> if provided</li></ul><p><strong>Output</strong></p><ul><li><code>idx_</code> – (Optional) If provided, is filled with indices to the monomial for each order up to <code>n</code> with maximum abs(coefficient)</li><li><code>mi</code>   – Index to the monomial in the TPSA with maximum abs(coefficient)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L262-L275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_mconv!" href="#GTPSA.mad_ctpsa_mconv!"><code>GTPSA.mad_ctpsa_mconv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_mconv!(na::Cint, ma, nc::Cint, mc, n::Cint, t2r_, pb::Cint)</code></pre><p>Equivalent to <code>mad_tpsa_convert</code>, but applies the conversion to all TPSAs in the map <code>ma</code>.</p><p><strong>Input</strong></p><ul><li><code>na</code>   – Number of TPSAs in the map</li><li><code>ma</code>   – Map <code>ma</code></li><li><code>nc</code>   – Number of TPSAs in the output map <code>mc</code></li><li><code>n</code>    – Length of vector (size of <code>t2r_</code>)</li><li><code>t2r_</code> – (Optional) Vector of index lookup</li><li><code>pb</code>   – Poisson bracket, 0, 1:fwd, -1:bwd</li></ul><p><strong>Output</strong></p><ul><li><code>mc</code>   – Map <code>mc</code> with specified conversions </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2957-L2972">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_minv!" href="#GTPSA.mad_ctpsa_minv!"><code>GTPSA.mad_ctpsa_minv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_minv!(na::Cint, ma, nb::Cint, mc)</code></pre><p>Inverts the map. To include the parameters in the inversion, <code>na</code> = <code>nn</code> and the output map  length only need be <code>nb</code> = <code>nv</code>.</p><p><strong>Input</strong></p><ul><li><code>na</code> – Input map length (should be <code>nn</code> to include parameters)</li><li><code>ma</code> – Map <code>ma</code></li><li><code>nb</code> – Output map length (generally = <code>nv</code>)</li></ul><p><strong>Output</strong></p><ul><li><code>mc</code> – Inversion of map <code>ma</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2837-L2850">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_mnrm" href="#GTPSA.mad_ctpsa_mnrm"><code>GTPSA.mad_ctpsa_mnrm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_mnrm(na::Cint, ma)::Cdouble</code></pre><p>Computes the norm of the map (sum of absolute value of coefficients of all TPSAs in the map).</p><p><strong>Input</strong></p><ul><li><code>na</code>  – Number of TPSAs in the map</li><li><code>ma</code>  – Map <code>ma</code></li></ul><p><strong>Output</strong></p><ul><li><code>nrm</code> – Norm of map (sum of absolute value of coefficients of all TPSAs in the map)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2816-L2827">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_mo!" href="#GTPSA.mad_ctpsa_mo!"><code>GTPSA.mad_ctpsa_mo!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_mo!(t::ComplexTPS, mo::Cuchar)::Cuchar</code></pre><p>Sets the maximum order <code>mo</code> of the TPSA <code>t</code>, and returns the original <code>mo</code>. <code>mo</code> should be less than or equal to the allocated order <code>ao</code>.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>mo</code> – Maximum order to set the TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Original <code>mo</code> of the TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L108-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_mono!" href="#GTPSA.mad_ctpsa_mono!"><code>GTPSA.mad_ctpsa_mono!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_mono!(t::ComplexTPS, i::Cint, n::Cint, m_, p_)::Cuchar</code></pre><p>Returns the order of the monomial at index <code>i</code> in the TPSA and optionally the monomial at that index is returned in <code>m_</code> and the order of parameters in the monomial in <code>p_</code></p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>i</code>   – Index valid in TPSA</li><li><code>n</code>   – Length of monomial</li></ul><p><strong>Output</strong></p><ul><li><code>m_</code>  – (Optional) Monomial at index <code>i</code> in TPSA</li><li><code>p_</code>  – (Optional) Order of parameters in monomial</li><li><code>ret</code> – Order of monomial in TPSA <code>a</code> index <code>i</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L575-L590">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_mord" href="#GTPSA.mad_ctpsa_mord"><code>GTPSA.mad_ctpsa_mord</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_mord(na::Cint, ma, hi::Bool)::Cuchar</code></pre><p>If <code>hi</code> is false, getting the maximum <code>mo</code> among all TPSAs in <code>ma</code>.  If <code>hi</code> is <code>true</code>, gets the maximum <code>hi</code> of the map instead of <code>mo</code></p><p><strong>Input</strong></p><ul><li><code>na</code> – Length of map <code>ma</code></li><li><code>ma</code> – Map (vector of TPSAs)</li><li><code>hi</code> – If <code>true</code>, returns maximum <code>hi</code>, else returns maximum <code>mo</code> of the map</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Maximum <code>hi</code> of the map if <code>hi</code> is <code>true</code>, else returns maximum <code>mo</code> of the map</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2793-L2806">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_mul!" href="#GTPSA.mad_ctpsa_mul!"><code>GTPSA.mad_ctpsa_mul!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_mul!(a::ComplexTPS, b::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets the destination TPSA <code>c = a * b</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>b</code> – Source TPSA <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = a * b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1175-L1186">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_mult!" href="#GTPSA.mad_ctpsa_mult!"><code>GTPSA.mad_ctpsa_mult!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_mult!(a::ComplexTPS, b::RealTPS, c::ComplexTPS)</code></pre><p>Sets the destination TPS{ComplexF64} <code>c = a * b</code> (internal real-to-complex conversion).</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPS{ComplexF64} <code>a</code></li><li><code>b</code> – Source TPS{Float64} <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPS{ComplexF64} <code>c = a * b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1390-L1401">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_nam" href="#GTPSA.mad_ctpsa_nam"><code>GTPSA.mad_ctpsa_nam</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_nam(t::ComplexTPS, nam_::Cstring)::Cstring</code></pre><p>Get the name of the TPSA, and will optionally set if <code>nam_ != null</code></p><p><strong>Input</strong></p><ul><li><code>t</code>    – TPSA</li><li><code>nam_</code> – Optional name to set the TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>  – Name of TPS{ComplexF64} (Null terminated in C)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L127-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_new" href="#GTPSA.mad_ctpsa_new"><code>GTPSA.mad_ctpsa_new</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_new(t::Ref{TPS{ComplexF64}}, mo::Cuchar)</code></pre><p>Creates a blank TPSA with same number of variables/parameters of the inputted TPSA,  with maximum order specified by <code>mo</code>. If <code>MAD_TPSA_SAME</code> is passed for <code>mo</code>, the <code>mo</code>  currently in <code>t</code> is used for the created TPSA. Ok with <code>t=(tpsa_t*)ctpsa</code></p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>mo</code>  – Maximum order of new TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – New blank TPSA with maximum order <code>mo</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L23-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_newd" href="#GTPSA.mad_ctpsa_newd"><code>GTPSA.mad_ctpsa_newd</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_newd(d::Ptr{Desc}, mo::Cuchar)</code></pre><p>Creates a complex TPSA defined by the specified descriptor and maximum order. If MAD<em>TPS{ComplexF64}</em>DEFAULT  is passed for <code>mo</code>, the <code>mo</code> defined in the descriptor is used. If <code>mo &gt; d_mo</code>, then <code>mo = d_mo</code>.</p><p><strong>Input</strong></p><ul><li><code>d</code>  – Descriptor</li><li><code>mo</code> – Maximum order</li></ul><p><strong>Output</strong></p><ul><li><code>t</code>  – New complex TPSA defined by the descriptor</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L4-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_nrm" href="#GTPSA.mad_ctpsa_nrm"><code>GTPSA.mad_ctpsa_nrm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_nrm(a::ComplexTPS)::Cdouble</code></pre><p>Calculates the 1-norm of TPSA <code>a</code> (sum of <code>abs</code> of all coefficients)</p><p><strong>Input</strong></p><ul><li><code>a</code>   – TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>nrm</code> – 1-Norm of TPSA <code>a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1474-L1484">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_ord" href="#GTPSA.mad_ctpsa_ord"><code>GTPSA.mad_ctpsa_ord</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_ord(t::ComplexTPS, hi_::Bool)::Cuchar</code></pre><p>Gets the TPSA maximum order, or <code>hi</code> if <code>hi_</code> is true.</p><p><strong>Input</strong></p><ul><li><code>t</code>   – TPSA</li><li><code>hi_</code> – Set <code>true</code> if <code>hi</code> is returned, else <code>mo</code> is returned</li></ul><p><strong>Output</strong></p><ul><li><code>ret</code> – Order of TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L145-L156">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_ordv" href="#GTPSA.mad_ctpsa_ordv"><code>GTPSA.mad_ctpsa_ordv</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_ordv(t::ComplexTPS, ts::ComplexTPS...)::Cuchar</code></pre><p>Returns maximum order of all TPSAs provided.</p><p><strong>Input</strong></p><ul><li><code>t</code>  – TPSA</li><li><code>ts</code> – Variable number of TPSAs passed as parameters</li></ul><p><strong>Output</strong></p><ul><li><code>mo</code> – Maximum order of all TPSAs provided</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L162-L173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_pminv!" href="#GTPSA.mad_ctpsa_pminv!"><code>GTPSA.mad_ctpsa_pminv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_pminv!(na::Cint, ma, nb::Cint, mc, select)</code></pre><p>Computes the partial inverse of the map with only the selected variables, specified by 0s or 1s in select. To include the parameters in the inversion, <code>na</code> = <code>nn</code> and the output map length only need be <code>nb</code> = <code>nv</code>.</p><p><strong>Input</strong></p><ul><li><code>na</code> – Input map length (should be <code>nn</code> to include parameters)</li><li><code>ma</code> – Map <code>ma</code></li><li><code>nb</code> – Output map length (generally = <code>nv</code>)</li><li><code>select</code> – Array of 0s or 1s defining which variables to do inverse on (atleast same size as na)&#39;</li></ul><p><strong>Output</strong></p><ul><li><code>mc</code>     – Partially inverted map using variables specified as 1 in the select array</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2860-L2874">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_poisbra!" href="#GTPSA.mad_ctpsa_poisbra!"><code>GTPSA.mad_ctpsa_poisbra!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_poisbra!(a::ComplexTPS, b::ComplexTPS, c::ComplexTPS, nv::Cint)</code></pre><p>Sets TPSA <code>c</code> to the poisson bracket of TPSAs <code>a</code> and <code>b</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code>  – Source TPSA <code>a</code></li><li><code>b</code>  – Source TPSA <code>b</code></li><li><code>nv</code> – Number of variables in the TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>c</code>  – Destination TPSA <code>c</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2138-L2150">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_poisbrat!" href="#GTPSA.mad_ctpsa_poisbrat!"><code>GTPSA.mad_ctpsa_poisbrat!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_poisbrat!(a::ComplexTPS, b::RealTPS, c::ComplexTPS, nv::Cint)</code></pre><p>Sets TPSA <code>c</code> to the poisson bracket of TPS{ComplexF64} <code>a</code>and TPS{Float64} <code>b</code> (internal real-to-complex conversion).</p><p><strong>Input</strong></p><ul><li><code>a</code>  – Source TPS{ComplexF64} <code>a</code></li><li><code>b</code>  – Source TPS{Float64} <code>b</code></li><li><code>nv</code> – Number of variables in the TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>c</code>  – Destination TPS{ComplexF64} <code>c</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2195-L2207">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_polar!" href="#GTPSA.mad_ctpsa_polar!"><code>GTPSA.mad_ctpsa_polar!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_polar!(t::ComplexTPS, r::ComplexTPS)</code></pre><p>Sets <code>r = |t| + im*atan2(Im(t), Re(t))</code></p><p><strong>Input</strong></p><ul><li><code>t</code> – Source TPS{ComplexF64}</li><li><code>r</code> – Destination TPS{ComplexF64}</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L561-L570">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_pow!" href="#GTPSA.mad_ctpsa_pow!"><code>GTPSA.mad_ctpsa_pow!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_pow!(a::ComplexTPS, b::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets the destination TPSA <code>c = a ^ b</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>b</code> – Source TPSA <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = a ^ b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1209-L1220">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_powi!" href="#GTPSA.mad_ctpsa_powi!"><code>GTPSA.mad_ctpsa_powi!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_powi!(a::ComplexTPS, n::Cint, c::ComplexTPS)</code></pre><p>Sets the destination TPSA <code>c = a ^ n</code> where <code>n</code> is an integer.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>n</code> – Integer power</li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = a ^ n</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1226-L1237">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_pown!" href="#GTPSA.mad_ctpsa_pown!"><code>GTPSA.mad_ctpsa_pown!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_pown!(a::ComplexTPS, v::ComplexF64, c::ComplexTPS)</code></pre><p>Sets the destination TPSA <code>c = a ^ v</code> where <code>v</code> is of double precision.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>v</code> – Power, ComplexF64</li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = a ^ v</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1243-L1254">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_pown_r!" href="#GTPSA.mad_ctpsa_pown_r!"><code>GTPSA.mad_ctpsa_pown_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_pown_r!(a::ComplexTPS, v_re::Cdouble, v_im::Cdouble, c::ComplexTPS)</code></pre><p>Sets the destination TPSA <code>c = a ^ v</code> where <code>v</code> is of double precision. Without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>a</code>    – Source TPSA <code>a</code></li><li><code>v_re</code> – Real part of power</li><li><code>v_im</code> – Imaginary part of power</li></ul><p><strong>Output</strong></p><ul><li><code>c</code>    – Destination TPSA <code>c = a ^ v</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1260-L1272">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_powt!" href="#GTPSA.mad_ctpsa_powt!"><code>GTPSA.mad_ctpsa_powt!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_powt!(a::ComplexTPS, b::RealTPS, c::ComplexTPS)</code></pre><p>Sets the destination TPS{ComplexF64} <code>c = a ^ b</code> (internal real-to-complex conversion).</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPS{ComplexF64} <code>a</code></li><li><code>b</code> – Source TPS{Float64} <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPS{ComplexF64} <code>c = a ^ b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1440-L1451">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_print" href="#GTPSA.mad_ctpsa_print"><code>GTPSA.mad_ctpsa_print</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_print(t::ComplexTPS, name_ eps_::Cdouble, nohdr_::Cint, stream_::Ptr{Cvoid})</code></pre><p>Prints the TPSA coefficients with precision <code>eps_</code>. If <code>nohdr_</code> is not zero,  the header is not printed. </p><p><strong>Input</strong></p><ul><li><code>t</code>       – TPSA to print</li><li><code>name_</code>   – (Optional) Name of TPSA</li><li><code>eps_</code>    – (Optional) Precision to output</li><li><code>nohdr_</code>  – (Optional) If True, no header is printed</li><li><code>stream_</code> – (Optional) <code>FILE</code> pointer of output stream. Default is <code>stdout</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2983-L2995">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_real!" href="#GTPSA.mad_ctpsa_real!"><code>GTPSA.mad_ctpsa_real!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_real!(t::ComplexTPS, r::RealTPS)</code></pre><p>Sets the TPS{Float64} <code>r</code> equal to the real part of TPS{ComplexF64} <code>t</code>.</p><p><strong>Input</strong></p><ul><li><code>t</code> – Source TPS{ComplexF64}</li></ul><p><strong>Output</strong></p><ul><li><code>r</code> – Destination TPS{Float64} with <code>r = Re(t)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L467-L478">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_rect!" href="#GTPSA.mad_ctpsa_rect!"><code>GTPSA.mad_ctpsa_rect!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_rect!(t::ComplexTPS, r::ComplexTPS)</code></pre><p>Sets <code>r = Re(t)*cos(Im(t)) + im*Re(t)*sin(Im(t))</code></p><p><strong>Input</strong></p><ul><li><code>t</code> – Source TPS{ComplexF64}</li><li><code>r</code> – Destination TPS{ComplexF64}</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L547-L556">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_scan" href="#GTPSA.mad_ctpsa_scan"><code>GTPSA.mad_ctpsa_scan</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_scan(stream_::Ptr{Cvoid})::ComplexTPS</code></pre><p>Scans in a TPSA from the <code>stream_</code>.</p><p><strong>Input</strong></p><ul><li><code>stream_</code> – (Optional) I/O stream from which to read the TPSA, default is <code>stdin</code></li></ul><p><strong>Output</strong></p><ul><li><code>t</code>       – TPSA scanned from I/O <code>stream_</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L3001-L3011">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_scan_coef!" href="#GTPSA.mad_ctpsa_scan_coef!"><code>GTPSA.mad_ctpsa_scan_coef!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_scan_coef!(t::ComplexTPS, stream_::Ptr{Cvoid})</code></pre><p>Read TPSA coefficients into TPSA <code>t</code>. This should be used with <code>mad_tpsa_scan_hdr</code> for external languages using  this library where the memory is managed NOT on the C side.</p><p><strong>Input</strong></p><ul><li><code>stream_</code> – (Optional) I/O stream to read TPSA from, default is <code>stdin</code></li></ul><p><strong>Output</strong></p><ul><li><code>t</code>       – TPSA with coefficients scanned from <code>stream_</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L3038-L3049">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_scan_hdr" href="#GTPSA.mad_ctpsa_scan_hdr"><code>GTPSA.mad_ctpsa_scan_hdr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_scan_hdr(kind_::Ref{Cint}, name_::Ptr{Cuchar}, stream_::Ptr{Cvoid})::Ptr{Desc}</code></pre><p>Read TPSA header. Returns descriptor for TPSA given the header. This is useful for external languages using  this library where the memory is managed NOT on the C side.</p><p><strong>Input</strong></p><ul><li><code>kind_</code>   – (Optional) Real or complex TPSA, or detect automatically if not provided.</li><li><code>name_</code>   – (Optional) Name of TPSA</li><li><code>stream_</code> – (Optional) I/O stream to read TPSA from,  default is <code>stdin</code></li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>     – Descriptor for the TPSA </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L3018-L3031">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_scl!" href="#GTPSA.mad_ctpsa_scl!"><code>GTPSA.mad_ctpsa_scl!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_scl!(a::ComplexTPS, v::ComplexF64, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to <code>v*a</code>. </p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>v</code> – Scalar with double precision</li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = v*a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2000-L2011">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_scl_r!" href="#GTPSA.mad_ctpsa_scl_r!"><code>GTPSA.mad_ctpsa_scl_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_scl_r!(a::ComplexTPS, v_re::Cdouble, v_im::Cdouble,, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to <code>v*a</code>.  Without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>a</code>    – Source TPSA <code>a</code></li><li><code>v_re</code> – Real part of scalar with double precision</li><li><code>v_im</code> – Imaginary part of scalar with double precision</li></ul><p><strong>Output</strong></p><ul><li><code>c</code>    – Destination TPSA <code>c = v*a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2249-L2261">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_sclord!" href="#GTPSA.mad_ctpsa_sclord!"><code>GTPSA.mad_ctpsa_sclord!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_sclord!(t::ComplexTPS, r::ComplexTPS, inv::Bool, prm::Bool)</code></pre><p>Scales all coefficients by order. If <code>inv == 0</code>, scales coefficients by order (derivation), else scales coefficients  by 1/order (integration).</p><p><strong>Input</strong></p><ul><li><code>t</code>   – Source complex TPSA</li><li><code>inv</code> – Put order up, divide, scale by <code>inv</code> of value of order</li><li><code>prm</code> – Parameters flag. If set to 0x0, the scaling excludes the order of the parameters in the monomials. Else, scaling is with total order of monomial</li></ul><p><strong>Output</strong></p><ul><li><code>r</code>   – Destination complex TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L196-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_seti!" href="#GTPSA.mad_ctpsa_seti!"><code>GTPSA.mad_ctpsa_seti!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_seti!(t::ComplexTPS, i::Cint, a::ComplexF64, b::ComplexF64)</code></pre><p>Sets the coefficient of monomial at index <code>i</code> to <code>coef[i] = a*coef[i] + b</code>. Does not modify other values in TPSA.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>i</code> – Index of monomial</li><li><code>a</code> – Scaling of current coefficient</li><li><code>b</code> – Constant added to current coefficient</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L765-L775">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_seti_r!" href="#GTPSA.mad_ctpsa_seti_r!"><code>GTPSA.mad_ctpsa_seti_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_seti_r!(t::ComplexTPS, i::Cint, a_re::Cdouble, a_im::Cdouble, b_re::Cdouble, b_im::Cdouble)</code></pre><p>Sets the coefficient of monomial at index <code>i</code> to <code>coef[i] = a*coef[i] + b</code>. Does not modify other values in TPSA. Equivalent to <code>mad_ctpsa_seti</code> but without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>i</code> – Index of monomial</li><li><code>a_re</code> – Real part of <code>a</code></li><li><code>a_im</code> – Imaginary part of <code>a</code></li><li><code>b_re</code> – Real part of <code>b</code></li><li><code>b_im</code> – Imaginary part of <code>b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L983-L996">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_setm!" href="#GTPSA.mad_ctpsa_setm!"><code>GTPSA.mad_ctpsa_setm!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_setm!(t::ComplexTPS, n::Cint, m, a::ComplexF64, b::ComplexF64)</code></pre><p>Sets the coefficient of monomial defined by byte array <code>m</code> to <code>coef = a*coef + b</code>. Does not modify other values in TPSA.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>n</code> – Length of monomial</li><li><code>m</code> – Monomial as byte array</li><li><code>a</code> – Scaling of current coefficient</li><li><code>b</code> – Constant added to current coefficient</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L798-L809">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_setm_r!" href="#GTPSA.mad_ctpsa_setm_r!"><code>GTPSA.mad_ctpsa_setm_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_setm_r!(t::ComplexTPS, n::Cint, m, a_re::Cdouble, a_im::Cdouble, b_re::Cdouble, b_im::Cdouble)</code></pre><p>Sets the coefficient of monomial defined by byte array <code>m</code> to <code>coef = a*coef + b</code>. Does not modify other values in TPSA. Equivalent to <code>mad_ctpsa_setm</code> but without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>n</code> – Length of monomial</li><li><code>m</code> – Monomial as byte array</li><li><code>a_re</code> – Real part of <code>a</code></li><li><code>a_im</code> – Imaginary part of <code>a</code></li><li><code>b_re</code> – Real part of <code>b</code></li><li><code>b_im</code> – Imaginary part of <code>b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1022-L1036">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_setprm!" href="#GTPSA.mad_ctpsa_setprm!"><code>GTPSA.mad_ctpsa_setprm!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_setprm!(t::ComplexTPS, v::ComplexF64, ip::Cint)</code></pre><p>Sets the 0th and 1st order values for the specified parameter, and sets the rest of the variables/parameters to 0.  The 1st order value <code>scl_</code> of a parameter is always 1.</p><p><strong>Input</strong></p><ul><li><code>t</code>    – TPSA</li><li><code>v</code>    – 0th order value (coefficient)</li><li><code>ip</code>   – Parameter index (e.g. iv = 1 is nn-nv+1)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L320-L330">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_setprm_r!" href="#GTPSA.mad_ctpsa_setprm_r!"><code>GTPSA.mad_ctpsa_setprm_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_setprm_r!(t::ComplexTPS, v_re::Cdouble, v_im::Cdouble, ip::Cint)</code></pre><p>Sets the 0th and 1st order values for the specified parameter. Equivalent to <code>mad_ctpsa_setprm</code> but without complex-by-value arguments. The 1st order value <code>scl_</code> of a parameter is always 1.</p><p><strong>Input</strong></p><ul><li><code>t</code>       – Complex TPSA</li><li><code>v_re</code>    – Real part of 0th order value</li><li><code>v_im</code>    – Imaginary part of 0th order value</li><li><code>ip</code>      – Parameter index</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L352-L363">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_sets!" href="#GTPSA.mad_ctpsa_sets!"><code>GTPSA.mad_ctpsa_sets!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_sets!(t::ComplexTPS, n::Cint, s::Cstring, a::ComplexF64, b::ComplexF64)</code></pre><p>Sets the coefficient of monomial defined by string <code>s</code> to <code>coef = a*coef + b</code>. Does not modify other values in TPSA.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>n</code> – Length of monomial</li><li><code>s</code> – Monomial as string</li><li><code>a</code> – Scaling of current coefficient</li><li><code>b</code> – Constant added to current coefficient</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L781-L792">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_sets_r!" href="#GTPSA.mad_ctpsa_sets_r!"><code>GTPSA.mad_ctpsa_sets_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_sets_r!(t::ComplexTPS, n::Cint, s::Cstring, a_re::Cdouble, a_im::Cdouble, b_re::Cdouble, b_im::Cdouble)</code></pre><p>Sets the coefficient of monomial defined by string <code>s</code> to <code>coef = a*coef + b</code>. Does not modify other values in TPSA. Equivalent to <code>mad_ctpsa_set</code> but without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>n</code> – Length of monomial</li><li><code>s</code> – Monomial as string</li><li><code>a_re</code> – Real part of <code>a</code></li><li><code>a_im</code> – Imaginary part of <code>a</code></li><li><code>b_re</code> – Real part of <code>b</code></li><li><code>b_im</code> – Imaginary part of <code>b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1002-L1016">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_setsm!" href="#GTPSA.mad_ctpsa_setsm!"><code>GTPSA.mad_ctpsa_setsm!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_setsm!(t::ComplexTPS, n::Cint, m, a::ComplexF64, b::ComplexF64)</code></pre><p>Sets the coefficient of monomial defined by sparse monomial <code>m</code> to <code>coef = a*coef + b</code>. Does not modify other values in TPSA.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>n</code> – Length of monomial</li><li><code>m</code> – Monomial as sparse monomial</li><li><code>a</code> – Scaling of current coefficient</li><li><code>b</code> – Constant added to current coefficient</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L882-L893">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_setsm_r!" href="#GTPSA.mad_ctpsa_setsm_r!"><code>GTPSA.mad_ctpsa_setsm_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_setsm_r!(t::ComplexTPS, n::Cint, m, a_re::Cdouble, a_im::Cdouble, b_re::Cdouble, b_im::Cdouble)</code></pre><p>Sets the coefficient of monomial defined by sparse monomial m to <code>coef = a*coef + b</code>. Does not modify other values in TPSA. Equivalent to <code>mad_ctpsa_setsm</code> but without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>n</code> – Length of monomial</li><li><code>m</code> – Monomial as sparse monomial</li><li><code>a_re</code> – Real part of <code>a</code></li><li><code>a_im</code> – Imaginary part of <code>a</code></li><li><code>b_re</code> – Real part of <code>b</code></li><li><code>b_im</code> – Imaginary part of <code>b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1043-L1057">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_setv!" href="#GTPSA.mad_ctpsa_setv!"><code>GTPSA.mad_ctpsa_setv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_setv!(t::ComplexTPS, i::Cint, n::Cint, v)</code></pre><p>Vectorized setter of the coefficients for monomials with indices <code>i..i+n</code>. Useful for putting a matrix into a map.</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA</li><li><code>i</code> – Starting index of monomials to set coefficients</li><li><code>n</code> – Number of monomials to set coefficients of starting at <code>i</code></li><li><code>v</code> – Array of coefficients for monomials <code>i..i+n</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1084-L1094">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_setval!" href="#GTPSA.mad_ctpsa_setval!"><code>GTPSA.mad_ctpsa_setval!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_setval!(t::ComplexTPS, v::ComplexF64)</code></pre><p>Sets the scalar part of the TPSA to <code>v</code> and all other values to 0 (sets the TPSA order to 0).</p><p><strong>Input</strong></p><ul><li><code>t</code> – TPSA to set to scalar</li><li><code>v</code> – Scalar value to set TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L369-L377">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_setval_r!" href="#GTPSA.mad_ctpsa_setval_r!"><code>GTPSA.mad_ctpsa_setval_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_setval_r!(t::ComplexTPS, v_re::Cdouble, v_im::Cdouble)</code></pre><p>Sets the scalar part of the TPSA to <code>v</code> and all other values to 0 (sets the TPSA order to 0). Equivalent to <code>mad_ctpsa_setval</code> but without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>t</code>    – TPSA to set to scalar</li><li><code>v_re</code> – Real part of scalar value to set TPSA</li><li><code>v_im</code> – Imaginary part of scalar value to set TPSA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L392-L402">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_setvar!" href="#GTPSA.mad_ctpsa_setvar!"><code>GTPSA.mad_ctpsa_setvar!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>mad<em>ctpsa</em>setvar!(t::ComplexTPS, v::ComplexF64, iv::Cint, scl_::ComplexF64)</p><p>Sets the 0th and 1st order values for the specified variable, and sets the rest of the variables to 0</p><p><strong>Input</strong></p><ul><li><code>t</code>    – TPSA</li><li><code>v</code>    – 0th order value (coefficient)</li><li><code>iv</code>   – Variable index</li><li><code>scl_</code> – 1st order variable value (typically will be 1)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L305-L315">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_setvar_r!" href="#GTPSA.mad_ctpsa_setvar_r!"><code>GTPSA.mad_ctpsa_setvar_r!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_setvar_r!(t::ComplexTPS, v_re::Cdouble, v_im::Cdouble, iv::Cint, scl_re_::Cdouble, scl_im_::Cdouble)</code></pre><p>Sets the 0th and 1st order values for the specified variable. Equivalent to <code>mad_ctpsa_setvar</code> but without complex-by-value arguments.</p><p><strong>Input</strong></p><ul><li><code>t</code>       – Complex TPSA</li><li><code>v_re</code>    – Real part of 0th order value</li><li><code>v_im</code>    – Imaginary part of 0th order value</li><li><code>iv</code>      – Variable index</li><li><code>scl_re_</code> – (Optional) Real part of 1st order variable value</li><li><code>scl_im_</code> – (Optional)Imaginary part of 1st order variable value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L335-L347">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_sin!" href="#GTPSA.mad_ctpsa_sin!"><code>GTPSA.mad_ctpsa_sin!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_sin!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>sin</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = sin(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1571-L1581">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_sinc!" href="#GTPSA.mad_ctpsa_sinc!"><code>GTPSA.mad_ctpsa_sinc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_sinc!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>sinc</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = sinc(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1635-L1645">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_sincos!" href="#GTPSA.mad_ctpsa_sincos!"><code>GTPSA.mad_ctpsa_sincos!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_sincos!(a::ComplexTPS, s::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>s = sin(a)</code> and TPSA <code>c = cos(a)</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>s</code> – Destination TPSA <code>s = sin(a)</code></li><li><code>c</code> – Destination TPSA <code>c = cos(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1554-L1565">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_sincosh!" href="#GTPSA.mad_ctpsa_sincosh!"><code>GTPSA.mad_ctpsa_sincosh!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_sincosh!(a::ComplexTPS, s::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>s = sinh(a)</code> and TPSA <code>c = cosh(a)</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>s</code> – Destination TPSA <code>s = sinh(a)</code></li><li><code>c</code> – Destination TPSA <code>c = cosh(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1651-L1662">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_sinh!" href="#GTPSA.mad_ctpsa_sinh!"><code>GTPSA.mad_ctpsa_sinh!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_sinh!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>sinh</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = sinh(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1668-L1678">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_sinhc!" href="#GTPSA.mad_ctpsa_sinhc!"><code>GTPSA.mad_ctpsa_sinhc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_sinhc!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>sinhc</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = sinhc(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1732-L1742">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_sqrt!" href="#GTPSA.mad_ctpsa_sqrt!"><code>GTPSA.mad_ctpsa_sqrt!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_sqrt!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>sqrt</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = sqrt(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1505-L1515">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_sub!" href="#GTPSA.mad_ctpsa_sub!"><code>GTPSA.mad_ctpsa_sub!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_sub!(a::ComplexTPS, b::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets the destination TPSA <code>c = a - b</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li><li><code>b</code> – Source TPSA <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = a - b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1158-L1169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_subt!" href="#GTPSA.mad_ctpsa_subt!"><code>GTPSA.mad_ctpsa_subt!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_subt!(a::ComplexTPS, b::RealTPS, c::ComplexTPS)</code></pre><p>Sets the destination TPS{ComplexF64} <code>c = a - b</code> (internal real-to-complex conversion).</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPS{ComplexF64} <code>a</code></li><li><code>b</code> – Source TPS{Float64} <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPS{ComplexF64} <code>c = a - b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1356-L1367">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_tan!" href="#GTPSA.mad_ctpsa_tan!"><code>GTPSA.mad_ctpsa_tan!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_tan!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>tan</code> of TPSA <code>a</code>.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = tan(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1603-L1613">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_tanh!" href="#GTPSA.mad_ctpsa_tanh!"><code>GTPSA.mad_ctpsa_tanh!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_tanh!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets TPSA <code>c</code> to the <code>tanh</code> of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = tanh(a)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1700-L1710">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_taylor!" href="#GTPSA.mad_ctpsa_taylor!"><code>GTPSA.mad_ctpsa_taylor!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_taylor!(a::ComplexTPS, n::Cint, coef, c::ComplexTPS)</code></pre><p>Computes the result of the Taylor series up to order <code>n-1</code> with Taylor coefficients <code>coef</code> for the scalar value in <code>a</code>. That is, <code>c = coef[0] + coef[1]*a_0 + coef[2]*a_0^2 + ...</code> where <code>a_0</code> is the scalar part of TPSA <code>a</code></p><p><strong>Input</strong></p><ul><li><code>a</code>    – TPSA <code>a</code></li><li><code>n</code>    – <code>Order-1</code> of Taylor expansion, size of <code>coef</code> array</li><li><code>coef</code> – Array of coefficients in Taylor <code>s</code></li><li><code>c</code>    – Result</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2156-L2167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_taylor_h!" href="#GTPSA.mad_ctpsa_taylor_h!"><code>GTPSA.mad_ctpsa_taylor_h!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_taylor_h!(a::ComplexTPS, n::Cint, coef, c::ComplexTPS)</code></pre><p>Computes the result of the Taylor series up to order <code>n-1</code> with Taylor coefficients <code>coef</code> for  the scalar value in <code>a</code>. That is, <code>c = coef[0] + coef[1]*a_0 + coef[2]*a_0^2 + ...</code> where <code>a_0</code>  is the scalar part of TPSA <code>a</code>.</p><p>Same as <code>mad_ctpsa_taylor</code>, but uses Horner&#39;s method (which is 50%-100% slower because mul is  always full order).</p><p><strong>Input</strong></p><ul><li><code>a</code>    – TPSA <code>a</code></li><li><code>n</code>    – <code>Order-1</code> of Taylor expansion, size of <code>coef</code> array</li><li><code>coef</code> – Array of coefficients in Taylor <code>s</code></li><li><code>c</code>    – Result</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2173-L2188">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_tdif!" href="#GTPSA.mad_ctpsa_tdif!"><code>GTPSA.mad_ctpsa_tdif!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_tdif!(a::RealTPS, b::ComplexTPS, c::ComplexTPS)</code></pre><p>For each homogeneous polynomial in TPS{Float64} <code>a</code> and TPS{ComplexF64} <code>b</code>, calculates either the relative error or absolute error for each order. If the maximum coefficient for a given order in <code>a</code> is &gt; 1, the relative error is computed for that order. Else, the absolute  error is computed. This is very useful for comparing maps between codes or doing unit tests. In Julia, essentially:</p><p><code>c_i = (a_i.-b_i)/maximum([abs.(a_i)...,1])</code> where <code>a_i</code> and <code>b_i</code> are vectors of the monomials for an order <code>i</code></p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPS{Float64} <code>a</code></li><li><code>b</code> – Source TPS{ComplexF64} <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPS{ComplexF64} <code>c</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1319-L1334">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_tdiv!" href="#GTPSA.mad_ctpsa_tdiv!"><code>GTPSA.mad_ctpsa_tdiv!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_tdiv!(a::RealTPS, b::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets the destination TPS{ComplexF64} <code>c = a / b</code> (internal real-to-complex conversion).</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPS{Float64} <code>a</code></li><li><code>b</code> – Source TPS{ComplexF64} <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPS{ComplexF64} <code>c = a / b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1424-L1435">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_tpoisbra!" href="#GTPSA.mad_ctpsa_tpoisbra!"><code>GTPSA.mad_ctpsa_tpoisbra!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_tpoisbra!(a::RealTPS, b::ComplexTPS, c::ComplexTPS, nv::Cint)</code></pre><p>Sets TPSA <code>c</code> to the poisson bracket of TPS{Float64} <code>a</code> and TPS{ComplexF64} <code>b</code> (internal real-to-complex conversion).</p><p><strong>Input</strong></p><ul><li><code>a</code>  – Source TPS{Float64} <code>a</code></li><li><code>b</code>  – Source TPS{ComplexF64} <code>b</code></li><li><code>nv</code> – Number of variables in the TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>c</code>  – Destination TPS{ComplexF64} <code>c</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2213-L2225">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_tpow!" href="#GTPSA.mad_ctpsa_tpow!"><code>GTPSA.mad_ctpsa_tpow!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_tpow!(a::RealTPS, b::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets the destination TPS{ComplexF64} <code>c = a ^ b</code> (internal real-to-complex conversion).</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPS{Float64} <code>a</code></li><li><code>b</code> – Source TPS{ComplexF64} <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c = a ^ b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1457-L1468">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_translate!" href="#GTPSA.mad_ctpsa_translate!"><code>GTPSA.mad_ctpsa_translate!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_translate!(na::Cint, ma, nb::Cint, tb, mc)</code></pre><p>Translates the expansion point of the map by the amount <code>tb</code>.</p><p><strong>Input</strong></p><ul><li><code>na</code> – Number of TPSAS in the map</li><li><code>ma</code> – Map <code>ma</code></li><li><code>nb</code> – Length of <code>tb</code></li><li><code>tb</code> – Vector of amount to translate for each variable</li></ul><p><strong>Output</strong></p><ul><li><code>mc</code> – Map evaluated at the new point translated <code>tb</code> from the original evaluation point</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2909-L2922">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_tsub!" href="#GTPSA.mad_ctpsa_tsub!"><code>GTPSA.mad_ctpsa_tsub!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_tsub!(a::RealTPS, b::ComplexTPS, c::ComplexTPS)</code></pre><p>Sets the destination TPS{ComplexF64} <code>c = a - b</code> (internal real-to-complex conversion).</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPS{Float64} <code>a</code></li><li><code>b</code> – Source TPS{ComplexF64} <code>b</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPS{ComplexF64} <code>c = a - b</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L1373-L1384">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_uid!" href="#GTPSA.mad_ctpsa_uid!"><code>GTPSA.mad_ctpsa_uid!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_uid!(t::ComplexTPS, uid_::Cint)::Cint</code></pre><p>Sets the TPSA <code>uid</code> if <code>uid_ != 0</code>, and returns the current (previous if set) TPSA <code>uid</code>. </p><p><strong>Input</strong></p><ul><li><code>t</code>    – Complex TPSA</li><li><code>uid_</code> – <code>uid</code> to set in the TPSA if <code>uid_ != 0</code></li></ul><p><strong>Output</strong></p><ul><li><code>ret</code>  – Current (previous if set) TPSA <code>uid</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L73-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_unit!" href="#GTPSA.mad_ctpsa_unit!"><code>GTPSA.mad_ctpsa_unit!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_unit!(a::ComplexTPS, c::ComplexTPS)</code></pre><p>Interpreting TPSA as a vector, gets the &quot;unit vector&quot;, e.g. <code>c = a/norm(a)</code>. May be useful for checking for convergence.</p><p><strong>Input</strong></p><ul><li><code>a</code> – Source TPSA <code>a</code></li></ul><p><strong>Output</strong></p><ul><li><code>c</code> – Destination TPSA <code>c</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L531-L542">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_update!" href="#GTPSA.mad_ctpsa_update!"><code>GTPSA.mad_ctpsa_update!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_update!(t::ComplexTPS)</code></pre><p>Updates the <code>lo</code> and <code>hi</code> fields of the TPSA to reflect the current state  given the lowest/highest nonzero monomial coefficients.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L382-L387">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.mad_ctpsa_vec2fld!" href="#GTPSA.mad_ctpsa_vec2fld!"><code>GTPSA.mad_ctpsa_vec2fld!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mad_ctpsa_vec2fld!(na::Cint, a::ComplexTPS, mc)</code></pre><p>Assuming the variables in the TPSA are canonically-conjugate, and ordered so that the canonically- conjugate variables are consecutive (q1, p1, q2, p2, ...), calculates the vector field (Hamilton&#39;s  equations) from the passed Hamiltonian, defined as <code>[da/dp1, -da/dq1, ...]</code></p><p><strong>Input</strong></p><ul><li><code>na</code>  – Number of TPSA in <code>mc</code> consistent with number of variables in <code>a</code></li><li><code>a</code>   – Hamiltonian as a TPSA</li></ul><p><strong>Output</strong></p><ul><li><code>mc</code>  – Vector field derived from <code>a</code> using Hamilton&#39;s equations </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/29e2284a41815a846786e9f37cf038df4d887985/src/low_level/ctpsa.jl#L2657-L2670">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../man/m_all/">« All Overloaded Functions</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 22 January 2025 12:31">Wednesday 22 January 2025</span>. Using Julia version 1.10.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
