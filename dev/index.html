<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · GTPSA.jl</title><meta name="title" content="Home · GTPSA.jl"/><meta property="og:title" content="Home · GTPSA.jl"/><meta property="twitter:title" content="Home · GTPSA.jl"/><meta name="description" content="Documentation for GTPSA.jl."/><meta property="og:description" content="Documentation for GTPSA.jl."/><meta property="twitter:description" content="Documentation for GTPSA.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>GTPSA.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Setup"><span>Setup</span></a></li><li><a class="tocitem" href="#Basic-Usage"><span>Basic Usage</span></a></li><li><a class="tocitem" href="#Acknowledgements"><span>Acknowledgements</span></a></li></ul></li><li><a class="tocitem" href="usage/">Usage</a></li><li><a class="tocitem" href="constructors/">Constructors</a></li><li><a class="tocitem" href="devel/">For Developers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bmad-sim/GTPSA.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bmad-sim/GTPSA.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="GTPSA.jl"><a class="docs-heading-anchor" href="#GTPSA.jl">GTPSA.jl</a><a id="GTPSA.jl-1"></a><a class="docs-heading-anchor-permalink" href="#GTPSA.jl" title="Permalink"></a></h1><p><em>A Julia interface to the Generalised Truncated Power Series Algebra (GTPSA) library in MAD.</em></p><p>This package provides a full-featured Julia interface to the <a href="https://github.com/MethodicalAcceleratorDesign/MAD-NG">Generalised Truncated Power Series Algebra (GTPSA) library</a>, which computes Taylor expansions, or Truncated Power Series (TPSs) of real and complex multivariable functions to individual arbitrary orders in the variables (up to 63). </p><p>GTPSA, which uses the Truncated Power Series Algebra method for calculating Taylor expansions, has several advantages over current similar Julia packages:</p><ol><li><strong>Speed and Accuracy</strong>: Because the TPSA method does not take any symbolic derivatives, nor use finite differencing, Taylor expansions are calculated with high efficiency, speed, and accuracy</li><li><strong>Arbitrary Orders in Individual Variables</strong>: For example, computing the Taylor expansion of <span>$f(x_1,x_2)$</span> to 5th order in <span>$x_1$</span> and 1st order in <span>$x_2$</span> is done trivially in GTPSA</li><li><strong>All Taylor Coefficients Stored</strong>: All monomial coefficients are stored and propagated according to the algebra. GTPSA also implements an efficient coefficient indexing function for high speed even with TPSs having large number of variables to high orders</li><li><strong>Distinction Between &quot;Variables&quot; and &quot;Parameters&quot;</strong>: When the TPS represents a <em>Taylor map</em> of a dynamical system, which defines the evolution of map <em>variables</em> given some variations in map <em>parameters</em>, distinguishing between the two is highly advantageous in analyses of Taylor maps (e.g. normal form)</li></ol><p><strong>GTPSA is fast!</strong> See the <code>benchmark/taylormap.jl</code> example for a speed comparison of <code>GTPSA.jl</code> with <code>ForwardDiff.jl</code> and <code>TaylorSeries.jl</code> in calculating a multivariable Taylor map to 2nd order.</p><h2 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h2><p>To use <code>GTPSA.jl</code>, in the Julia REPL run</p><pre><code class="nohighlight hljs">] add https://github.com/bmad-sim/GTPSA.jl.git</code></pre><p>For developers,</p><pre><code class="nohighlight hljs">] dev https://github.com/bmad-sim/GTPSA.jl.git</code></pre><h2 id="Basic-Usage"><a class="docs-heading-anchor" href="#Basic-Usage">Basic Usage</a><a id="Basic-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Usage" title="Permalink"></a></h2><p>First, a <code>Descriptor</code> must be created specifying the number of variables, number of parameters, the orders of each variable, and the orders of each parameter for the TPSA. The <code>Descriptor</code> stores all of the monomial indexing/lookup information for TPSs in the TPSA, based on these values. A <code>TPS</code> or <code>ComplexTPS</code> can then be created based on the <code>Descriptor</code>. TPSs can be manipulated using all of the elementary math operators (<code>+</code>,<code>-</code>,<code>*</code>,<code>/</code>,<code>^</code>) and math functions (e.g. <code>abs</code>, <code>sqrt</code>, <code>sin</code>, <code>exp</code>, <code>log</code>, <code>coth</code>, etc.).</p><p>TPSs can be viewed as structures containing the coefficients of all the monomials in a multivariable Taylor expansion up to the orders specified in the <code>Descriptor</code>. As an example, to compute the TPS of a function <span>$f(x_1,x_2) = x_1^2\frac{\sin{(2+x_1x_2)}}{\exp{(x_1+x_2)}}$</span> to 15th order in <span>$x_1$</span> and <span>$x_2$</span>:</p><pre><code class="nohighlight hljs">using GTPSA

# Define the Descriptor for the TPSA
d = Descriptor(2, 15)

# Get the TPSs corresponding to each variable based on the Descriptor
x = vars(d)

# Manipulate the TPSs as you would any other mathematical variable in Julia
f = x[1]^2*sin(2+x[1]*x[2])/exp(x[1]+x[2])</code></pre><p><code>f</code> itself is a TPS. Note that scalars do not need to be defined as TPSs when writing expressions. Running <code>print(f)</code> then gives the output</p><pre><code class="nohighlight hljs">         :  R, NV =   2, MO = 15
 *******************************************************
     I   COEFFICIENT             ORDER   EXPONENTS
     1   9.0929742682568171E-01    2     2 0
     2   0.0000000000000000E+00    2     1 1
     3   0.0000000000000000E+00    2     0 2
     4  -9.0929742682568171E-01    3     3 0
     5  -9.0929742682568171E-01    3     2 1
     6   0.0000000000000000E+00    3     1 2
     7   0.0000000000000000E+00    3     0 3
     8   4.5464871341284085E-01    4     4 0
     9   4.9315059027853930E-01    4     3 1
    10   4.5464871341284085E-01    4     2 2
    11   0.0000000000000000E+00    4     1 3
    12   0.0000000000000000E+00    4     0 4
    13  -1.5154957113761358E-01    5     5 0
    14  -3.8501876865698448E-02    5     4 1
                    ...</code></pre><p>This print function will be rewritten.</p><p>For multivariable TPSs including variables/parameters with different individual orders, and complex TPSs, see <a href="usage/#Usage">Usage</a>.</p><p>Advanced users are referred to <a href="https://inspirehep.net/files/286f2ab60e1e7c372cec485337ab5eb6">this paper</a> written by the developers of the GTPSA library for more details.</p><h2 id="Acknowledgements"><a class="docs-heading-anchor" href="#Acknowledgements">Acknowledgements</a><a id="Acknowledgements-1"></a><a class="docs-heading-anchor-permalink" href="#Acknowledgements" title="Permalink"></a></h2><p>We thank Laurent Deniau, the creator of GTPSA, for very detailed and lengthy discussions on using his C library. </p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="usage/">Usage »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Sunday 7 January 2024 15:18">Sunday 7 January 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
