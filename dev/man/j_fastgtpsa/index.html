<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>@FastGTPSA/@FastGTPSA! Macros · GTPSA.jl</title><meta name="title" content="@FastGTPSA/@FastGTPSA! Macros · GTPSA.jl"/><meta property="og:title" content="@FastGTPSA/@FastGTPSA! Macros · GTPSA.jl"/><meta property="twitter:title" content="@FastGTPSA/@FastGTPSA! Macros · GTPSA.jl"/><meta name="description" content="Documentation for GTPSA.jl."/><meta property="og:description" content="Documentation for GTPSA.jl."/><meta property="twitter:description" content="Documentation for GTPSA.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GTPSA.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quickstart/">Quickstart Guide</a></li><li><a class="tocitem" href="../../advanced/">Advanced Usage</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../a_toc/">Table of Contents</a></li><li><a class="tocitem" href="../b_descriptor/"><code>Descriptor</code></a></li><li><a class="tocitem" href="../c_tps/"><code>TPS</code></a></li><li><a class="tocitem" href="../d_varsparams/"><code>@vars</code>, <code>@params</code></a></li><li><a class="tocitem" href="../e_monoindex/">Monomial Indexing</a></li><li><a class="tocitem" href="../f_mono/"><code>mono</code>/<code>complexmono</code></a></li><li><a class="tocitem" href="../g_gjh/"><code>gradient</code>, <code>jacobian</code>, <code>hessian</code></a></li><li><a class="tocitem" href="../h_slice/">Slicing and <code>par</code></a></li><li><a class="tocitem" href="../i_methods/"><code>TPS</code>-Specific Functions</a></li><li class="is-active"><a class="tocitem" href><code>@FastGTPSA</code>/<code>@FastGTPSA!</code> Macros</a><ul class="internal"><li><a class="tocitem" href="#Note-on-Julia-Versions-v1.10"><span>Note on Julia Versions &lt; v1.10</span></a></li><li><a class="tocitem" href="#Documentation"><span>Documentation</span></a></li></ul></li><li><a class="tocitem" href="../k_io/">I/O</a></li><li><a class="tocitem" href="../l_global/">Global Variables</a></li><li><a class="tocitem" href="../m_all/">All Overloaded Functions</a></li></ul></li><li><a class="tocitem" href="../../devel/">For Developers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href><code>@FastGTPSA</code>/<code>@FastGTPSA!</code> Macros</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href><code>@FastGTPSA</code>/<code>@FastGTPSA!</code> Macros</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bmad-sim/GTPSA.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bmad-sim/GTPSA.jl/blob/main/docs/src/man/j_fastgtpsa.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="fastgtpsa"><a class="docs-heading-anchor" href="#fastgtpsa"><code>@FastGTPSA</code>/<code>@FastGTPSA!</code> Macros</a><a id="fastgtpsa-1"></a><a class="docs-heading-anchor-permalink" href="#fastgtpsa" title="Permalink"></a></h1><p><em>Speed up evaluation of expressions containing TPSs, transparent to other types</em></p><p>The thread-safe macros <a href="#fastgtpsa"><code>@FastGTPSA</code>/<code>@FastGTPSA!</code></a> can be used to speed up evaluation of expressions that may contain <code>TPS</code>s. <strong>Both macros are completely transparent to all other types, so they can be prepended to any existing expressions while still maintaining type-generic code.</strong> Any functions in the expression that are not overloaded by GTPSA will be ignored. Both macros do <strong>not</strong> use any <code>-ffast-math</code> business (so still IEEE compliant), but instead will use a thread-safe pre-allocated buffer in the <code>Descriptor</code> for any temporaries that may be generated during evaluation of the expression.</p><p>The first macro, <code>@FastGTPSA</code> can be prepended to an expression following assignment (<code>=</code>, <code>+=</code>, etc) to only construct one <code>TPS</code> (which requires two allocations), instead of a <code>TPS</code> for every temporary:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using GTPSA, BenchmarkTools</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; d = Descriptor(3, 7);  Δx = @vars(d);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @btime $Δx[1]^3*sin($Δx[2])/log(2+$Δx[3])-exp($Δx[1]*$Δx[2])*im;</code><code class="nohighlight hljs ansi" style="display:block;">  6.149 μs (20 allocations: 11.88 KiB)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @btime @FastGTPSA $Δx[1]^3*sin($Δx[2])/log(2+$Δx[3])-exp($Δx[1]*$Δx[2])*im;</code><code class="nohighlight hljs ansi" style="display:block;">  5.637 μs (2 allocations: 1.94 KiB)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; y = rand(3); # transparent to non-TPS types</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @btime $y[1]^3*sin($y[2])/log(2+$y[3])-exp($y[1]*$y[2])*im;</code><code class="nohighlight hljs ansi" style="display:block;">  20.057 ns (0 allocations: 0 bytes)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @btime @FastGTPSA $y[1]^3*sin($y[2])/log(2+$y[3])-exp($y[1]*$y[2])*im;</code><code class="nohighlight hljs ansi" style="display:block;">  21.304 ns (0 allocations: 0 bytes)</code></pre><p>The second macro, <code>@FastGTPSA!</code> can be prepended to the LHS of an assignment, and will fill a preallocated <code>TPS</code> with the result of an expression. <code>@FastGTPSA!</code> will calculate a <code>TPS</code> expression with <em>zero</em> allocations, and will still have no impact if a non-TPS type is used. The only requirement is that all symbols in the expression are defined:</p><pre><code class="nohighlight hljs ansi" style="display:block;"></code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; t = ComplexTPS64(); # pre-allocate</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @btime @FastGTPSA! $t = $Δx[1]^3*sin($Δx[2])/log(2+$Δx[3])-exp($Δx[1]*$Δx[2])*im;</code><code class="nohighlight hljs ansi" style="display:block;">  5.495 μs (0 allocations: 0 bytes)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; y = rand(3); @gensym z; # transparent to non-TPS types</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @btime @FastGTPSA! $z = $y[1]^3*sin($y[2])/log(2+$y[3])-exp($y[1]*$y[2])*im;</code><code class="nohighlight hljs ansi" style="display:block;">  20.057 ns (0 allocations: 0 bytes)</code></pre><p>Both <code>@FastGTPSA</code> and <code>@FastGTPSA!</code> can also be prepended to a block of code, in which case they are applied to each assignment in the block:</p><pre><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; d = Descriptor(3, 7); Δx = @vars(d);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; y = rand(3);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @btime @FastGTPSA begin
               t1 = $Δx[1]^3*sin($Δx[2])/log(2+$Δx[3])-exp($Δx[1]*$Δx[2])*im;
               t2 = $Δx[1]^3*sin($Δx[2])/log(2+$Δx[3])-exp($Δx[1]*$Δx[2])*im;
               z  = $y[1]^3*sin($y[2])/log(2+$y[3])-exp($y[1]*$y[2])*im;
              end;</code><code class="nohighlight hljs ansi" style="display:block;">  11.461 μs (4 allocations: 3.88 KiB)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; t3 = ComplexTPS64(); t4 = ComplexTPS64(); @gensym w;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @btime @FastGTPSA! begin
               $t3 = $Δx[1]^3*sin($Δx[2])/log(2+$Δx[3])-exp($Δx[1]*$Δx[2])*im;
               $t4 = $Δx[1]^3*sin($Δx[2])/log(2+$Δx[3])-exp($Δx[1]*$Δx[2])*im;
               $w  = $y[1]^3*sin($y[2])/log(2+$y[3])-exp($y[1]*$y[2])*im;
              end;</code><code class="nohighlight hljs ansi" style="display:block;">  11.151 μs (0 allocations: 0 bytes)</code></pre><p><code>@FastGTPSA</code> and <code>@FastGTPSA!</code> are also compatible with broadcasted, vectorized operators. This can be very useful for example if a structure-of-arrays (SoA) layout is used in a simulation program, but you would like to calculate a Taylor map of the output by propagating GTPSAs through. Note that for <code>@FastGTPSA</code>, which allocates the result, that there are two allocations per <code>TPS</code> and one for the <code>Array</code>. For <code>@FastGTPSA!</code>, which requires a pre-allocated output, there are zero allocations. Both are still transparent to non-<code>TPS</code> types for universally polymorphic use without cost.</p><pre><code class="nohighlight hljs ansi" style="display:block;"></code><code class="nohighlight hljs ansi" style="display:block;"></code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @btime @FastGTPSA begin
               out = @. $Δx^3*sin($y)/log(2+$Δx)-exp($Δx*$y)*im;
              end;</code><code class="nohighlight hljs ansi" style="display:block;">  14.678 μs (7 allocations: 5.89 KiB)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; out = zeros(ComplexTPS64, 3); # pre-allocate</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @btime @FastGTPSA! begin
               @. $out = $Δx^3*sin($y)/log(2+$Δx)-exp($Δx*$y)*im;
              end;</code><code class="nohighlight hljs ansi" style="display:block;">  14.306 μs (0 allocations: 0 bytes)</code></pre><p>If errors are thrown during usage of <code>@FastGTPSA</code>/<code>@FastGTPSA!</code>, temporaries in use may not have been properly popped from the stack. Therefore, if the Julia session is not terminated, the helper functions <a href="#GTPSA.checktemps"><code>GTPSA.checktemps</code></a> and <a href="#GTPSA.cleartemps!">`GTPSA.cleartemps!</a> should be used to evaluate and correct the state of the buffer.</p><p>Without using the macro, each time an operation is performed using a TPS, a new TPS is dynamically-allocated containing the result. For example in the above expression, the calculation of <code>sin(Δx[2])</code> creates a new TPS, and the calculation of <code>Δx[1]^3</code> also creates a new TPS. The multiplication of these two resulting TPSs creates a new TPS, and so on until a TPS containing the full result of the evaluated expression is obtained. The intermediate TPSs that must be created to evaluate the expression are referred to as <em>temporaries</em>, because they only exist temporarily. Julia&#39;s garbage collector notices when the dynamically-allocated temporaries are no longer in scope, and cleans up that memory when it decides it&#39;s a good time to. This process can cause slowdowns in performance critical code however, especially in more complicated expressions where a lot of temporaries are created.</p><p>Both <code>@FastGTPSA</code> and <code>@FastGTPSA!</code> basically tell the code to instead use a permanent, pre-allocated thread-safe buffer of TPSs for the temporaries during evaluation of the expression, so there is no dynamic memory allocation; for <code>@FastGTPSA</code>, the number of allocations is reduced to two (which is one single <code>TPS</code>), and for <code>@FastGTPSA!</code> the number of allocations is zero. Furthermore, these temporaries are accessed and deleted in a stack-like manner from the buffer by each thread, so that temporaries involved in operations are right next to each other in memory. This ensures minimal cache misses throughout the evaluation of the expression.</p><p>The speedup of using the macro can be quite significant. See our <a href="https://github.com/bmad-sim/GTPSA.jl/blob/main/benchmark/track.jl">example</a>, where we observe a x2 speedup at 2nd order. </p><h2 id="Note-on-Julia-Versions-v1.10"><a class="docs-heading-anchor" href="#Note-on-Julia-Versions-v1.10">Note on Julia Versions &lt; v1.10</a><a id="Note-on-Julia-Versions-v1.10-1"></a><a class="docs-heading-anchor-permalink" href="#Note-on-Julia-Versions-v1.10" title="Permalink"></a></h2><p>In order to support vectorized/broadcasted operations using <code>@FastGTPSA!</code> with <em>zero</em> allocations, <code>setindex!</code> was overloaded for <code>Array{&lt;:TPS}</code> types. This can lead to massive speedups in calculating Taylor maps in simulations using a structure-of-arrays layout of memory. However, it turns out that on Julia versions &lt; v1.10, merely overloading this function causes allocations when using the macro. It currently is not understood why (possibly a bug in older Julia versions), however we therefore strongly recommend using Julia version &gt;= v1.10 with this package. If you are stuck with Julia v1.9, then you can use GTPSA v1.1.1, which is the latest version that does not have this particular overload. With this, you cannot do broadcasted operators using the macros, but you will have zero allocations for non-vector <code>TPS</code> operations.</p><h2 id="Documentation"><a class="docs-heading-anchor" href="#Documentation">Documentation</a><a id="Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Documentation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.@FastGTPSA" href="#GTPSA.@FastGTPSA"><code>GTPSA.@FastGTPSA</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@FastGTPSA(expr_or_block)</code></pre><p>Macro to speed up evaluation of mathematical expressions containing TPSs. The temporaries generated during evaluation of the expression are drawn  from a thread-safe buffer, reducing the number of heap allocations to  2 (which is for a single TPS) for the result. @FastGTPSA is completely  transparent to all other types, so it can be prepended to expressions  while still maintaining type-generic code.</p><pre><code class="language-julia-repl hljs">julia&gt; using GTPSA, BenchmarkTools

julia&gt; d = Descriptor(3,7); Δx = @vars(d);

julia&gt; t = @btime $Δx[1]^3*sin($Δx[2])/log(2+$Δx[3])-exp($Δx[1]*$Δx[2])*im;
  3.458 μs (20 allocations: 11.88 KiB)

julia&gt; t = @btime @FastGTPSA $Δx[1]^3*sin($Δx[2])/log(2+$Δx[3])-exp($Δx[1]*$Δx[2])*im;
  3.172 μs (2 allocations: 1.94 KiB)</code></pre><p><code>@FastGTPSA</code> can also be prepended to a block of code, in which case it  is applied after every <code>=</code> sign in the block: </p><pre><code class="language-julia-repl hljs">julia&gt; @btime @FastGTPSA begin
       t1 = $Δx[1]^3*sin($Δx[2])/log(2+$Δx[3])-exp($Δx[1]*$Δx[2])*im;
       t2 = $Δx[1]^3*sin($Δx[2])/log(2+$Δx[3])-exp($Δx[1]*$Δx[2])*im;
       a = t1+t2
       L = 5+3*exp(7)
       end
  6.317 μs (6 allocations: 5.81 KiB)</code></pre><p>Broadcasting is also compatible with <code>@FastGTPSA</code> (note two allocations  per <code>TPS</code> and one allocation per <code>Array</code>):</p><pre><code class="language-julia-repl hljs">julia&gt; using GTPSA, BenchmarkTools

julia&gt; d = Descriptor(3, 7); Δx = @vars(d); y = rand(3);

julia&gt; @btime @FastGTPSA begin
        out = @. $Δx^3*sin($y)/log(2+$x)-exp($x*$y)*im;
       end;
  7.573 μs (7 allocations: 5.89 KiB)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/f39cf1451df6c34eeeb7d7dac2423c04763bbfa2/src/fastgtpsa/fastgtpsa.jl#L116-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.@FastGTPSA!" href="#GTPSA.@FastGTPSA!"><code>GTPSA.@FastGTPSA!</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@FastGTPSA!(expr_or_block)</code></pre><p>Macro to speed up evaluation of mathematical expressions that may contain assignment to pre-allocated <code>TPS</code>s. The temporaries generated during  evaluation of the expression are drawn from a thread-safe buffer. With this  macro, the number of heap allocations during evaluation of expressions  containing <code>TPS</code>s is 0, and it is fully transparent to non-TPS types.</p><p>This macro supports assignment using <code>=</code>, <code>+=</code>, <code>-=</code>, <code>*=</code>, <code>/=</code>, and <code>^=</code>.</p><p><strong>Important:</strong> The symbols must be defined prior to calling the macro  regardless of whether or not the type is a <code>TPS</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; using GTPSA, BenchmarkTools

julia&gt; d = Descriptor(3,7); Δx = @vars(d); 

julia&gt; t = ComplexTPS64(); # Pre-allocate

julia&gt; @btime @FastGTPSA! $t = $Δx[1]^3*sin($Δx[2])/log(2+$Δx[3])-exp($Δx[1]*$Δx[2])*im;
  2.972 μs (0 allocations: 0 bytes)

julia&gt; @btime @FastGTPSA! $t ^= $Δx[1]^3*sin($Δx[2])/log(2+$Δx[3])-exp($Δx[1]*$Δx[2])*im;
  6.550 μs (0 allocations: 0 bytes)

julia&gt; y = rand(3); z = 2; # transparent to non-TPS types 

julia&gt;  @btime @FastGTPSA! $z = $y[1]^3*sin($y[2])/log(2+$y[3])-exp($y[1]*$y[2])*im;
  11.344 ns (0 allocations: 0 bytes)</code></pre><p>Like <code>@FastGTPSA</code>, <code>@FastGTPSA!</code> can prepended to a block of code, in  which case it is applied before every line in the block containing assignment:</p><pre><code class="language-julia-repl hljs">julia&gt; t1 = zero(ComplexTPS64); t2 = zero(ComplexTPS64); z = 0; 

julia&gt; @btime @FastGTPSA! begin
       $t1 = $Δx[1]^3*sin($Δx[2])/log(2+$Δx[3])-exp($Δx[1]*$Δx[2])*im;
       $t2 -= $Δx[1]^3*sin($Δx[2])/log(2+$Δx[3])-exp($Δx[1]*$Δx[2])*im;
       $z += 7
       end
  5.965 μs (0 allocations: 0 bytes)</code></pre><p>Broadcasting is also compatible with <code>@FastGTPSA!</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; using GTPSA, BenchmarkTools

julia&gt; d = Descriptor(3, 7); Δx = @vars(d); y = rand(3);

julia&gt; out = zeros(ComplexTPS64, 3) # pre-allocate

julia&gt; @btime @FastGTPSA! begin
        @. $out = $Δx^3*sin($y)/log(2+$Δx)-exp($Δx*$y)*im;
       end;
  7.312 μs (0 allocations: 0 bytes)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/f39cf1451df6c34eeeb7d7dac2423c04763bbfa2/src/fastgtpsa/fastgtpsa.jl#L190-L251">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.cleartemps!" href="#GTPSA.cleartemps!"><code>GTPSA.cleartemps!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GTPSA.cleartemps!(d::Descriptor=GTPSA.desc_current)</code></pre><p>Clears the &quot;stack&quot; of temporaries currently in use by the <code>Descriptor</code>. This is  necessary to run if <code>GTPSA.checktemps(d::Descriptor=GTPSA.desc_current)</code> returns  <code>false</code>; this occurs if an error is thrown during evaluation of an expression  using <code>@FastGTPSA</code> or <code>@FastGTPSA!</code>, and the Julia session is not terminated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/f39cf1451df6c34eeeb7d7dac2423c04763bbfa2/src/fastgtpsa/temptps.jl#L66-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GTPSA.checktemps" href="#GTPSA.checktemps"><code>GTPSA.checktemps</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GTPSA.checktemps(d::Descriptor=GTPSA.desc_current)</code></pre><p>Sanity check of the temporary buffer in the <code>Descriptor</code> used by @FastGTPSA.  Returns <code>true</code> if everything is OK, else <code>false</code> in which case  <code>GTPSA.cleartemps!(d::Descriptor=GTPSA.desc_current)</code> should be run. This may  occur if an error is thrown during evaluation of an expression using <code>@FastGTPSA</code>  or <code>@FastGTPSA!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bmad-sim/GTPSA.jl/blob/f39cf1451df6c34eeeb7d7dac2423c04763bbfa2/src/fastgtpsa/temptps.jl#L86-L94">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../i_methods/">« <code>TPS</code>-Specific Functions</a><a class="docs-footer-nextpage" href="../k_io/">I/O »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 22 January 2025 12:44">Wednesday 22 January 2025</span>. Using Julia version 1.10.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
