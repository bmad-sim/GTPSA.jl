<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · GTPSA.jl</title><meta name="title" content="Home · GTPSA.jl"/><meta property="og:title" content="Home · GTPSA.jl"/><meta property="twitter:title" content="Home · GTPSA.jl"/><meta name="description" content="Documentation for GTPSA.jl."/><meta property="og:description" content="Documentation for GTPSA.jl."/><meta property="twitter:description" content="Documentation for GTPSA.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>GTPSA.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Setup"><span>Setup</span></a></li><li><a class="tocitem" href="#Basic-Usage"><span>Basic Usage</span></a></li><li><a class="tocitem" href="#Acknowledgements"><span>Acknowledgements</span></a></li></ul></li><li><a class="tocitem" href="quickstart/">Quickstart Guide</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="man/a_toc/">Table of Contents</a></li><li><a class="tocitem" href="man/b_definitions/">Definitions</a></li><li><a class="tocitem" href="man/c_descriptor/"><code>Descriptor</code></a></li><li><a class="tocitem" href="man/d_tps/"><code>TPS</code></a></li><li><a class="tocitem" href="man/e_varsparams/"><code>vars</code>, <code>params</code></a></li><li><a class="tocitem" href="man/f_monoindex/">Monomial Indexing</a></li><li><a class="tocitem" href="man/g_mono/"><code>mono</code>/<code>complexmono</code></a></li><li><a class="tocitem" href="man/h_gjh/"><code>gradient</code>, <code>jacobian</code>, <code>hessian</code></a></li><li><a class="tocitem" href="man/i_slice/">Slicing and <code>par</code></a></li><li><a class="tocitem" href="man/j_methods/">TPS Methods</a></li><li><a class="tocitem" href="man/k_fastgtpsa/"><code>@FastGTPSA</code>/<code>@FastGTPSA!</code> Macros</a></li><li><a class="tocitem" href="man/l_io/">I/O</a></li><li><a class="tocitem" href="man/m_global/">Global Variables</a></li><li><a class="tocitem" href="man/n_all/">All Overloaded Functions</a></li></ul></li><li><a class="tocitem" href="devel/">For Developers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bmad-sim/GTPSA.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bmad-sim/GTPSA.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="GTPSA.jl"><a class="docs-heading-anchor" href="#GTPSA.jl">GTPSA.jl</a><a id="GTPSA.jl-1"></a><a class="docs-heading-anchor-permalink" href="#GTPSA.jl" title="Permalink"></a></h1><p><em>A full-featured Julia interface to the Generalised Truncated Power Series Algebra library.</em></p><p><code>GTPSA.jl</code> is a full-featured Julia interface to the <a href="https://madx.web.cern.ch/releases/madng/html/mad_mod_diffalg.html">Generalised Truncated Power Series Algebra (GTPSA) library</a>, which computes Taylor expansions, or Truncated Power Series (TPSs), of real and complex multivariable functions to high orders.</p><p>Truncated Power Series Algebra (TPSA) performs forward-mode automatic differentation (AD) similar to the typical dual-number implementation, as in <code>ForwardDiff.jl</code>. However, instead of nesting derivatives for higher orders, TPSA naturally extends to arbitary orders by directly using the power series expansions. Furthermore, because TPSA is designed for high order AD, extra focus is given to the data structure storing all partial derivatives, as well as indexing/propagating each of the nonzero partial derivatives in an efficient way. With these features, <code>GTPSA.jl</code> is significantly faster than <code>ForwardDiff.jl</code> for 2nd-order calculations and above, and has similar performance to 1st-order. See the <a href="https://github.com/bmad-sim/GTPSA.jl/blob/main/benchmark/track.jl"><code>benchmark/track.jl</code></a> example for a speed comparison in calculating the partial derivatives for a system with 58 inputs and 6 outputs. <strong>In this example, GTPSA was x3.5 faster than ForwardDiff to 2nd order, and x19.8 faster to 3rd order.</strong></p><p>GTPSA provides several advantages over current Julia AD packages:</p><ol><li><strong>Speed</strong>: <code>GTPSA.jl</code> is significantly faster than <code>ForwardDiff.jl</code> for 2nd-order calculations and above, and has very similar performance at 1st-order</li><li><strong>Easy Monomial Indexing</strong>: Beyond 2nd order, accessing/manipulating the partial derivatives in an organized way can be a significant challenge when using other AD packages. In GTPSA, three simple indexing schemes for getting/setting monomial coefficients in a truncated power series is provided, as well as a <a href="man/j_methods/#GTPSA.cycle!"><code>cycle!</code></a> function for cycling through all nonzero monomials</li><li><strong>Custom Orders in Individual Variables</strong>: Other packages use a single maximum order for all variables. With GTPSA, the maximum order can be set differently for individual variables, as well as for a separate part of the monomial. For example, computing the Taylor expansion of <span>$f(x_1,x_2)$</span> to 2nd order in <span>$x_1$</span> and 6th order in <span>$x_2$</span> is possible</li><li><strong>Complex Numbers</strong>: GTPSA natively supports complex numbers and allows for mixing of complex and real truncated power series</li><li><strong>Distinction Between State Variables and Parameters</strong>: Distinguishing between dependent variables and parameters in the solution of a differential equation expressed as a power series in the dependent variables/parameters can be advantageous in analysis</li></ol><h2 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h2><p>To use <code>GTPSA.jl</code>, in the Julia REPL run</p><pre><code class="language-julia hljs">import Pkg; Pkg.add(&quot;GTPSA&quot;)</code></pre><h2 id="Basic-Usage"><a class="docs-heading-anchor" href="#Basic-Usage">Basic Usage</a><a id="Basic-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Usage" title="Permalink"></a></h2><p>First, a <code>Descriptor</code> must be created specifying the number of variables, number of parameters, and truncation order(s) for the variables/parameters in the TPSA. A <code>TPS</code> can then be created based on the <code>Descriptor</code>. TPSs can be manipulated using all of the arithmetic operators (<code>+</code>,<code>-</code>,<code>*</code>,<code>/</code>,<code>^</code>) and math functions (e.g. <code>abs</code>, <code>sqrt</code>, <code>sin</code>, <code>exp</code>, <code>log</code>, <code>tanh</code>, etc.).</p><p>TPSs can be viewed as structures containing the coefficients for all of the monomials of a multivariable Taylor expansion up to the orders specified in the <code>Descriptor</code>. As an example, to compute the truncated power series of a function <span>$f(x_1, x_2) = \cos{(x_1)}+i\sin{(x_2)}$</span> to 6th order in <span>$x_1$</span> and <span>$x_2$</span>:</p><pre><code class="language-julia hljs">using GTPSA

# Descriptor for TPSA with 2 variables to 6th order
d = Descriptor(2, 6)

# Get the TPSs corresponding to each variable based on the Descriptor
x = vars()
# x[1] corresponds to the first variable and x[2] corresponds to the second variable

# Manipulate the TPSs as you would any other mathematical variable in Julia
f = cos(x[1]) + im*sin(x[2])
# f is a new ComplexTPS64 </code></pre><p>Note that scalars do not need to be defined as TPSs when writing expressions. Running <code>print(f)</code> gives the output</p><pre><code class="nohighlight hljs">ComplexTPS64:
 Real                     Imag                       Order   Exponent
  1.0000000000000000e+00   0.0000000000000000e+00      0      0   0
  0.0000000000000000e+00   1.0000000000000000e+00      1      0   1
 -5.0000000000000000e-01   0.0000000000000000e+00      2      2   0
  0.0000000000000000e+00  -1.6666666666666666e-01      3      0   3
  4.1666666666666664e-02   0.0000000000000000e+00      4      4   0
  0.0000000000000000e+00   8.3333333333333332e-03      5      0   5
 -1.3888888888888887e-03   0.0000000000000000e+00      6      6   0</code></pre><p>The GTPSA library currently only supports truncated power series representing <code>Float64</code> and <code>ComplexF64</code> number types.</p><h2 id="Acknowledgements"><a class="docs-heading-anchor" href="#Acknowledgements">Acknowledgements</a><a id="Acknowledgements-1"></a><a class="docs-heading-anchor-permalink" href="#Acknowledgements" title="Permalink"></a></h2><p>Much thanks must be given to Laurent Deniau, the creator of the C GTPSA library, for his time and great patience in explaining his code. </p><p>Advanced users are referred to <a href="https://inspirehep.net/files/286f2ab60e1e7c372cec485337ab5eb6">this paper</a> discussing the inner workings of the C GTPSA library.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="quickstart/">Quickstart Guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Friday 9 August 2024 18:09">Friday 9 August 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
